(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9668],{7574:function(e,t,a){Promise.resolve().then(a.bind(a,7128))},7810:function(e,t,a){"use strict";a.d(t,{Z:function(){return p}});var n=a(1119),r=a(2265),s=a(9448),l=a(1434),i=a(1993),o=a(1686),c=a(7673),d=a(6989),u=a(1717),m=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];a(4887),a(7935);var p=(0,r.forwardRef)(function(e,t){var a,p,h,x,f,y,g,v,b,j,N,w,_,I,z,D,A,S,C,M,k,P,R,Z,E,O,F,T,V,q,Y,B,L,U,W,K,H,G,$,Q,X,J,ee,et,ea,en,er,es,el,ei,eo,ec=(p=void 0!==(a=e.defaultOptions)&&a,x=void 0!==(h=e.cacheOptions)&&h,f=e.loadOptions,e.options,y=e.isLoading,g=e.onInputChange,v=e.filterOption,j=(b=(0,d.Z)(e,m)).inputValue,N=(0,r.useRef)(void 0),w=(0,r.useRef)(!1),_=(0,r.useState)(Array.isArray(p)?p:void 0),z=(I=(0,c.Z)(_,2))[0],D=I[1],A=(0,r.useState)(void 0!==j?j:""),C=(S=(0,c.Z)(A,2))[0],M=S[1],k=(0,r.useState)(!0===p),R=(P=(0,c.Z)(k,2))[0],Z=P[1],E=(0,r.useState)(void 0),F=(O=(0,c.Z)(E,2))[0],T=O[1],V=(0,r.useState)([]),Y=(q=(0,c.Z)(V,2))[0],B=q[1],L=(0,r.useState)(!1),W=(U=(0,c.Z)(L,2))[0],K=U[1],H=(0,r.useState)({}),$=(G=(0,c.Z)(H,2))[0],Q=G[1],X=(0,r.useState)(void 0),ee=(J=(0,c.Z)(X,2))[0],et=J[1],ea=(0,r.useState)(void 0),er=(en=(0,c.Z)(ea,2))[0],es=en[1],x!==er&&(Q({}),es(x)),p!==ee&&(D(Array.isArray(p)?p:void 0),et(p)),(0,r.useEffect)(function(){return w.current=!0,function(){w.current=!1}},[]),el=(0,r.useCallback)(function(e,t){if(!f)return t();var a=f(e,t);a&&"function"==typeof a.then&&a.then(t,function(){return t()})},[f]),(0,r.useEffect)(function(){!0===p&&el(C,function(e){w.current&&(D(e||[]),Z(!!N.current))})},[]),ei=(0,r.useCallback)(function(e,t){var a=(0,u.L)(e,t,g);if(!a){N.current=void 0,M(""),T(""),B([]),Z(!1),K(!1);return}if(x&&$[a])M(a),T(a),B($[a]),Z(!1),K(!1);else{var n=N.current={};M(a),Z(!0),K(!F),el(a,function(e){w&&n===N.current&&(N.current=void 0,Z(!1),T(a),B(e||[]),K(!1),Q(e?(0,o.Z)((0,o.Z)({},$),{},(0,i.Z)({},a,e)):$))})}},[x,el,F,$,g]),eo=W?[]:C&&F?Y:z||[],(0,o.Z)((0,o.Z)({},b),{},{options:eo,isLoading:R||void 0!==y&&y,onInputChange:ei,filterOption:void 0===v?null:v})),ed=(0,l.u)(ec);return r.createElement(s.S,(0,n.Z)({ref:t},ed))})},6979:function(e,t,a){"use strict";a.d(t,{ZP:function(){return i}});var n=a(1434),r=a(1119),s=a(2265),l=a(9448);a(8242),a(4887),a(7935);var i=(0,s.forwardRef)(function(e,t){var a=(0,n.u)(e);return s.createElement(l.S,(0,r.Z)({ref:t},a))})},7128:function(e,t,a){"use strict";a.d(t,{default:function(){return P}});var n=a(7437),r=a(2265),s=a(386),l=a(2381),i=a(5974),o=a(9501),c=a(3590),d=a(1229),u=a(279),m=a(5060),p=a(4978),h=a(2786),x=a(6979),f=a(9093),y=a(662),g=a(7810),v=a(7520);let b=d.z.object({razorpay_payment_id:d.z.string().optional(),razorpay_order_id:d.z.string().optional(),razorpay_signature:d.z.string().optional(),amount:d.z.number().min(1,{message:"Amount must be positive"}),currency:d.z.enum(["INR","AUD"]).default("INR"),status:d.z.string().min(1,{message:"Status is required"}),method:d.z.string().optional(),email:d.z.string().email().optional().or(d.z.literal("")),contact:d.z.string().optional(),created_at:d.z.number().optional(),notes:d.z.any().optional(),paymentMode:d.z.enum(["online","offline"]).default("online"),manualMethod:d.z.enum(["cash","cheque","upi","bank_transfer"]).optional(),transactionReference:d.z.string().optional(),paymentDate:d.z.string().optional(),remarks:d.z.string().optional(),recordedBy:d.z.string().optional(),supporter:d.z.string().min(1,{message:"Supporter is required"}),bed:d.z.string().min(1,{message:"Bed is required"}),isVerified:d.z.boolean().default(!1)});var j=e=>{let{paymentId:t}=e,a=(0,s.I0)(),[i,d]=(0,r.useState)(),[j,N]=(0,r.useState)(),[w,_]=(0,r.useState)({value:"online",label:"Online"}),[I,z]=(0,r.useState)(),[D,A]=(0,r.useState)({value:"captured",label:"Captured"}),[S,C]=(0,r.useState)({value:"INR",label:"INR"}),[M,k]=(0,r.useState)({value:!1,label:"No"}),{handleSubmit:P,register:R,setValue:Z,formState:{errors:E},setError:O,watch:F}=(0,o.cI)({resolver:(0,c.F)(b)}),[T,V]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&(async()=>{try{var e;let a=(await (0,h.bp)(t,"payment")).items;Z("razorpay_payment_id",a.razorpay_payment_id||""),Z("razorpay_order_id",a.razorpay_order_id||""),Z("razorpay_signature",a.razorpay_signature||""),Z("amount",a.amount),Z("currency",a.currency||"INR"),Z("status",a.status),Z("method",a.method||""),Z("email",a.email||""),Z("contact",a.contact||""),Z("created_at",a.created_at),Z("notes",a.notes||{}),Z("paymentMode",a.paymentMode||"online"),Z("manualMethod",a.manualMethod||void 0),Z("transactionReference",a.transactionReference||""),Z("paymentDate",(null===(e=a.paymentDate)||void 0===e?void 0:e.split("T")[0])||""),Z("remarks",a.remarks||""),Z("supporter",a.supporter._id),Z("bed",a.bed._id),Z("isVerified",a.isVerified||!1),A({value:a.status,label:a.status.charAt(0).toUpperCase()+a.status.slice(1)}),_({value:a.paymentMode||"online",label:"offline"===a.paymentMode?"Offline":"Online"}),C({value:a.currency||"INR",label:a.currency||"INR"}),a.manualMethod&&z({value:a.manualMethod,label:a.manualMethod.charAt(0).toUpperCase()+a.manualMethod.slice(1)}),k({value:a.isVerified||!1,label:a.isVerified?"Yes":"No"}),d({label:a.bed.bedNo,id:a.bed._id}),N({label:a.supporter.name,id:a.supporter._id})}catch(e){console.error("Error fetching payment details:",e)}})()},[t,Z]);let q=async e=>{V(!0);try{let a={...e,amount:Number(e.amount),...e.paymentDate&&{paymentDate:new Date(e.paymentDate).toISOString()}};if(t){let e=await (0,f.V)(a,"payment",t);e._id?p.Z.success("Payment updated successfully"):(O(e.id,{message:e.value}),p.Z.error("Error updating payment"))}else{let e=await (0,y.U)("payment",a);e._id?(p.Z.success("Payment created successfully"),Y()):(O(e.id,{message:e.value}),p.Z.error("Error creating payment"))}}catch(e){console.error("Error submitting form:",e),p.Z.error("Error submitting form")}finally{V(!1)}},Y=()=>{Z("amount",0),Z("status","captured"),Z("paymentMode","online"),Z("supporter",""),Z("bed",""),Z("isVerified",!1),d(void 0),N(void 0),_({value:"online",label:"Online"}),A({value:"captured",label:"Captured"}),C({value:"INR",label:"INR"}),k({value:!1,label:"No"}),a((0,v.Oe)())},B=async e=>(await (0,h.GZ)(e)).items.map(e=>({id:e._id,label:e.bedNo})),L=async e=>(await (0,h.WX)(e)).items.map(e=>({id:e._id,label:e.name}));return(0,n.jsxs)("form",{onSubmit:P(q),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(m._,{htmlFor:"amount",className:"required",children:"Amount (in paise)"}),(0,n.jsx)(u.I,{id:"amount",type:"number",...R("amount",{valueAsNumber:!0}),placeholder:"Enter amount",className:"w-full ".concat(E.amount?"border-red-500":"")}),E.amount&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:E.amount.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"currency",children:"Currency"}),(0,n.jsx)(x.ZP,{id:"currency",options:[{value:"INR",label:"INR"},{value:"AUD",label:"AUD"}],value:S,onChange:e=>{C(e),Z("currency",e.value)},classNamePrefix:"select"}),E.currency&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:E.currency.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"status",className:"required",children:"Status"}),(0,n.jsx)(x.ZP,{id:"status",options:[{value:"captured",label:"Captured"},{value:"failed",label:"Failed"},{value:"pending",label:"Pending"}],value:D,onChange:e=>{A(e),Z("status",e.value)},classNamePrefix:"select"}),E.status&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:E.status.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"paymentMode",className:"required",children:"Payment Mode"}),(0,n.jsx)(x.ZP,{id:"paymentMode",options:[{value:"online",label:"Online"},{value:"offline",label:"Offline"}],value:w,onChange:e=>{_(e),Z("paymentMode",e.value),"online"===e.value&&(z(void 0),Z("manualMethod",void 0))},classNamePrefix:"select"}),E.paymentMode&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:E.paymentMode.message})]}),"offline"===F("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"manualMethod",children:"Manual Method"}),(0,n.jsx)(x.ZP,{id:"manualMethod",options:[{value:"cash",label:"Cash"},{value:"cheque",label:"Cheque"},{value:"upi",label:"UPI"},{value:"bank_transfer",label:"Bank Transfer"}],value:I,onChange:e=>{z(e),Z("manualMethod",e.value)},classNamePrefix:"select"}),E.manualMethod&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:E.manualMethod.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"transactionReference",children:"Transaction Reference"}),(0,n.jsx)(u.I,{id:"transactionReference",...R("transactionReference"),placeholder:"Cheque no, UTR, etc.",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"paymentDate",children:"Payment Date"}),(0,n.jsx)(u.I,{type:"date",id:"paymentDate",...R("paymentDate"),className:"w-full"})]}),(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(m._,{htmlFor:"remarks",children:"Remarks"}),(0,n.jsx)(u.I,{id:"remarks",...R("remarks"),placeholder:"Enter remarks",className:"w-full"})]})]}),"online"===F("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"razorpay_payment_id",children:"Razorpay Payment ID"}),(0,n.jsx)(u.I,{id:"razorpay_payment_id",...R("razorpay_payment_id"),placeholder:"Enter Razorpay payment ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"razorpay_order_id",children:"Razorpay Order ID"}),(0,n.jsx)(u.I,{id:"razorpay_order_id",...R("razorpay_order_id"),placeholder:"Enter Razorpay order ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"razorpay_signature",children:"Razorpay Signature"}),(0,n.jsx)(u.I,{id:"razorpay_signature",...R("razorpay_signature"),placeholder:"Enter Razorpay signature",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"method",children:"Payment Method"}),(0,n.jsx)(u.I,{id:"method",...R("method"),placeholder:"e.g., UPI, Card, Netbanking",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(u.I,{id:"email",...R("email"),placeholder:"Enter payer email",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"contact",children:"Contact"}),(0,n.jsx)(u.I,{id:"contact",...R("contact"),placeholder:"Enter payer contact",className:"w-full"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"supporter",className:"required",children:"Supporter"}),(0,n.jsx)(g.Z,{cacheOptions:!0,loadOptions:L,defaultOptions:!0,value:j,onChange:e=>{N(e),Z("supporter",null==e?void 0:e.id)},classNamePrefix:"select",required:!0,isClearable:!0}),E.supporter&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:E.supporter.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{htmlFor:"bed",className:"required",children:"Bed"}),(0,n.jsx)(g.Z,{cacheOptions:!0,loadOptions:B,defaultOptions:!0,value:i,onChange:e=>{d(e),Z("bed",null==e?void 0:e.id)},classNamePrefix:"select",required:!0,isClearable:!0}),E.bed&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:E.bed.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(m._,{children:"Verified"}),(0,n.jsx)(x.ZP,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],value:M,onChange:e=>{k(e),Z("isVerified",e.value)},classNamePrefix:"select"})]}),(0,n.jsxs)("div",{className:"flex justify-between col-span-1 lg:col-span-2",children:[(0,n.jsx)(l.z,{onClick:Y,className:"bg-slate-400 hover:bg-slate-500",children:t?"Cancel":"Clear"}),(0,n.jsx)(l.z,{className:T?"cursor-not-allowed opacity-50":"",type:"submit",children:t?"Update":"Create"})]})]})},N=a(8438),w=a(3618),_=a(4291),I=a(9376),z=a(3455),D=a(5420);let A=[{accessorKey:"supporter.name",header:"Supporter"},{accessorKey:"bed.bedNo",header:"Bed No"},{accessorKey:"amount",header:"Amount",cell:e=>{let{row:t}=e;return(0,D.x)(t.getValue("amount"))}},{accessorKey:"status",header:"Status",cell:e=>{let{row:t}=e,a=t.getValue("status");return(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("captured"===a?"bg-green-100 text-green-800":"failed"===a?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:a.charAt(0).toUpperCase()+a.slice(1)})}},{accessorKey:"paymentMode",header:"Mode",cell:e=>{let{row:t}=e,a=t.getValue("paymentMode");return(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("online"===a?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:a.charAt(0).toUpperCase()+a.slice(1)})}},{accessorKey:"viewDetails",header:"Actions",cell:e=>{let t=e.row.original;return(0,n.jsxs)(_.Vq,{children:[(0,n.jsx)(_.hg,{className:"underline",children:(0,n.jsx)("button",{className:"px-4 p-1 text-white bg-sidebar-primary rounded-full",children:"View"})}),(0,n.jsx)(_.cZ,{className:"p-6 max-w-md",children:(0,n.jsx)(S,{data:t})})]})}}],S=e=>{let{data:t}=e,a=(0,s.I0)(),r=(0,I.useRouter)();return(0,n.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Payment Details"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Supporter"}),(0,n.jsx)("p",{children:t.supporter.name})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Bed No"}),(0,n.jsx)("p",{children:t.bed.bedNo})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Amount"}),(0,n.jsx)("p",{children:(0,D.x)(t.amount)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,n.jsx)("p",{className:"capitalize",children:t.status})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Mode"}),(0,n.jsx)("p",{className:"capitalize",children:t.paymentMode})]}),t.paymentDate&&(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Date"}),(0,n.jsx)("p",{children:(0,z.Sp)(t.paymentDate)})]}),"online"===t.paymentMode&&t.razorpay_payment_id&&(0,n.jsxs)("div",{className:"col-span-2",children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Razorpay ID"}),(0,n.jsx)("p",{className:"text-xs font-mono",children:t.razorpay_payment_id})]}),"offline"===t.paymentMode&&t.transactionReference&&(0,n.jsxs)("div",{className:"col-span-2",children:[(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Reference"}),(0,n.jsx)("p",{children:t.transactionReference})]})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,n.jsx)(l.z,{className:"text-sm",onClick:()=>{a((0,v.R5)("payment")),a((0,v.h9)(t._id))},children:"Edit Payment"}),(0,n.jsx)(l.z,{variant:"outline",className:"text-sm",onClick:()=>r.push("/supporters/".concat(t.supporter._id)),children:"View Supporter"})]})]})};var C=a(4395),M=a(7162);function k(){var e;let t;let[a,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(0),[c,d]=(0,r.useState)(0),[u,m]=(0,r.useState)(10),[p,h]=(0,r.useState)(""),[x,f]=(0,r.useState)(),[y,v]=(0,r.useState)(null),[b,j]=(0,r.useState)(""),[_,I]=(0,r.useState)(""),[z,D]=(0,r.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),2).toISOString().split("T")[0]}),[S,k]=(0,r.useState)(()=>new Date().toISOString().split("T")[0]),[P,R]=(0,r.useState)(null),Z=(0,s.v9)(e=>e.update.refresh),E=(0,s.v9)(e=>e.payment.id),O=(0,s.v9)(M.oM),F=e=>{let{country:t}=e;return(0,n.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,n.jsxs)("h4",{className:"font-medium text-gray-800",children:[t.country," ",(0,n.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",t.currency,")"]})]}),(0,n.jsxs)("span",{className:"bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded",children:[t.totalPayments," total"]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[(0,n.jsx)(T,{label:"Active",value:t.activePayments}),(0,n.jsx)(T,{label:"Month",value:t.thisMonthPayments}),(0,n.jsx)(T,{label:"Week",value:t.thisWeekPayments}),(0,n.jsx)(T,{label:"Today",value:t.thisDayPayments})]}),(0,n.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 grid grid-cols-2 gap-1 text-xs",children:[(0,n.jsx)(T,{label:"Total",value:"".concat(t.currency," ").concat(t.totalAmount)}),(0,n.jsx)(T,{label:"Month",value:"".concat(t.currency," ").concat(t.thisMonthAmount)}),(0,n.jsx)(T,{label:"Week",value:"".concat(t.currency," ").concat(t.thisWeekAmount)}),(0,n.jsx)(T,{label:"Today",value:"".concat(t.currency," ").concat(t.thisDayAmount)})]})]})},T=e=>{let{label:t,value:a}=e;return(0,n.jsxs)("div",{className:"truncate",children:[(0,n.jsxs)("span",{className:"text-gray-500",children:[t,":"]}),(0,n.jsx)("span",{className:"font-medium ml-1",children:a})]})},V=(0,r.useCallback)(async()=>{try{let e=await w.YD.get("payment/payment-head");console.log("Payment Head Data:",e);let t=e.data,a=0,n=0,r=0,s=0,l=0,i=0,o=0;t.data.forEach(e=>{a+=e.totalpayments,n+=e.activepayments,r+=e.thisMonthpayments,s+=e.thisWeekpayments,l+=e.totalAmount,i+=e.thisMonthAmount,o+=e.thisWeekAmount}),R({...t,totalPayments:a,activePayments:n,thisMonthPayments:r})}catch(e){console.error("Error fetching payment head data:",e)}},[]);(0,r.useCallback)((e=e=>{I(e),d(0)},function(){for(var a=arguments.length,n=Array(a),r=0;r<a;r++)n[r]=arguments[r];clearTimeout(t),t=setTimeout(()=>{e(...n)},500)}),[]);let q=async e=>{if(f(e),d(0),e&&e.id)try{let t=await w.YD.get("/bed/".concat(e.id));v(t.data.data)}catch(e){console.error("Error fetching bed data:",e),v(null)}else v(null)};async function Y(){try{let e="";if(E){let e=await w.YD.get("/payment/".concat(E)),t=[];return t[0]=e.data.data,o(1),t}"Active"===b?e="isActive__eq=true&":"InActive"===b&&(e="isActive__eq=false&");let t=_&&!x?"search=".concat(_,"&"):"",a="";x&&x.id&&(a="bed__eq=".concat(x.id,"&")),x&&x.id;let n=x&&x.id?"":"skip=".concat(c*u,"&"),r={filters:{...!x&&{startDate:z?new Date(z).toISOString():void 0,endDate:S?new Date(S).toISOString():void 0}}},s=await w.YD.post("/payment/get?limit=Infinity&".concat(n).concat(a).concat(e).concat(t,"sortBy=paymentDate"),r,{headers:{"Content-Type":"application/json"}});console.log("Payment Data:",s.data);let l=s.data.data;return o(l.total||l.length),l.items||l}catch(e){return console.error("Error fetching data:",e),[]}}let B=a.reduce((e,t)=>e+(t.amount||0),0);return(0,r.useEffect)(()=>{(async function(){let e=await Y();l(Array.isArray(e)?e:[])})(),V()},[c,u,_,b,Z,E,x,z,S]),(0,n.jsx)("div",{className:"flex flex-col items-center p-4",children:(0,n.jsxs)("div",{className:"container mx-auto py-10",children:[!x&&P&&(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-4 border border-gray-100",children:[(0,n.jsxs)("h2",{className:"text-lg font-semibold mb-3 text-gray-800 flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Payment Overview"]}),(0,n.jsx)("div",{className:"space-y-3",children:P.data.map(e=>(0,n.jsxs)("details",{className:"group",children:[(0,n.jsxs)("summary",{className:"flex justify-between items-center p-2 cursor-pointer bg-gray-50 rounded-lg hover:bg-gray-100",children:[(0,n.jsxs)("h3",{className:"text-md font-medium text-gray-700",children:[e.organizationName," Summary"]}),(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-500 group-open:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,n.jsx)("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 p-2",children:e.data.map((e,t)=>(0,n.jsx)(F,{country:e},t))})]},e.organizationId))})]}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row justify-between mb-4 gap-2 flex-wrap",children:[!x&&(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 w-full md:w-auto",children:[(0,n.jsxs)("div",{className:"w-full md:w-auto",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,n.jsx)("input",{type:"date",value:z,onChange:e=>{D(e.target.value),d(0)},className:"p-2 border border-gray-300 rounded w-full",max:S})]}),(0,n.jsxs)("div",{className:"w-full md:w-auto",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,n.jsx)("input",{type:"date",value:S,onChange:e=>{k(e.target.value),d(0)},className:"p-2 border border-gray-300 rounded w-full",min:z})]})]}),(0,n.jsx)("div",{className:"w-full md:flex-1 min-w-[200px]",children:(0,n.jsx)(g.Z,{cacheOptions:!0,loadOptions:C.$y,defaultOptions:!0,value:x,onChange:q,className:"w-full",classNamePrefix:"select",required:!0,isClearable:!0,placeholder:"Select Bed"})}),(0,n.jsx)("div",{className:"w-full md:w-auto",children:(0,n.jsxs)("select",{value:b,onChange:e=>{j(e.target.value),d(0)},className:"p-2 border border-gray-300 rounded w-full md:w-[150px]",disabled:!!x,children:[(0,n.jsx)("option",{value:"",children:"All Status"}),(0,n.jsx)("option",{value:"Active",children:"Active"}),(0,n.jsx)("option",{value:"InActive",children:"InActive"})]})})]}),y&&(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6 border border-gray-200",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:["Bed ",x.label]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,n.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-100",children:[(0,n.jsx)("h3",{className:"font-medium text-gray-600 text-sm",children:"Total Donations"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:[y.country.currency," ",null==y?void 0:y.fixedAmount]})]}),(0,n.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-100",children:[(0,n.jsx)("h3",{className:"font-medium text-gray-600 text-sm",children:"Target Amount"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:[y.country.currency," ",y.amount]})]}),(0,n.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-100",children:[(0,n.jsxs)("h3",{className:"font-medium text-gray-600 text-sm",children:["Contributors (",a.length,")"]}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:[y.country.currency," ",B]})]}),(0,n.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[(0,n.jsx)("h3",{className:"font-medium text-gray-600 text-sm",children:"Amount Needed"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:[y.country.currency," ",y.amount-B]})]})]})]}),(0,n.jsx)(N.w,{url:"payment",columns:A,data:a,totalRows:i,pageIndex:c,pageSize:u,onPageChange:d,onPageSizeChange:m,actions:{delete:"superAdmin"===O,edit:"superAdmin"===O}})]})})}function P(){let[e,t]=(0,r.useState)(!0),a=(0,s.I0)(),o=(0,s.v9)(e=>e.update.url),c=(0,s.v9)(e=>e.update.id);return(0,n.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Payments"}),"payment"===o?"":(0,n.jsx)(l.z,{onClick:()=>{a((0,i.Ib)()),a((0,v.Oe)()),t(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Payment":"View Payments"})]}),"payment"===o?c&&(0,n.jsx)(j,{paymentId:c}):e?(0,n.jsx)(k,{}):(0,n.jsx)(j,{})]})}},4291:function(e,t,a){"use strict";a.d(t,{$N:function(){return h},Be:function(){return x},Vq:function(){return o},cZ:function(){return m},fK:function(){return p},hg:function(){return c}});var n=a(7437),r=a(2265),s=a(9027),l=a(653),i=a(3448);let o=s.fC,c=s.xz,d=s.h_;s.x8;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});u.displayName=s.aV.displayName;let m=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,n.jsxs)(d,{children:[(0,n.jsx)(u,{}),(0,n.jsxs)(s.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[r,(0,n.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(l.Pxu,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=s.VY.displayName;let p=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};p.displayName="DialogHeader";let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});h.displayName=s.Dx.displayName;let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...r})});x.displayName=s.dk.displayName},279:function(e,t,a){"use strict";a.d(t,{I:function(){return l}});var n=a(7437),r=a(2265),s=a(3448);let l=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,n.jsx)("input",{type:r,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input  px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...l})});l.displayName="Input"},5060:function(e,t,a){"use strict";a.d(t,{_:function(){return c}});var n=a(7437),r=a(2265),s=a(6394),l=a(535),i=a(3448);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.f,{ref:t,className:(0,i.cn)(o(),a),...r})});c.displayName=s.f.displayName},7162:function(e,t,a){"use strict";a.d(t,{Jt:function(){return o},gD:function(){return r},oM:function(){return i},tR:function(){return s}});let n=(0,a(1455).oM)({name:"auth",initialState:{role:"",isAuth:!1,accessToken:""},reducers:{setRole:(e,t)=>{e.role=t.payload},setIsAuth:(e,t)=>{e.isAuth=t.payload},setAccessToken:(e,t)=>{e.accessToken=t.payload}}}),{setRole:r,setIsAuth:s,setAccessToken:l}=n.actions,i=e=>e.auth.role,o=e=>e.auth.isAuth;t.ZP=n.reducer},5974:function(e,t,a){"use strict";a.d(t,{Ib:function(){return s}});let n=(0,a(1455).oM)({name:"payment",initialState:{id:null,paymentId:null},reducers:{setPaymentId:(e,t)=>{e.paymentId=t.payload},clearPaymentId:e=>{e.paymentId=null}}}),{setPaymentId:r,clearPaymentId:s}=n.actions;t.ZP=n.reducer},662:function(e,t,a){"use strict";a.d(t,{U:function(){return r}});var n=a(3618);let r=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let r=await n.YD.post("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(e,"/"),t,{headers:{"Content-Type":a?"multipart/form-data":"application/json"}});return console.log(r),r.data.data}catch(t){console.error("Error creating data:",t);let e=t.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},2786:function(e,t,a){"use strict";a.d(t,{Ak:function(){return i},GZ:function(){return o},WX:function(){return d},bp:function(){return l},dQ:function(){return u},fp:function(){return p},rQ:function(){return s},tE:function(){return c},uh:function(){return m}});var n=a(3618);let r="https://api.donatebed.shanthibhavan.in/v1",s=async e=>{try{return{items:(await n.YD.get("/".concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},l=async(e,t)=>{try{return{items:(await n.YD.get("/".concat(t,"/").concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},i=async e=>(await n.YD.get("".concat(r,"/organization?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,o=async e=>{let t=Number(e);return console.log("searchTerm",e,t,typeof t,typeof e),(await n.YD.get("".concat(r,"/bed?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(t):""))).data.data},c=async e=>(await n.YD.get("".concat(r,"/country?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,d=async e=>(await n.YD.get("".concat(r,"/supporter/supporter?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,u=async(e,t)=>(await n.YD.get("".concat(r,"/staff?").concat(t?"organization__eq=".concat(t,"&"):"","limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,m=async e=>{let t=await n.YD.get("".concat(r,"/user?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""));return console.log(t),t.data.data},p=async()=>(await n.YD.get("".concat(r,"/role"))).data.data},4395:function(e,t,a){"use strict";a.d(t,{$y:function(){return l},Pb:function(){return s},Tz:function(){return r},p_:function(){return i}});var n=a(2786);let r=async e=>(await (0,n.Ak)(e)).items.map(e=>({id:e._id,label:e.name})),s=async e=>(await (0,n.tE)(e)).items.map(e=>({id:e._id,label:e.name})),l=async e=>(await (0,n.GZ)(e)).items.map(e=>{var t;return{id:e._id,label:"".concat(e.bedNo," - ").concat(null==e?void 0:null===(t=e.organization)||void 0===t?void 0:t.name)}}),i=async e=>(await (0,n.uh)(e)).items.map(e=>({value:e._id,label:e.name}))},9093:function(e,t,a){"use strict";a.d(t,{V:function(){return r}});var n=a(3618);let r=async function(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{return console.log(typeof e),(await n.YD.put("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(t,"/").concat(a),e,{headers:{"Content-Type":r?"multipart/form-data":"application/json"}})).data.data}catch(t){console.log(t),console.log(t.response.data);let e=t.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},5420:function(e,t,a){"use strict";a.d(t,{x:function(){return n}});let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"INR";if(arguments.length>2&&void 0!==arguments[2]&&arguments[2],null==e)return"N/A";let a="string"==typeof e?parseFloat(e):e;if(isNaN(a))return"Invalid Amount";try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}catch(e){return console.error("Error formatting currency:",e),"".concat(t," ").concat(a.toFixed(2))}}},3455:function(e,t,a){"use strict";a.d(t,{Sp:function(){return n}});let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{year:"numeric",month:"short",day:"numeric"};if(!e)return"N/A";try{let a="string"==typeof e?new Date(e):e;if(isNaN(a.getTime()))return"Invalid Date";return new Intl.DateTimeFormat("en-US",t).format(a)}catch(e){return console.error("Error formatting date:",e),"Invalid Date"}}},4978:function(e,t,a){"use strict";var n=a(7261);t.Z={success:e=>{n.Am.success(e,{autoClose:2e3})},error:e=>{n.Am.error(e,{autoClose:2e3})},info:e=>{n.Am.info(e,{autoClose:2e3})},warning:e=>{n.Am.warning(e,{autoClose:2e3})}}}},function(e){e.O(0,[8310,9599,2234,1229,6827,7261,237,9027,3402,2519,1145,4285,8438,2971,2117,1744],function(){return e(e.s=7574)}),_N_E=e.O()}]);