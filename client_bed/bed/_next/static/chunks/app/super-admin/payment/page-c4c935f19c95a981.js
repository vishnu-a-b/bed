(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9668],{8611:function(e,a,t){Promise.resolve().then(t.bind(t,7933))},3327:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9205).Z)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])},1047:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},1723:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5252:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9205).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},525:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9205).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},5805:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},7810:function(e,a,t){"use strict";t.d(a,{Z:function(){return p}});var s=t(1119),r=t(2265),n=t(9448),l=t(1434),i=t(1993),o=t(1686),d=t(7673),c=t(6989),u=t(1717),m=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];t(4887),t(7935);var p=(0,r.forwardRef)(function(e,a){var t,p,x,h,g,f,y,v,b,j,N,_,w,A,D,k,P,S,C,I,M,Z,z,E,R,F,O,U,T,B,q,Y,L,V,G,K,W,H,X,J,Q,$,ee,ea,et,es,er,en,el,ei,eo,ed=(p=void 0!==(t=e.defaultOptions)&&t,h=void 0!==(x=e.cacheOptions)&&x,g=e.loadOptions,e.options,f=e.isLoading,y=e.onInputChange,v=e.filterOption,j=(b=(0,c.Z)(e,m)).inputValue,N=(0,r.useRef)(void 0),_=(0,r.useRef)(!1),w=(0,r.useState)(Array.isArray(p)?p:void 0),D=(A=(0,d.Z)(w,2))[0],k=A[1],P=(0,r.useState)(void 0!==j?j:""),C=(S=(0,d.Z)(P,2))[0],I=S[1],M=(0,r.useState)(!0===p),z=(Z=(0,d.Z)(M,2))[0],E=Z[1],R=(0,r.useState)(void 0),O=(F=(0,d.Z)(R,2))[0],U=F[1],T=(0,r.useState)([]),q=(B=(0,d.Z)(T,2))[0],Y=B[1],L=(0,r.useState)(!1),G=(V=(0,d.Z)(L,2))[0],K=V[1],W=(0,r.useState)({}),X=(H=(0,d.Z)(W,2))[0],J=H[1],Q=(0,r.useState)(void 0),ee=($=(0,d.Z)(Q,2))[0],ea=$[1],et=(0,r.useState)(void 0),er=(es=(0,d.Z)(et,2))[0],en=es[1],h!==er&&(J({}),en(h)),p!==ee&&(k(Array.isArray(p)?p:void 0),ea(p)),(0,r.useEffect)(function(){return _.current=!0,function(){_.current=!1}},[]),el=(0,r.useCallback)(function(e,a){if(!g)return a();var t=g(e,a);t&&"function"==typeof t.then&&t.then(a,function(){return a()})},[g]),(0,r.useEffect)(function(){!0===p&&el(C,function(e){_.current&&(k(e||[]),E(!!N.current))})},[]),ei=(0,r.useCallback)(function(e,a){var t=(0,u.L)(e,a,y);if(!t){N.current=void 0,I(""),U(""),Y([]),E(!1),K(!1);return}if(h&&X[t])I(t),U(t),Y(X[t]),E(!1),K(!1);else{var s=N.current={};I(t),E(!0),K(!O),el(t,function(e){_&&s===N.current&&(N.current=void 0,E(!1),U(t),Y(e||[]),K(!1),J(e?(0,o.Z)((0,o.Z)({},X),{},(0,i.Z)({},t,e)):X))})}},[h,el,O,X,y]),eo=G?[]:C&&O?q:D||[],(0,o.Z)((0,o.Z)({},b),{},{options:eo,isLoading:z||void 0!==f&&f,onInputChange:ei,filterOption:void 0===v?null:v})),ec=(0,l.u)(ed);return r.createElement(n.S,(0,s.Z)({ref:a},ec))})},6979:function(e,a,t){"use strict";t.d(a,{ZP:function(){return i}});var s=t(1434),r=t(1119),n=t(2265),l=t(9448);t(8242),t(4887),t(7935);var i=(0,n.forwardRef)(function(e,a){var t=(0,s.u)(e);return n.createElement(l.S,(0,r.Z)({ref:a},t))})},7933:function(e,a,t){"use strict";t.d(a,{default:function(){return Q}});var s=t(7437),r=t(2265),n=t(8438),l=t(3618),i=t(386),o=t(4291),d=t(2381),c=t(5060),u=t(535),m=t(3448);let p=(0,u.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),x=r.forwardRef((e,a)=>{let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{ref:a,role:"alert",className:(0,m.cn)(p({variant:r}),t),...n})});x.displayName="Alert",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("h5",{ref:a,className:(0,m.cn)("mb-1 font-medium leading-none tracking-tight",t),...r})}).displayName="AlertTitle";let h=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,m.cn)("text-sm [&_p]:leading-relaxed",t),...r})});h.displayName="AlertDescription";var g=t(9376),f=t(7520),y=t(3455),v=t(5420),b=t(9205);let j=(0,b.Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var N=t(1723);let _=(0,b.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),w=(0,b.Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var A=t(3193),D=t(4978);let k=async(e,a,t)=>{let s=(0,l.hP)();return(await fetch("".concat("https://api.donatebed.shanthibhavan.in/v1","/bed-payments/").concat(e,"/approve"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({approved:a,remarks:t})})).json()},P=[{accessorKey:"supporter.name",header:"Name"},{accessorKey:"supporter.user.mobileNo",header:"Phone No"},{accessorKey:"paymentDate",header:"Date",cell:e=>{var a,t;let{row:s}=e;return new Date((null==s?void 0:null===(a=s.original)||void 0===a?void 0:a.paymentDate)||(null==s?void 0:null===(t=s.original)||void 0===t?void 0:t.createdAt)).toLocaleDateString()}},{accessorKey:"amount",header:"Amount",cell:e=>{let{row:a}=e,t=a.original.currency||"AUD";return"".concat(t," ").concat(a.getValue("amount"))}},{accessorKey:"supporter.bed.bedNo",header:"Bed"},{accessorKey:"status",header:"Status",cell:e=>{let{row:a}=e,t=a.getValue("status"),r=a.original;return"offline"===r.paymentMode?!0===r.isApproved?(0,s.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 flex items-center gap-1",children:[(0,s.jsx)(j,{className:"w-3 h-3"}),"Approved"]}):(0,s.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800 flex items-center gap-1",children:[(0,s.jsx)(N.Z,{className:"w-3 h-3"}),"Pending Approval"]}):(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("completed"===t?"bg-green-100 text-green-800":"failed"===t?"bg-red-100 text-red-800":"pending"===t?"bg-yellow-100 text-yellow-800":"cancelled"===t?"bg-gray-100 text-gray-800":"refunded"===t||"partially_refunded"===t?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")})}},{accessorKey:"paymentMode",header:"Mode",cell:e=>{let{row:a}=e,t=a.getValue("paymentMode");return(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("online"===t?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:(null==t?void 0:t.charAt(0).toUpperCase())+(null==t?void 0:t.slice(1))||"Online"})}},{accessorKey:"viewDetails",header:"Actions",cell:e=>{let a=e.row.original;return(0,s.jsxs)(o.Vq,{children:[(0,s.jsx)(o.hg,{className:"underline",children:(0,s.jsx)("button",{className:"px-4 p-1 text-white bg-sidebar-primary rounded-full",children:"View"})}),(0,s.jsx)(o.cZ,{className:"p-6 max-w-4xl max-h-[80vh] overflow-y-auto",children:(0,s.jsx)(C,{data:a})})]})}}],S=e=>{let{payment:a,onApprovalUpdate:t}=e,[n,l]=(0,r.useState)(!1),[i,o]=(0,r.useState)(""),[u,m]=(0,r.useState)(!1),p=async e=>{if(!1===e&&!i.trim()){m(!0);return}l(!0);try{let s=await k(a._id,e,i);console.log(s),s.success?(t(a._id,e),D.Z.success("Payment ".concat(e?"approved":"rejected"," successfully").concat(e?". Receipt email sent to donor.":"")),m(!1),o("")):D.Z.error("Error processing approval")}catch(e){console.error("Error:",e),D.Z.error("Error processing approval")}finally{l(!1)}};return"offline"!==a.paymentMode?null:!0===a.isApproved?(0,s.jsxs)(x,{children:[(0,s.jsx)(j,{className:"h-4 w-4"}),(0,s.jsxs)(h,{children:["Payment approved and receipt sent to donor.",a.approvedAt&&(0,s.jsxs)("span",{className:"block text-xs text-gray-500 mt-1",children:["Approved on ",(0,y.Sp)(a.approvedAt)]})]})]}):!1===a.isApproved?(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsxs)(x,{children:[(0,s.jsx)(_,{className:"h-4 w-4"}),(0,s.jsx)(h,{children:"Payment has been rejected."})]}),u&&(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"approval-remarks",className:"text-sm font-medium",children:"Remarks"}),(0,s.jsx)("textarea",{id:"approval-remarks",value:i,onChange:e=>o(e.target.value),placeholder:"Enter approval remarks...",className:"w-full mt-1 min-h-[80px] px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",rows:3})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[!u&&(0,s.jsx)(d.z,{onClick:()=>m(!0),variant:"outline",size:"sm",children:"Add Remarks"}),(0,s.jsx)(d.z,{onClick:()=>p(!0),disabled:n,className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:n?"Processing...":"Approve & Send Receipt"})]})]}):(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsxs)(x,{children:[(0,s.jsx)(w,{className:"h-4 w-4"}),(0,s.jsx)(h,{children:"This manual payment is pending approval. Once approved, a receipt will be automatically sent to the donor."})]}),u&&(0,s.jsxs)("div",{children:[(0,s.jsxs)(c._,{htmlFor:"approval-remarks",className:"text-sm font-medium",children:["Remarks ",!u&&"(Required for rejection)"]}),(0,s.jsx)("textarea",{id:"approval-remarks",value:i,onChange:e=>o(e.target.value),placeholder:"Enter approval/rejection remarks...",className:"w-full mt-1 min-h-[80px] px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",rows:3})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[!u&&(0,s.jsx)(d.z,{onClick:()=>m(!0),variant:"outline",size:"sm",children:"Add Remarks"}),(0,s.jsx)(d.z,{onClick:()=>p(!0),disabled:n,className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:n?"Processing...":"Approve & Send Receipt"}),(0,s.jsx)(d.z,{onClick:()=>p(!1),disabled:n,className:"bg-red-600 hover:bg-red-700 text-white",size:"sm",children:n?"Processing...":"Reject"})]})]})},C=e=>{var a,t,n,l,o,c,u;let{data:m}=e,p=(0,i.I0)();(0,g.useRouter)();let x=(0,i.v9)(A.uy),[h,b]=(0,r.useState)(m);return(0,s.jsxs)("div",{className:"flex flex-col space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold border-b pb-2",children:"Payment Details"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"Basic Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Receipt Number"}),(0,s.jsx)("p",{className:"font-mono",children:h.receiptNumber||"N/A"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Amount"}),(0,s.jsxs)("p",{className:"font-semibold text-lg",children:[h.currency||"AUD"," ",(0,v.x)(h.amount)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,s.jsx)("p",{className:"capitalize font-medium",children:h.status})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Mode"}),(0,s.jsx)("p",{className:"capitalize",children:h.paymentMode||"online"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Date"}),(0,s.jsx)("p",{children:(0,y.Sp)(h.paymentDate||h.createdAt)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Source"}),(0,s.jsx)("p",{className:"capitalize",children:h.source||"website"})]})]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"Payer Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Name"}),(0,s.jsx)("p",{children:h.name||((null===(a=h.payer)||void 0===a?void 0:a.name)?"".concat(h.payer.name.given_name||""," ").concat(h.payer.name.surname||"").trim():"N/A")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,s.jsx)("p",{children:h.email||(null===(t=h.payer)||void 0===t?void 0:t.email_address)||"N/A"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Phone"}),(0,s.jsx)("p",{children:h.phNo||(null===(o=h.payer)||void 0===o?void 0:null===(l=o.phone)||void 0===l?void 0:null===(n=l.phone_number)||void 0===n?void 0:n.national_number)||"N/A"})]}),(null===(c=h.payer)||void 0===c?void 0:c.address)&&(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Address"}),(0,s.jsx)("p",{children:[h.payer.address.address_line_1,h.payer.address.admin_area_2,h.payer.address.admin_area_1,h.payer.address.postal_code,h.payer.address.country_code].filter(Boolean).join(", ")||h.address||"N/A"})]})]})]}),"online"===h.paymentMode&&(0,s.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"PayPal Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.paypal_order_id&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Order ID"}),(0,s.jsx)("p",{className:"text-xs font-mono break-all",children:h.paypal_order_id})]}),h.paypal_payment_id&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Payment ID"}),(0,s.jsx)("p",{className:"text-xs font-mono break-all",children:h.paypal_payment_id})]}),h.paypal_capture_id&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Capture ID"}),(0,s.jsx)("p",{className:"text-xs font-mono break-all",children:h.paypal_capture_id})]}),h.paypal_status&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Status"}),(0,s.jsx)("p",{className:"uppercase",children:h.paypal_status})]}),h.paypal_fee&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Fee"}),(0,s.jsxs)("p",{children:[h.paypal_fee.currency," ",h.paypal_fee.amount||0]})]}),h.net_amount&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Net Amount"}),(0,s.jsxs)("p",{className:"font-medium",children:[h.currency," ",(0,v.x)(h.net_amount)]})]})]})]}),"offline"===h.paymentMode&&(0,s.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"Manual Payment Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.manualMethod&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Method"}),(0,s.jsx)("p",{className:"capitalize",children:h.manualMethod})]}),h.transactionReference&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Transaction Reference"}),(0,s.jsx)("p",{children:h.transactionReference})]}),h.remarks&&(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Remarks"}),(0,s.jsx)("p",{children:h.remarks})]}),h.recordedBy&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Recorded By"}),(0,s.jsx)("p",{children:h.recordedBy.name||h.recordedBy.email||"N/A"})]})]})]}),h.contribution&&(0,s.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"Contribution Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Purpose"}),(0,s.jsx)("p",{className:"capitalize",children:(null===(u=h.contribution.purpose)||void 0===u?void 0:u.replace("_"," "))||"General Donation"})]}),h.contribution.description&&(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Description"}),(0,s.jsx)("p",{children:h.contribution.description})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"Approval Status"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Approved"}),(0,s.jsx)("p",{className:h.isApproved?"text-green-600 font-medium":"text-red-600 font-medium",children:!0===h.isApproved?"Yes":!1===h.isApproved?"No":"Pending"})]}),h.approvedBy&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Approved By"}),(0,s.jsx)("p",{children:h.approvedBy.name||h.approvedBy.email||"N/A"})]}),h.approvedAt&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Approved At"}),(0,s.jsx)("p",{children:(0,y.Sp)(h.approvedAt)})]})]})]}),(0,s.jsx)(S,{payment:h,onApprovalUpdate:(e,a)=>{b(e=>({...e,isApproved:a,approvedBy:{id:x.id},approvedAt:new Date().toISOString(),status:a?"completed":"cancelled"}))}}),h.error_details&&(h.error_details.error_code||h.error_details.error_message)&&(0,s.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3 text-red-800",children:"Error Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[h.error_details.error_code&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Error Code"}),(0,s.jsx)("p",{className:"font-mono text-red-600",children:h.error_details.error_code})]}),h.error_details.error_message&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Error Message"}),(0,s.jsx)("p",{className:"text-red-600",children:h.error_details.error_message})]}),h.error_details.debug_id&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Debug ID"}),(0,s.jsx)("p",{className:"font-mono text-xs",children:h.error_details.debug_id})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"Additional Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.createdAt&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Created At"}),(0,s.jsx)("p",{children:(0,y.Sp)(h.createdAt)})]}),h.updatedAt&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Updated At"}),(0,s.jsx)("p",{children:(0,y.Sp)(h.updatedAt)})]}),h.ip_address&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"IP Address"}),(0,s.jsx)("p",{className:"font-mono text-xs",children:h.ip_address})]}),h.user_agent&&(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"User Agent"}),(0,s.jsx)("p",{className:"text-xs break-all",children:h.user_agent})]})]})]})]}),(0,s.jsx)("div",{className:"flex gap-2 pt-4 border-t",children:(0,s.jsx)(d.z,{className:"text-sm",onClick:()=>{p((0,f.R5)("generous-payments")),p((0,f.h9)(h._id))},children:"Edit Payment"})})]})};var I=t(5805),M=t(525),Z=t(1047),z=t(3327),E=t(5252),R=e=>{let{onStatsLoad:a}=e,[t,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(null),u=async()=>{try{o(!0);let e=await l.YD.get("/bed-payments/stats"),t=e.data.data;console.log(e),n(t),null==a||a(t)}catch(e){c("Failed to load payment statistics"),console.error("Error fetching payment stats:",e)}finally{o(!1)}};(0,r.useEffect)(()=>{u()},[]);let m=e=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),p=e=>{let{title:a,amount:t,count:r,icon:n,gradient:l,textColor:i="text-white",subtitle:o=""}=e;return(0,s.jsxs)("div",{className:"".concat(l," rounded-xl p-6 shadow-lg transform hover:scale-105 transition-all duration-300 relative overflow-hidden"),children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-20 h-20 rounded-full bg-white/10"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 -mb-6 -ml-6 w-16 h-16 rounded-full bg-white/5"}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("div",{className:"p-3 rounded-lg bg-white/20 backdrop-blur-sm",children:(0,s.jsx)(n,{className:"w-6 h-6 ".concat(i)})}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm ".concat(i,"/80 font-medium"),children:a}),o&&(0,s.jsx)("p",{className:"text-xs ".concat(i,"/60"),children:o})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-3xl font-bold ".concat(i),children:m(t)}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(I.Z,{className:"w-4 h-4 ".concat(i,"/70")}),(0,s.jsxs)("p",{className:"text-sm ".concat(i,"/80"),children:[r," payment",1!==r?"s":""]})]})]})]})]})};return i?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:"bg-gray-200 animate-pulse rounded-xl h-40"},e))}):d?(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 mb-8",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,s.jsx)(M.Z,{className:"w-5 h-5 text-red-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"Error Loading Statistics"}),(0,s.jsx)("p",{className:"text-red-600",children:d})]})]})}):t?(0,s.jsxs)("div",{className:"mb-8 space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Statistics"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Overview of completed payments"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(p,{title:"Today",amount:t.today.amount,count:t.today.count,icon:N.Z,gradient:"bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700",subtitle:new Date().toLocaleDateString("en-AU",{weekday:"long",month:"short",day:"numeric"})}),(0,s.jsx)(p,{title:"This Week",amount:t.week.amount,count:t.week.count,icon:Z.Z,gradient:"bg-gradient-to-br from-green-500 via-green-600 to-green-700",subtitle:"Last 7 days"}),(0,s.jsx)(p,{title:"This Month",amount:t.month.amount,count:t.month.count,icon:M.Z,gradient:"bg-gradient-to-br from-purple-500 via-purple-600 to-purple-700",subtitle:new Date().toLocaleDateString("en-AU",{month:"long",year:"numeric"})}),(0,s.jsx)(p,{title:"All Time",amount:t.total.amount,count:t.total.count,icon:z.Z,gradient:"bg-gradient-to-br from-orange-500 via-orange-600 to-orange-700",subtitle:"Avg: ".concat(m(t.total.avgAmount))})]}),(0,s.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6 border border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,s.jsx)(E.Z,{className:"w-6 h-6 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Summary"}),(0,s.jsxs)("p",{className:"text-gray-600",children:[t.total.count," total completed payments"]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Average Payment Amount"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-600",children:m(t.total.avgAmount)})]})]})})]}):null},F=t(7162);function O(){var e;let a;let[t,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(0),[u,m]=(0,r.useState)(0),[p,x]=(0,r.useState)(10),[h,g]=(0,r.useState)(""),[f,y]=(0,r.useState)("all"),[v,b]=(0,r.useState)("all"),[j,N]=(0,r.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),2).toISOString().split("T")[0]}),_=(0,i.v9)(F.oM),[w,A]=(0,r.useState)(()=>{let e=new Date;return e.setHours(23,59,59,999),e.toISOString().split("T")[0]}),[D,k]=(0,r.useState)(""),S=(0,i.v9)(e=>e.update.refresh),C=(0,i.v9)(e=>e.payment.id),I=(0,r.useCallback)((e=e=>{k(e),m(0)},function(){for(var t=arguments.length,s=Array(t),r=0;r<t;r++)s[r]=arguments[r];clearTimeout(a),a=setTimeout(()=>{e(...s)},500)}),[]);async function M(){try{if(C){let e=await l.YD.get("/bed-payments/".concat(C,"&sort=-paymentDate")),a=[];return a[0]=e.data.data,c(1),a}let e="";"all"!==f&&(e="status__eq=".concat(f,"&"));let a="";"all"!==v&&(a="paymentMode__eq=".concat(v,"&"));let t=D?"search=".concat(D,"&"):"",s="limit=".concat(p,"&"),r="skip=".concat(u*p,"&"),n={filters:{startDate:j?new Date(j).toISOString():void 0,endDate:w?(()=>{let e=new Date(w);return e.setHours(23,59,59,999),e.toISOString()})():void 0}};console.log("/bed-payments?".concat(s).concat(r).concat(e).concat(a).concat(t,"sort=-paymentDate"));let i=await l.YD.post("/bed-payments?".concat(s).concat(r).concat(e).concat(a).concat(t,"sort=-paymentDate"),n,{headers:{"Content-Type":"application/json"}});console.log("hai",i);let o=i.data.data;return c(o.total||o.length),o.items||o}catch(e){return console.error("Error fetching payment data:",e),[]}}return(0,r.useEffect)(()=>{(async function(){let e=await M();e&&o(e)})()},[u,p,D,f,v,j,w,S,C]),(0,s.jsxs)("div",{className:"flex flex-col items-center p-4",children:[(0,s.jsx)(R,{}),(0,s.jsxs)("div",{className:"container mx-auto py-10",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,s.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:(0,s.jsxs)("div",{className:"flex flex-col flex-grow",children:[(0,s.jsx)("label",{className:"text-sm font-medium mb-1",children:"Search"}),(0,s.jsx)("input",{type:"text",value:h,onChange:e=>{let a=e.target.value;g(a),I(a)},placeholder:"Search by supporter name, mobile, bed number, email...",className:"p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Search in: Supporter name, mobile number, bed number, email, receipt number"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-sm font-medium mb-1",children:"Start Date"}),(0,s.jsx)("input",{type:"date",value:j,onChange:e=>{N(e.target.value),m(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-sm font-medium mb-1",children:"End Date"}),(0,s.jsx)("input",{type:"date",value:w,onChange:e=>{A(e.target.value),m(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-sm font-medium mb-1",children:"Status"}),(0,s.jsxs)("select",{value:f,onChange:e=>{y(e.target.value),m(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",children:[(0,s.jsx)("option",{value:"all",children:"All Statuses"}),(0,s.jsx)("option",{value:"completed",children:"✅ Completed"}),(0,s.jsx)("option",{value:"pending",children:"⏳ Pending"}),(0,s.jsx)("option",{value:"failed",children:"❌ Failed"}),(0,s.jsx)("option",{value:"cancelled",children:"\uD83D\uDEAB Cancelled"}),(0,s.jsx)("option",{value:"refunded",children:"\uD83D\uDCB0 Refunded"}),(0,s.jsx)("option",{value:"partially_refunded",children:"\uD83D\uDCB8 Partially Refunded"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-sm font-medium mb-1",children:"Payment Mode"}),(0,s.jsxs)("select",{value:v,onChange:e=>{b(e.target.value),m(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",children:[(0,s.jsx)("option",{value:"all",children:"All Payment Modes"}),(0,s.jsx)("option",{value:"online",children:"\uD83D\uDCBB Online"}),(0,s.jsx)("option",{value:"offline",children:"\uD83C\uDFEA Offline"})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{onClick:()=>{y("completed"),m(0)},className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("completed"===f?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Completed"}),(0,s.jsx)("button",{onClick:()=>{y("pending"),m(0)},className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("pending"===f?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Pending"}),(0,s.jsx)("button",{onClick:()=>{y("failed"),m(0)},className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("failed"===f?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Failed"}),(0,s.jsx)("button",{onClick:()=>{y("all"),b("all"),g(""),k(""),N(""),A(""),m(0)},className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:"Clear All Filters"})]})]}),(0,s.jsx)(n.w,{url:"bed-payments",columns:P,data:t,totalRows:d,pageIndex:u,pageSize:p,onPageChange:m,onPageSizeChange:x,actions:{delete:"superAdmin"===_,edit:"superAdmin"===_}})]})]})}var U=t(5974),T=t(9501),B=t(3590),q=t(1229),Y=t(279),L=t(6979),V=t(662),G=t(7810),K=t(4395);let W=async(e,a)=>({items:{}}),H=async(e,a,t)=>({_id:"updated"}),X=q.z.object({paypal_order_id:q.z.string().optional(),paypal_payment_id:q.z.string().optional(),paypal_payer_id:q.z.string().optional(),paypal_capture_id:q.z.string().optional(),name:q.z.string().optional(),phNo:q.z.string().optional(),email:q.z.string().email().optional().or(q.z.literal("")),address:q.z.string().optional(),amount:q.z.number().min(1,{message:"Amount must be positive"}),currency:q.z.enum(["AUD","USD"]).default("AUD"),status:q.z.enum(["pending","completed","failed","cancelled","refunded","partially_refunded"]),contribution:q.z.object({purpose:q.z.enum(["general_donation","medical_assistance","education_support","emergency_fund","other"]).default("general_donation"),description:q.z.string().default("General donation")}),paymentMode:q.z.enum(["online","offline"]).default("online"),manualMethod:q.z.enum(["cash","cheque","bank_transfer","other"]).optional(),transactionReference:q.z.string().optional(),paymentDate:q.z.string().optional(),remarks:q.z.string().optional(),source:q.z.enum(["website","mobile_app","social_media","email_campaign","other"]).default("website"),isApproved:q.z.boolean().default(!0),supporter:q.z.string().optional(),bed:q.z.string().optional()});var J=e=>{let{paymentId:a}=e,[t,n]=(0,r.useState)({value:"offline",label:"Offline"}),[l,i]=(0,r.useState)(),[o,u]=(0,r.useState)({value:"pending",label:"Pending"}),[m,p]=(0,r.useState)({value:"AUD",label:"AUD"}),[g,f]=(0,r.useState)({value:"general_donation",label:"General Donation"}),[y,v]=(0,r.useState)({value:"website",label:"Website"}),[b,j]=(0,r.useState)({value:!1,label:"No"}),{handleSubmit:N,register:_,setValue:w,formState:{errors:A},setError:k,watch:P}=(0,T.cI)({resolver:(0,B.F)(X),defaultValues:{contribution:{purpose:"general_donation",description:"General donation"},source:"website",currency:"AUD",status:"pending",paymentMode:"offline",isApproved:!1}}),[S,C]=(0,r.useState)(!1),[I,M]=(0,r.useState)();(0,r.useEffect)(()=>{a&&(async()=>{try{var e,t,s,r,l,o,d,c;let m=(await W(a,"bed-payments")).items;w("paypal_order_id",m.paypal_order_id||""),w("paypal_payment_id",m.paypal_payment_id||""),w("paypal_payer_id",m.paypal_payer_id||""),w("paypal_capture_id",m.paypal_capture_id||""),w("name",m.name||(null===(t=m.payer)||void 0===t?void 0:null===(e=t.name)||void 0===e?void 0:e.given_name)||""),w("phNo",m.phNo||""),w("email",m.email||(null===(s=m.payer)||void 0===s?void 0:s.email_address)||""),w("address",m.address||""),w("amount",m.amount),w("currency",m.currency||"AUD"),w("status",m.status||"pending"),w("paymentMode",m.paymentMode||"offline"),w("manualMethod",m.manualMethod||void 0),w("transactionReference",m.transactionReference||""),w("paymentDate",(null===(r=m.paymentDate)||void 0===r?void 0:r.split("T")[0])||""),w("remarks",m.remarks||""),w("isApproved",!1!==m.isApproved),w("contribution.purpose",(null===(l=m.contribution)||void 0===l?void 0:l.purpose)||"general_donation"),w("contribution.description",(null===(o=m.contribution)||void 0===o?void 0:o.description)||"General donation"),w("source",m.source||"website"),w("supporter",m.supporter||""),w("bed",m.bed||""),u({value:m.status||"pending",label:m.status?m.status.charAt(0).toUpperCase()+m.status.slice(1):"Pending"}),n({value:m.paymentMode||"offline",label:"online"===m.paymentMode?"Online":"Offline"}),p({value:m.currency||"AUD",label:m.currency||"AUD"}),f({value:(null===(d=m.contribution)||void 0===d?void 0:d.purpose)||"general_donation",label:(null===(c=m.contribution)||void 0===c?void 0:c.purpose)?m.contribution.purpose.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"General Donation"}),v({value:m.source||"website",label:m.source?m.source.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Website"}),j({value:!1!==m.isApproved,label:!1!==m.isApproved?"Yes":"No"}),m.manualMethod&&i({value:m.manualMethod,label:m.manualMethod.charAt(0).toUpperCase()+m.manualMethod.slice(1)})}catch(e){console.error("Error fetching payment details:",e)}})()},[a,w]);let Z=async e=>{C(!0);try{let t={...e,amount:Number(e.amount),...e.paymentDate&&{paymentDate:new Date(e.paymentDate).toISOString()}};if(a)(await H(t,"bed-payments",a))._id?D.Z.success("Payment updated successfully"):D.Z.error("Error updating payment");else{let a="offline"===e.paymentMode?"bed-payments/manual":"bed-payments",s=await (0,V.U)(a,t);console.log(s),s.payment._id?(D.Z.success("Manual payment created successfully".concat("offline"===e.paymentMode?" (Pending approval)":"")),z()):D.Z.error("Error creating payment")}}catch(e){console.error("Error submitting form:",e),D.Z.error("Error submitting form")}finally{C(!1)}},z=()=>{w("amount",0),w("status","pending"),w("paymentMode","offline"),w("isApproved",!1),w("contribution.purpose","general_donation"),w("contribution.description","General donation"),w("source","website"),w("currency","AUD"),w("name",""),w("email",""),w("phNo",""),w("address",""),w("transactionReference",""),w("paymentDate",""),w("remarks",""),w("supporter",""),w("bed",""),n({value:"offline",label:"Offline"}),u({value:"pending",label:"Pending"}),p({value:"AUD",label:"AUD"}),f({value:"general_donation",label:"General Donation"}),v({value:"website",label:"Website"}),j({value:!1,label:"No"}),i(void 0)};return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:["offline"===P("paymentMode")&&(0,s.jsx)(x,{className:"mb-6",children:(0,s.jsx)(h,{children:"Manual/offline payments require approval before receipts are sent to donors."})}),(0,s.jsxs)("form",{onSubmit:N(Z),className:"bg-white dark:bg-gray-900 shadow-lg rounded-lg p-6 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"amount",className:"required text-sm font-medium",children:"Amount *"}),(0,s.jsx)(Y.I,{id:"amount",type:"number",step:"0.01",..._("amount",{valueAsNumber:!0}),placeholder:"Enter amount",className:"w-full ".concat(A.amount?"border-red-500":"")}),A.amount&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:A.amount.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"currency",className:"text-sm font-medium",children:"Currency"}),(0,s.jsx)(L.ZP,{id:"currency",options:[{value:"AUD",label:"AUD"},{value:"USD",label:"USD"}],value:m,onChange:e=>{p(e),w("currency",e.value)},classNamePrefix:"select"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"paymentMode",className:"required text-sm font-medium",children:"Payment Mode *"}),(0,s.jsx)(L.ZP,{id:"paymentMode",options:[{value:"online",label:"Online"},{value:"offline",label:"Offline"}],value:t,onChange:e=>{n(e),w("paymentMode",e.value),"online"===e.value&&(i(void 0),w("manualMethod",void 0))},classNamePrefix:"select"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"status",className:"required text-sm font-medium",children:"Status *"}),(0,s.jsx)(L.ZP,{id:"status",options:[{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"},{value:"refunded",label:"Refunded"},{value:"partially_refunded",label:"Partially Refunded"}],value:o,onChange:e=>{u(e),w("status",e.value)},classNamePrefix:"select"})]}),"offline"===P("paymentMode")&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"manualMethod",className:"text-sm font-medium",children:"Manual Method"}),(0,s.jsx)(L.ZP,{id:"manualMethod",options:[{value:"cash",label:"Cash"},{value:"cheque",label:"Cheque"},{value:"bank_transfer",label:"Bank Transfer"},{value:"other",label:"Other"}],value:l,onChange:e=>{i(e),w("manualMethod",e.value)},classNamePrefix:"select",placeholder:"Select method..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"transactionReference",className:"text-sm font-medium",children:"Transaction Reference"}),(0,s.jsx)(Y.I,{id:"transactionReference",..._("transactionReference"),placeholder:"Cheque no, UTR, etc.",className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"paymentDate",className:"text-sm font-medium",children:"Payment Date"}),(0,s.jsx)(Y.I,{type:"date",id:"paymentDate",..._("paymentDate"),className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"isApproved",className:"text-sm font-medium",children:"Approved Status"}),(0,s.jsx)(L.ZP,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],value:b,onChange:e=>{j(e),w("isApproved",e.value)},classNamePrefix:"select"})]})]}),"online"===P("paymentMode")&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"paypal_payment_id",className:"text-sm font-medium",children:"PayPal Payment ID"}),(0,s.jsx)(Y.I,{id:"paypal_payment_id",..._("paypal_payment_id"),placeholder:"Enter PayPal payment ID",className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"paypal_order_id",className:"text-sm font-medium",children:"PayPal Order ID"}),(0,s.jsx)(Y.I,{id:"paypal_order_id",..._("paypal_order_id"),placeholder:"Enter PayPal order ID",className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"paypal_payer_id",className:"text-sm font-medium",children:"PayPal Payer ID"}),(0,s.jsx)(Y.I,{id:"paypal_payer_id",..._("paypal_payer_id"),placeholder:"Enter PayPal payer ID",className:"w-full"})]})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Payer Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"name",className:"text-sm font-medium",children:"Payer Name"}),(0,s.jsx)(Y.I,{id:"name",..._("name"),placeholder:"Enter payer name",className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),(0,s.jsx)(Y.I,{id:"email",type:"email",..._("email"),placeholder:"Enter payer email",className:"w-full ".concat(A.email?"border-red-500":"")}),A.email&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:A.email.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"phNo",className:"text-sm font-medium",children:"Phone Number"}),(0,s.jsx)(Y.I,{id:"phNo",..._("phNo"),placeholder:"Enter payer phone number",className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"address",className:"text-sm font-medium",children:"Address"}),(0,s.jsx)(Y.I,{id:"address",..._("address"),placeholder:"Enter payer address",className:"w-full"})]})]})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Optional References"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"head",children:"Supporter"}),(0,s.jsx)(G.Z,{cacheOptions:!0,loadOptions:K.zc,defaultOptions:!0,value:I,onChange:e=>{console.log(e),w("supporter",e.value||""),w("bed",e.bed||""),M(e)},classNamePrefix:"select",isClearable:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"bed",className:"text-sm font-medium",children:"Bed ID (Optional)"}),(0,s.jsx)(Y.I,{id:"bed",..._("bed"),placeholder:"Enter bed ID if applicable",className:"w-full"})]})]})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Contribution Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"purpose",className:"text-sm font-medium",children:"Contribution Purpose"}),(0,s.jsx)(L.ZP,{id:"purpose",options:[{value:"general_donation",label:"General Donation"},{value:"medical_assistance",label:"Medical Assistance"},{value:"education_support",label:"Education Support"},{value:"emergency_fund",label:"Emergency Fund"},{value:"other",label:"Other"}],value:g,onChange:e=>{f(e),w("contribution.purpose",e.value),w("contribution.description","general_donation"===e.value?"General donation":"".concat(e.label," contribution"))},classNamePrefix:"select"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"source",className:"text-sm font-medium",children:"Source"}),(0,s.jsx)(L.ZP,{id:"source",options:[{value:"website",label:"Website"},{value:"mobile_app",label:"Mobile App"},{value:"social_media",label:"Social Media"},{value:"email_campaign",label:"Email Campaign"},{value:"other",label:"Other"}],value:y,onChange:e=>{v(e),w("source",e.value)},classNamePrefix:"select"})]})]})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)(c._,{htmlFor:"remarks",className:"text-sm font-medium",children:"Remarks"}),(0,s.jsx)("textarea",{id:"remarks",..._("remarks"),placeholder:"Enter any additional remarks or notes",className:"w-full min-h-[80px] px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-800 dark:text-white",rows:3})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center col-span-1 lg:col-span-2 pt-4 border-t",children:[(0,s.jsx)(d.z,{type:"button",onClick:z,className:"bg-gray-500 hover:bg-gray-600 text-white",disabled:S,children:a?"Cancel":"Clear"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[!a&&"offline"===P("paymentMode")&&(0,s.jsx)("span",{className:"text-sm text-amber-600 dark:text-amber-400 flex items-center",children:"⚠️ Will require manual approval"}),(0,s.jsx)(d.z,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white ".concat(S?"cursor-not-allowed opacity-50":""),disabled:S,children:S?"Processing...":a?"Update Payment":"Create Payment"})]})]})]})]})};function Q(){let[e,a]=(0,r.useState)(!0),t=(0,i.I0)(),n=(0,i.v9)(e=>e.update.url),l=(0,i.v9)(e=>e.update.id);return(0,s.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Payments"}),"payment"===n?"":(0,s.jsx)(d.z,{onClick:()=>{t((0,U.Ib)()),t((0,f.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Payment":"View Payments"})]}),"payment"===n?l&&(0,s.jsx)("div",{}):e?(0,s.jsx)(O,{}):(0,s.jsx)(J,{})]})}},4291:function(e,a,t){"use strict";t.d(a,{$N:function(){return x},Be:function(){return h},Vq:function(){return o},cZ:function(){return m},fK:function(){return p},hg:function(){return d}});var s=t(7437),r=t(2265),n=t(9027),l=t(653),i=t(3448);let o=n.fC,d=n.xz,c=n.h_;n.x8;let u=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(n.aV,{ref:a,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});u.displayName=n.aV.displayName;let m=r.forwardRef((e,a)=>{let{className:t,children:r,...o}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(n.VY,{ref:a,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[r,(0,s.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(l.Pxu,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.VY.displayName;let p=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};p.displayName="DialogHeader";let x=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(n.Dx,{ref:a,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});x.displayName=n.Dx.displayName;let h=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(n.dk,{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",t),...r})});h.displayName=n.dk.displayName},279:function(e,a,t){"use strict";t.d(a,{I:function(){return l}});var s=t(7437),r=t(2265),n=t(3448);let l=r.forwardRef((e,a)=>{let{className:t,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input  px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...l})});l.displayName="Input"},5060:function(e,a,t){"use strict";t.d(a,{_:function(){return d}});var s=t(7437),r=t(2265),n=t(6394),l=t(535),i=t(3448);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(n.f,{ref:a,className:(0,i.cn)(o(),t),...r})});d.displayName=n.f.displayName},7162:function(e,a,t){"use strict";t.d(a,{Jt:function(){return o},gD:function(){return r},oM:function(){return i},tR:function(){return n}});let s=(0,t(1455).oM)({name:"auth",initialState:{role:"",isAuth:!1,accessToken:""},reducers:{setRole:(e,a)=>{e.role=a.payload},setIsAuth:(e,a)=>{e.isAuth=a.payload},setAccessToken:(e,a)=>{e.accessToken=a.payload}}}),{setRole:r,setIsAuth:n,setAccessToken:l}=s.actions,i=e=>e.auth.role,o=e=>e.auth.isAuth;a.ZP=s.reducer},5974:function(e,a,t){"use strict";t.d(a,{Ib:function(){return n}});let s=(0,t(1455).oM)({name:"payment",initialState:{id:null,paymentId:null},reducers:{setPaymentId:(e,a)=>{e.paymentId=a.payload},clearPaymentId:e=>{e.paymentId=null}}}),{setPaymentId:r,clearPaymentId:n}=s.actions;a.ZP=s.reducer},3193:function(e,a,t){"use strict";t.d(a,{XN:function(){return r},uy:function(){return n}});let s=(0,t(1455).oM)({name:"user",initialState:{id:"",role:"",name:"",photo:""},reducers:{setUserDetails:(e,a)=>{let{id:t,role:s,name:r,photo:n}=a.payload;e.id=t,e.role=s,e.name=r,e.photo=n}}}),{setUserDetails:r}=s.actions,n=e=>e.user;a.ZP=s.reducer},662:function(e,a,t){"use strict";t.d(a,{U:function(){return r}});var s=t(3618);let r=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let r=await s.YD.post("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(e,"/"),a,{headers:{"Content-Type":t?"multipart/form-data":"application/json"}});return console.log(r),r.data.data}catch(a){console.error("Error creating data:",a);let e=a.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},2786:function(e,a,t){"use strict";t.d(a,{Ak:function(){return i},GZ:function(){return o},WX:function(){return c},bp:function(){return l},dQ:function(){return u},fp:function(){return p},rQ:function(){return n},tE:function(){return d},uh:function(){return m}});var s=t(3618);let r="https://api.donatebed.shanthibhavan.in/v1",n=async e=>{try{return{items:(await s.YD.get("/".concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},l=async(e,a)=>{try{return{items:(await s.YD.get("/".concat(a,"/").concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},i=async e=>(await s.YD.get("".concat(r,"/organization?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,o=async e=>{let a=Number(e);return console.log("searchTerm",e,a,typeof a,typeof e),(await s.YD.get("".concat(r,"/bed?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(a):""))).data.data},d=async e=>(await s.YD.get("".concat(r,"/country?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,c=async e=>(await s.YD.get("".concat(r,"/supporter/supporter?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,u=async(e,a)=>(await s.YD.get("".concat(r,"/staff?").concat(a?"organization__eq=".concat(a,"&"):"","limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,m=async e=>{let a=await s.YD.get("".concat(r,"/user?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""));return console.log(a),a.data.data},p=async()=>(await s.YD.get("".concat(r,"/role"))).data.data},4395:function(e,a,t){"use strict";t.d(a,{$y:function(){return l},Pb:function(){return n},Tz:function(){return r},p_:function(){return i},zc:function(){return o}});var s=t(2786);let r=async e=>(await (0,s.Ak)(e)).items.map(e=>({id:e._id,label:e.name})),n=async e=>(await (0,s.tE)(e)).items.map(e=>({id:e._id,label:e.name})),l=async e=>(await (0,s.GZ)(e)).items.map(e=>{var a;return{id:e._id,label:"".concat(e.bedNo," - ").concat(null==e?void 0:null===(a=e.organization)||void 0===a?void 0:a.name)}}),i=async e=>(await (0,s.uh)(e)).items.map(e=>({value:e._id,label:e.name})),o=async e=>(await (0,s.WX)(e)).items.map(e=>({value:e._id,label:e.name,bed:e.bed._id}))},5420:function(e,a,t){"use strict";t.d(a,{x:function(){return s}});let s=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"INR";if(arguments.length>2&&void 0!==arguments[2]&&arguments[2],null==e)return"N/A";let t="string"==typeof e?parseFloat(e):e;if(isNaN(t))return"Invalid Amount";try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}catch(e){return console.error("Error formatting currency:",e),"".concat(a," ").concat(t.toFixed(2))}}},3455:function(e,a,t){"use strict";t.d(a,{Sp:function(){return s}});let s=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{year:"numeric",month:"short",day:"numeric"};if(!e)return"N/A";try{let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"Invalid Date";return new Intl.DateTimeFormat("en-US",a).format(t)}catch(e){return console.error("Error formatting date:",e),"Invalid Date"}}},4978:function(e,a,t){"use strict";var s=t(7261);a.Z={success:e=>{s.Am.success(e,{autoClose:2e3})},error:e=>{s.Am.error(e,{autoClose:2e3})},info:e=>{s.Am.info(e,{autoClose:2e3})},warning:e=>{s.Am.warning(e,{autoClose:2e3})}}}},function(e){e.O(0,[8310,3464,969,1229,6827,7261,237,9027,3402,8575,1455,1145,4285,8438,2971,2117,1744],function(){return e(e.s=8611)}),_N_E=e.O()}]);