(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8445],{8445:function(e,a,t){Promise.resolve().then(t.bind(t,4687))},6979:function(e,a,t){"use strict";t.d(a,{ZP:function(){return i}});var s=t(1434),r=t(1119),l=t(2265),n=t(9448);t(8242),t(4887),t(7935);var i=(0,l.forwardRef)(function(e,a){var t=(0,s.u)(e);return l.createElement(n.S,(0,r.Z)({ref:a},t))})},4687:function(e,a,t){"use strict";t.d(a,{default:function(){return I}});var s=t(7437),r=t(2265),l=t(8438),n=t(3618),i=t(386);let d=[{accessorKey:"name",header:"Organization Name"},{accessorKey:"management",header:"Management"}];function o(){var e;let a;let[t,o]=(0,r.useState)([]),[c,m]=(0,r.useState)(0),[u,g]=(0,r.useState)(0),[h,x]=(0,r.useState)(10),[p,b]=(0,r.useState)(""),[v,f]=(0,r.useState)(""),[j,N]=(0,r.useState)(""),w=(0,i.v9)(e=>e.update.refresh),y=(0,i.v9)(e=>e.organization.id),k=(0,r.useCallback)((e=e=>{N(e),g(0)},function(){for(var t=arguments.length,s=Array(t),r=0;r<t;r++)s[r]=arguments[r];clearTimeout(a),a=setTimeout(()=>{e(...s)},500)}),[]);async function z(){try{let e="";if(y){let e=await n.YD.get("/organization/".concat(y)),a=[];return a[0]=e.data.data,m(1),a}"Active"===v?e="isActive__eq=true&":"InActive"===v&&(e="isActive__eq=false&");let a=(await n.YD.get("/organization?limit=".concat(h,"&skip=").concat(u*h,"&").concat(e).concat(j?"search=".concat(j,"&"):""))).data.data;return m(a.total),a.items}catch(e){console.error("Error fetching data:",e)}}return(0,r.useEffect)(()=>{(async function(){o(await z())})(),console.log("Fetching data with params:",t)},[u,h,j,v,w,y]),(0,s.jsx)("div",{className:"flex flex-col items-center p-4",children:(0,s.jsxs)("div",{className:"container mx-auto py-10",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("input",{type:"text",value:p,onChange:e=>{let a=e.target.value;b(a),k(a)},placeholder:"Search organizations...",className:"mb-4 p-2 border rounded"}),(0,s.jsxs)("select",{value:v,onChange:e=>{f(e.target.value),g(0)},className:"mb-4 p-2 border border-gray-300 rounded",children:[(0,s.jsx)("option",{value:"all",children:"All"}),(0,s.jsx)("option",{value:"Active",children:"Active"}),(0,s.jsx)("option",{value:"InActive",children:"InActive"})]})]}),(0,s.jsx)(l.w,{url:"organization",columns:d,data:t,totalRows:c,pageIndex:u,pageSize:h,onPageChange:g,onPageSizeChange:x,actions:{delete:!0,edit:!0}})]})})}var c=t(2381),m=t(2664),u=t(7520),g=t(9501),h=t(3590),x=t(1229),p=t(279),b=t(5060),v=t(3448);let f=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("textarea",{className:(0,v.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...r})});f.displayName="Textarea";var j=t(4978),N=t(9093),w=t(662),y=t(2786),k=t(6528),z=t(1929),C=t(4395),S=t(7810),_=t(7480);let F=x.z.object({address:x.z.string().min(1,{message:"Address is required"}).max(200),management:x.z.string().optional(),pinCode:x.z.string().min(1,{message:"Pin Code is required"}).max(10),latitude:x.z.number({message:"Expected a Number"}).optional(),longitude:x.z.number({message:"Expected a Number"}).optional(),name:x.z.string().min(1,{message:"Name is required"}).max(200),photos:x.z.array(x.z.string().max(200)).optional(),vcLink:x.z.string().max(200).optional(),contactMobileNumbers:x.z.array(x.z.string().max(20)).optional()});var E=e=>{let{organizationId:a}=e,[t,l]=(0,r.useState)([""]),[n,d]=(0,r.useState)([]),[o,m]=(0,r.useState)(!1),[x,v]=(0,r.useState)(""),[E,I]=(0,r.useState)(!1),[O,L]=(0,r.useState)(),M=(0,i.I0)(),[A,P]=(0,r.useState)([]),[Z,q]=(0,r.useState)(!1),{handleSubmit:U,register:B,setValue:D,formState:{errors:K},setError:R}=(0,g.cI)({resolver:(0,h.F)(F)});(0,r.useEffect)(()=>{a&&(async()=>{m(!0);try{var e,t,s,r,n,i;let o=(await (0,y.bp)(a,"organization")).items;if(v(null===(e=o.address)||void 0===e?void 0:e._id),D("name",o.name),D("address",(null===(t=o.address)||void 0===t?void 0:t.address)||""),D("pinCode",(null===(s=o.address)||void 0===s?void 0:s.pinCode)||""),D("latitude",(null===(r=o.address)||void 0===r?void 0:r.latitude)||void 0),D("longitude",(null===(n=o.address)||void 0===n?void 0:n.longitude)||void 0),D("vcLink",o.vcLink||""),D("management",o.management||""),l((null===(i=o.contactMobileNumbers)||void 0===i?void 0:i.length)===0?[""]:o.contactMobileNumbers||[""]),d(o.photos||[]),o.admin){let e=await (0,y.bp)(o.admin,"user");console.log(e);let a=e.items;L({value:o.admin,label:a.name})}m(!1)}catch(e){console.error("Error fetching organization details:",e),m(!1)}})()},[a,D]);let T=()=>{l([...t,""])},V=e=>{l(t.filter((a,t)=>t!==e))},W=()=>{l([""]),d([]),D("name",""),D("address",""),D("pinCode",""),D("latitude",void 0),D("longitude",void 0),D("management",""),D("vcLink",""),L(void 0),M((0,u.Oe)())},Y=(e,a)=>{let s=[...t];s[e]=a,l(s)},G=async e=>{q(!0);try{let s={...e.address&&{address:e.address},...e.pinCode&&{pinCode:e.pinCode},...e.latitude&&{latitude:e.latitude},...e.longitude&&{longitude:e.longitude},taluk:"Unknown",district:"Unknown"},r=await Promise.all(A.map(async e=>{if(e.file)return e.file}));if(a){let l=x;x?await (0,N.V)(s,"address",x):l=(await (0,w.U)("address",s))._id,console.log(r);let n={...e.name&&{name:e.name},...r.length>0&&{photos:r},...e.vcLink&&{vcLink:e.vcLink},...t.length>0&&{contactMobileNumbers:t,address:l},...e.management&&{management:e.management},...O&&{admin:O.value}};console.log(n);let i=await (0,N.V)(n,"organization",a,!0);i._id?(j.Z.success("organization updated successfully"),W()):(R(i.id,{message:i.value}),j.Z.error("An error occurred while submitting the form"))}else{let a=await (0,w.U)("address",s);if(a._id){let s={...e.name&&{name:e.name},...a._id&&{address:a._id},...n.length>0&&{photos:n},...e.vcLink&&{vcLink:e.vcLink},...t.length>0&&{contactMobileNumbers:t},...e.management&&{management:e.management},...O&&{admin:O.value}},r=await (0,w.U)("organization",s,!0);r._id?(j.Z.success("organization created successfully"),W()):((0,k.S)("address",a._id),R(r.id,{message:r.value}),j.Z.error("An error occurred while submitting the form"))}else R(a.id,{message:a.value}),j.Z.error("An error occurred while submitting the form")}}catch(e){console.error("Failed to submit form:",e),j.Z.error("An error occurred while submitting the form")}finally{q(!1)}};return o?(0,s.jsx)("div",{className:"flex items-center justify-center w-full h-[70vh]",children:(0,s.jsx)("div",{className:"loader"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("form",{onSubmit:U(G),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)(b._,{htmlFor:"name",className:"required",children:"Name"}),(0,s.jsx)(p.I,{id:"name",...B("name"),placeholder:"Enter organization name",className:"w-full border rounded p-2 ".concat(K.name?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),K.name&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.name.message})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)(b._,{htmlFor:"management",children:"Management"}),(0,s.jsx)(p.I,{id:"management",...B("management"),placeholder:"Enter management name",className:"w-full border rounded p-2 ".concat(K.management?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),K.management&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.management.message})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)(b._,{htmlFor:"address",className:"required",children:"Address"}),(0,s.jsx)(f,{id:"address",...B("address"),placeholder:"Enter address",className:"w-full border rounded p-2 ".concat(K.address?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),K.address&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.address.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b._,{htmlFor:"pinCode",className:" required ",children:"Pin Code"}),(0,s.jsx)(p.I,{id:"pinCode",...B("pinCode"),placeholder:"Enter pin code",className:"w-full border rounded p-2 ".concat(K.pinCode?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),K.pinCode&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.pinCode.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b._,{htmlFor:"latitude",children:"Latitude"}),(0,s.jsx)(p.I,{id:"latitude",type:"text",step:"any",...B("latitude",{valueAsNumber:!0}),placeholder:"Enter latitude",className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),K.latitude&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.latitude.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b._,{htmlFor:"longitude",children:"Longitude"}),(0,s.jsx)(p.I,{id:"longitude",type:"text",step:"any",...B("longitude",{valueAsNumber:!0}),placeholder:"Enter longitude",className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),K.longitude&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.longitude.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b._,{htmlFor:"vcLink",children:"organization Link"}),(0,s.jsx)(p.I,{id:"vcLink",...B("vcLink"),placeholder:"Enter organization Link",className:"w-full border rounded p-2 ".concat(K.vcLink?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),K.vcLink&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.vcLink.message})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)(b._,{htmlFor:"admin",children:"Admin"}),(0,s.jsxs)("div",{className:" flex space-x-2 ",children:[(0,s.jsx)(S.Z,{cacheOptions:!0,loadOptions:C.p_,defaultOptions:!0,value:O,onChange:e=>{e?L(e):L(void 0)},classNamePrefix:"select",className:"flex-1",isClearable:!0}),(0,s.jsx)(c.z,{onClick:()=>{I(!E)},children:"+"})]}),K.vcLink&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.vcLink.message})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)(b._,{htmlFor:"photos",children:"Photos"}),(0,s.jsx)(_.J,{value:A,dropzoneOptions:{maxFiles:6,maxSize:5242880},onChange:P,onFilesAdded:async e=>{P([...A,...e])}}),K.photos&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.photos.message})]}),(0,s.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,s.jsx)(b._,{htmlFor:"contactMobileNumbers",children:"Contact Mobile Numbers"}),t.map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center space-x-2 ",children:[(0,s.jsx)(p.I,{value:e,onChange:e=>Y(a,e.target.value),placeholder:"Enter mobile number",className:"flex-1 border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),t.length>1&&(0,s.jsx)(c.z,{type:"button",onClick:()=>V(a),className:"bg-red-500 text-white hover:bg-red-600",children:"-"}),a===t.length-1&&(0,s.jsx)(c.z,{type:"button",onClick:T,className:" bg-sidebar-accent text-white",children:"+"})]},a)),K.contactMobileNumbers&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:K.contactMobileNumbers.message})]}),(0,s.jsxs)("div",{className:"flex justify-between col-span-1 lg:col-span-2",children:[(0,s.jsx)(c.z,{onClick:W,className:" bg-slate-400 hover:bg-slate-500",children:a?"Cancel":"Clear"}),(0,s.jsx)(c.z,{className:Z?"cursor-not-allowed opacity-50":"",type:"submit",children:a?"Update":"Create"})]})]}),E&&(0,s.jsx)(z.Z,{onClose:()=>I(!1),role:"6771959e0c2a67fe52bcf45f",userSet:L})]})};function I(){let[e,a]=(0,r.useState)(!0),t=(0,i.I0)(),l=(0,i.v9)(e=>e.update.url),n=(0,i.v9)(e=>e.update.id);return(0,s.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Organizations"}),"organization"===l?"":(0,s.jsx)(c.z,{onClick:()=>{t((0,m.KL)()),t((0,u.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Organization":"View Organizations"})]}),"organization"===l?n&&(0,s.jsx)(E,{organizationId:n}):e?(0,s.jsx)(o,{}):(0,s.jsx)(E,{})]})}},1929:function(e,a,t){"use strict";var s=t(7437),r=t(2265),l=t(9501),n=t(1229),i=t(3590),d=t(279),o=t(2381),c=t(5060),m=t(6979),u=t(4978),g=t(662),h=t(3965);let x=n.z.object({name:n.z.string().min(1,{message:"Name is required"}).max(100),mobileNo:n.z.string().min(1,{message:"Mobile number is required"}).max(20),email:n.z.string().email({message:"Invalid email format"}).optional(),photo:n.z.string().optional(),dateOfBirth:n.z.string().optional(),gender:n.z.enum(["Male","Female","Other"],{message:"Gender is required"}).optional(),maritalStatus:n.z.enum(["Unknown","Bachelor","Married","Divorced","Widower"],{message:"Invalid marital status"}).optional(),password:n.z.string().min(6,{message:"Password must be at least 6 characters"}),role:n.z.string().optional()});a.Z=e=>{let{onClose:a,role:t,userSet:n}=e;console.log(t);let{handleSubmit:p,register:b,setValue:v,formState:{errors:f}}=(0,l.cI)({resolver:(0,i.F)(x)}),[j,N]=(0,r.useState)(null),[w,y]=(0,r.useState)({value:"Male",label:"Male"}),[k,z]=(0,r.useState)({value:"Unknown",label:"Unknown"}),C=async(e,s)=>{s.preventDefault(),console.log(e);try{let s={...e.name&&{name:e.name},...e.mobileNo&&{mobileNo:e.mobileNo},...e.email&&{email:e.email},...j&&{photo:j},...e.dateOfBirth&&{dateOfBirth:e.dateOfBirth},...w&&{gender:w.value},...k&&{maritalStatus:k.value},...e.mobileNo&&{password:e.mobileNo},role:t},r=await (0,g.U)("user",s,!0);console.log(r),r._id?(n({value:r._id,label:e.name}),u.Z.success("User created successfully"),a()):u.Z.error("Error creating user")}catch(e){console.error("Error submitting form:",e),u.Z.error("Error submitting form")}};return(0,s.jsx)("div",{className:"fixed inset-x-0 inset-y-[-16px] bg-black bg-opacity-50 flex justify-center items-center z-100 ",children:(0,s.jsxs)("div",{className:"p-2  bg-white sm:p-6 rounded-lg shadow-md ",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Create User"}),(0,s.jsxs)("form",{onSubmit:p(C),className:"grid grid-cols-2 sm:gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"name",className:"required",children:"Name"}),(0,s.jsx)(d.I,{id:"name",...b("name"),placeholder:"Enter name",className:"w-full ".concat(f.name?"border-red-500":"")}),f.name&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"mobileNo",className:"required",children:"Mobile Number"}),(0,s.jsx)(d.I,{id:"mobileNo",...b("mobileNo"),placeholder:"Enter mobile number",className:"w-full ".concat(f.mobileNo?"border-red-500":"")}),f.mobileNo&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.mobileNo.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"email",children:"Email"}),(0,s.jsx)(d.I,{id:"email",...b("email"),placeholder:"Enter email",className:"w-full"}),f.email&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.email.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"dateOfBirth",children:"Date of Birth"}),(0,s.jsx)(d.I,{type:"date",id:"dateOfBirth",...b("dateOfBirth",{valueAsDate:!1})}),f.dateOfBirth&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.dateOfBirth.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{children:"Gender"}),(0,s.jsx)(m.ZP,{id:"gender",name:"gender",value:w,options:h.P,classNamePrefix:"select",onChange:e=>{v("gender",e.value),y(e)}}),f.gender&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.gender.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"maritalStatus",children:"Marital Status"}),(0,s.jsx)(m.ZP,{id:"maritalStatus",name:"maritalStatus",options:[{value:"Unknown",label:"Unknown"},{value:"Bachelor",label:"Bachelor"},{value:"Married",label:"Married"},{value:"Divorced",label:"Divorced"},{value:"Widower",label:"Widower"}],classNamePrefix:"select",value:k,onChange:e=>{v("maritalStatus",e.value),z(e)}}),f.maritalStatus&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.maritalStatus.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"photo",children:"Photo"}),(0,s.jsx)(d.I,{id:"photo",type:"file",onChange:e=>{e.target.files&&e.target.files[0]&&N(e.target.files[0])},className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),f.photo&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.photo.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c._,{htmlFor:"password",className:"required",children:"Password"}),(0,s.jsx)(d.I,{id:"password",type:"password",...b("password"),placeholder:"Enter password",className:"w-full ".concat(f.password?"border-red-500":"")}),f.password&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f.password.message})]}),(0,s.jsxs)("div",{className:" col-span-2 flex justify-between space-x-2",children:[(0,s.jsx)(o.z,{onClick:a,className:"bg-gray-400 hover:bg-gray-500",children:"Cancel"}),(0,s.jsx)(o.z,{type:"submit",children:"Create"})]})]})]})})}},3965:function(e,a,t){"use strict";t.d(a,{P:function(){return s}});let s=[{value:"Male",label:"Male"},{value:"Female",label:"Female"},{value:"Other",label:"Other"}]},2664:function(e,a,t){"use strict";t.d(a,{KL:function(){return l}});let s=(0,t(1455).oM)({name:"business",initialState:{id:null,name:null},reducers:{setOrganizationId:(e,a)=>{e.id=a.payload},clearOrganizationId:e=>{e.id=null},setOrganizationName:(e,a)=>{e.name=a.payload},clearOrganizationName:e=>{e.name=null}}}),{setOrganizationId:r,clearOrganizationId:l,setOrganizationName:n,clearOrganizationName:i}=s.actions;a.ZP=s.reducer},6528:function(e,a,t){"use strict";t.d(a,{S:function(){return r}});var s=t(3618);let r=async(e,a)=>{try{let t=await s.YD.delete("".concat(e,"/").concat(a));return console.log(t),t}catch(e){console.error("Error deleting data:",e)}}}}]);