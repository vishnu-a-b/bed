"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5500],{5500:function(e,a,s){s.d(a,{default:function(){return g}});var t=s(7437),r=s(8438),l=s(2265),n=s(3618),d=s(386),i=s(4291),c=s(2381),o=s(9376),m=s(7520),x=s(3455),p=s(5420);let u=[{accessorKey:"name",header:"Name",cell:e=>{var a,s,t,r;let{row:l}=e,n=l.original;return n.name||(null===(s=n.payer)||void 0===s?void 0:null===(a=s.name)||void 0===a?void 0:a.given_name)+" "+(null===(r=n.payer)||void 0===r?void 0:null===(t=r.name)||void 0===t?void 0:t.surname)||"N/A"}},{accessorKey:"phNo",header:"Phone No",cell:e=>{var a;let{row:s}=e,t=s.original;return t.phNo||(null===(a=t.payer)||void 0===a?void 0:a.phone)||"N/A"}},{accessorKey:"paymentDate",header:"Date",cell:e=>{var a,s;let{row:t}=e;return new Date((null==t?void 0:null===(a=t.original)||void 0===a?void 0:a.paymentDate)||(null==t?void 0:null===(s=t.original)||void 0===s?void 0:s.createdAt)).toLocaleDateString()}},{accessorKey:"amount",header:"Amount",cell:e=>{let{row:a}=e,s=a.original.currency||"AUD";return"".concat(s," ").concat(a.getValue("amount"))}},{accessorKey:"status",header:"Status",cell:e=>{let{row:a}=e,s=a.getValue("status");return(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("completed"===s?"bg-green-100 text-green-800":"failed"===s?"bg-red-100 text-red-800":"pending"===s?"bg-yellow-100 text-yellow-800":"cancelled"===s?"bg-gray-100 text-gray-800":"refunded"===s||"partially_refunded"===s?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:s.charAt(0).toUpperCase()+s.slice(1).replace("_"," ")})}},{accessorKey:"paymentMode",header:"Mode",cell:e=>{let{row:a}=e,s=a.getValue("paymentMode");return(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("online"===s?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:(null==s?void 0:s.charAt(0).toUpperCase())+(null==s?void 0:s.slice(1))||"Online"})}},{accessorKey:"viewDetails",header:"Actions",cell:e=>{let a=e.row.original;return(0,t.jsxs)(i.Vq,{children:[(0,t.jsx)(i.hg,{className:"underline",children:(0,t.jsx)("button",{className:"px-4 p-1 text-white bg-sidebar-primary rounded-full",children:"View"})}),(0,t.jsx)(i.cZ,{className:"p-6 max-w-4xl max-h-[80vh] overflow-y-auto",children:(0,t.jsx)(h,{data:a})})]})}}],h=e=>{var a,s,r,l,n,i,u;let{data:h}=e,g=(0,d.I0)();return(0,o.useRouter)(),(0,t.jsxs)("div",{className:"flex flex-col space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold border-b pb-2",children:"Payment Details"}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Basic Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Receipt Number"}),(0,t.jsx)("p",{className:"font-mono",children:h.receiptNumber||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Amount"}),(0,t.jsxs)("p",{className:"font-semibold text-lg",children:[h.currency||"AUD"," ",(0,p.x)(h.amount)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,t.jsx)("p",{className:"capitalize font-medium",children:h.status})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Mode"}),(0,t.jsx)("p",{className:"capitalize",children:h.paymentMode||"online"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Date"}),(0,t.jsx)("p",{children:(0,x.Sp)(h.paymentDate||h.createdAt)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Source"}),(0,t.jsx)("p",{className:"capitalize",children:h.source||"website"})]})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Payer Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Name"}),(0,t.jsx)("p",{children:h.name||((null===(a=h.payer)||void 0===a?void 0:a.name)?"".concat(h.payer.name.given_name||""," ").concat(h.payer.name.surname||"").trim():"N/A")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,t.jsx)("p",{children:h.email||(null===(s=h.payer)||void 0===s?void 0:s.email_address)||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Phone"}),(0,t.jsx)("p",{children:h.phNo||(null===(n=h.payer)||void 0===n?void 0:null===(l=n.phone)||void 0===l?void 0:null===(r=l.phone_number)||void 0===r?void 0:r.national_number)||"N/A"})]}),(null===(i=h.payer)||void 0===i?void 0:i.address)&&(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Address"}),(0,t.jsx)("p",{children:[h.payer.address.address_line_1,h.payer.address.admin_area_2,h.payer.address.admin_area_1,h.payer.address.postal_code,h.payer.address.country_code].filter(Boolean).join(", ")||h.address||"N/A"})]})]})]}),"online"===h.paymentMode&&(0,t.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"PayPal Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.paypal_order_id&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Order ID"}),(0,t.jsx)("p",{className:"text-xs font-mono break-all",children:h.paypal_order_id})]}),h.paypal_payment_id&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Payment ID"}),(0,t.jsx)("p",{className:"text-xs font-mono break-all",children:h.paypal_payment_id})]}),h.paypal_capture_id&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Capture ID"}),(0,t.jsx)("p",{className:"text-xs font-mono break-all",children:h.paypal_capture_id})]}),h.paypal_status&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Status"}),(0,t.jsx)("p",{className:"uppercase",children:h.paypal_status})]}),h.paypal_fee&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Fee"}),(0,t.jsxs)("p",{children:[h.paypal_fee.currency," ",h.paypal_fee.amount||0]})]}),h.net_amount&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Net Amount"}),(0,t.jsxs)("p",{className:"font-medium",children:[h.currency," ",(0,p.x)(h.net_amount)]})]})]})]}),"offline"===h.paymentMode&&(0,t.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Manual Payment Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.manualMethod&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Method"}),(0,t.jsx)("p",{className:"capitalize",children:h.manualMethod})]}),h.transactionReference&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Transaction Reference"}),(0,t.jsx)("p",{children:h.transactionReference})]}),h.remarks&&(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Remarks"}),(0,t.jsx)("p",{children:h.remarks})]}),h.recordedBy&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Recorded By"}),(0,t.jsx)("p",{children:h.recordedBy.name||h.recordedBy.email||"N/A"})]})]})]}),h.contribution&&(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Contribution Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Purpose"}),(0,t.jsx)("p",{className:"capitalize",children:(null===(u=h.contribution.purpose)||void 0===u?void 0:u.replace("_"," "))||"General Donation"})]}),h.contribution.description&&(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Description"}),(0,t.jsx)("p",{children:h.contribution.description})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Approval Status"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Approved"}),(0,t.jsx)("p",{className:h.isApproved?"text-green-600 font-medium":"text-red-600 font-medium",children:h.isApproved?"Yes":"No"})]}),h.approvedBy&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Approved By"}),(0,t.jsx)("p",{children:h.approvedBy.name||h.approvedBy.email||"N/A"})]}),h.approvedAt&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Approved At"}),(0,t.jsx)("p",{children:(0,x.Sp)(h.approvedAt)})]})]})]}),h.error_details&&(h.error_details.error_code||h.error_details.error_message)&&(0,t.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3 text-red-800",children:"Error Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[h.error_details.error_code&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Error Code"}),(0,t.jsx)("p",{className:"font-mono text-red-600",children:h.error_details.error_code})]}),h.error_details.error_message&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Error Message"}),(0,t.jsx)("p",{className:"text-red-600",children:h.error_details.error_message})]}),h.error_details.debug_id&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Debug ID"}),(0,t.jsx)("p",{className:"font-mono text-xs",children:h.error_details.debug_id})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Additional Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.createdAt&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Created At"}),(0,t.jsx)("p",{children:(0,x.Sp)(h.createdAt)})]}),h.updatedAt&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Updated At"}),(0,t.jsx)("p",{children:(0,x.Sp)(h.updatedAt)})]}),h.ip_address&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"IP Address"}),(0,t.jsx)("p",{className:"font-mono text-xs",children:h.ip_address})]}),h.user_agent&&(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"User Agent"}),(0,t.jsx)("p",{className:"text-xs break-all",children:h.user_agent})]})]})]})]}),(0,t.jsx)("div",{className:"flex gap-2 pt-4 border-t",children:(0,t.jsx)(c.z,{className:"text-sm",onClick:()=>{g((0,m.R5)("generous-payments")),g((0,m.h9)(h._id))},children:"Edit Payment"})})]})};function g(){var e;let a;let[s,i]=(0,l.useState)([]),[c,o]=(0,l.useState)(0),[m,x]=(0,l.useState)(0),[p,h]=(0,l.useState)(10),[g,y]=(0,l.useState)(""),[j,N]=(0,l.useState)("all"),[f,v]=(0,l.useState)("all"),[b,_]=(0,l.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),2).toISOString().split("T")[0]}),[A,D]=(0,l.useState)(()=>new Date().toISOString().split("T")[0]),[w,S]=(0,l.useState)(""),P=(0,d.v9)(e=>e.update.refresh),I=(0,d.v9)(e=>e.payment.id),k=(0,l.useCallback)((e=e=>{S(e),x(0)},function(){for(var s=arguments.length,t=Array(s),r=0;r<s;r++)t[r]=arguments[r];clearTimeout(a),a=setTimeout(()=>{e(...t)},500)}),[]);async function C(){try{if(I){let e=await n.YD.get("/generous-payments/".concat(I,"&sort=-paymentDate")),a=[];return a[0]=e.data.data,o(1),a}let e="";"all"!==j&&(e="status__eq=".concat(j,"&"));let a="";"all"!==f&&(a="paymentMode__eq=".concat(f,"&"));let s="limit=".concat(p,"&"),t="skip=".concat(m*p,"&"),r={filters:{startDate:b?new Date(b).toISOString():void 0,endDate:A?new Date(A).toISOString():void 0}},l=await n.YD.post("/generous-payments?".concat(s).concat(t).concat(e).concat(a).concat(w?"search=".concat(w,"&"):"","sort=-paymentDate"),r,{headers:{"Content-Type":"application/json"}});console.log(l);let d=l.data.data;return o(d.total||d.length),d.items||d}catch(e){return console.error("Error fetching payment data:",e),[]}}return(0,l.useEffect)(()=>{(async function(){let e=await C();e&&i(e)})()},[m,p,w,j,f,b,A,P,I]),(0,t.jsx)("div",{className:"flex flex-col items-center p-4",children:(0,t.jsxs)("div",{className:"container mx-auto py-10",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 mb-4",children:[(0,t.jsx)("div",{className:"flex flex-col sm:flex-row justify-between gap-4"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-1",children:"Search"}),(0,t.jsx)("input",{type:"text",value:g,onChange:e=>{let a=e.target.value;y(a),k(a)},placeholder:"Search by name, phone number...",className:"p-2 border rounded flex-grow max-w-md"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-1",children:"Start Date"}),(0,t.jsx)("input",{type:"date",value:b,onChange:e=>{_(e.target.value),x(0)},className:"p-2 border border-gray-300 rounded"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-1",children:"End Date"}),(0,t.jsx)("input",{type:"date",value:A,onChange:e=>{D(e.target.value),x(0)},className:"p-2 border border-gray-300 rounded"})]})]})]}),(0,t.jsx)(r.w,{url:"generous-payments",columns:u,data:s,totalRows:c,pageIndex:m,pageSize:p,onPageChange:x,onPageSizeChange:h,actions:{delete:!1,edit:!1}})]})})}},4291:function(e,a,s){s.d(a,{$N:function(){return u},Be:function(){return h},Vq:function(){return i},cZ:function(){return x},fK:function(){return p},hg:function(){return c}});var t=s(7437),r=s(2265),l=s(9027),n=s(653),d=s(3448);let i=l.fC,c=l.xz,o=l.h_;l.x8;let m=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.aV,{ref:a,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});m.displayName=l.aV.displayName;let x=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,t.jsxs)(o,{children:[(0,t.jsx)(m,{}),(0,t.jsxs)(l.VY,{ref:a,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...i,children:[r,(0,t.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(n.Pxu,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=l.VY.displayName;let p=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...s})};p.displayName="DialogHeader";let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.Dx,{ref:a,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});u.displayName=l.Dx.displayName;let h=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.dk,{ref:a,className:(0,d.cn)("text-sm text-muted-foreground",s),...r})});h.displayName=l.dk.displayName},5420:function(e,a,s){s.d(a,{x:function(){return t}});let t=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"INR";if(arguments.length>2&&void 0!==arguments[2]&&arguments[2],null==e)return"N/A";let s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"Invalid Amount";try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(s)}catch(e){return console.error("Error formatting currency:",e),"".concat(a," ").concat(s.toFixed(2))}}},3455:function(e,a,s){s.d(a,{Sp:function(){return t}});let t=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{year:"numeric",month:"short",day:"numeric"};if(!e)return"N/A";try{let s="string"==typeof e?new Date(e):e;if(isNaN(s.getTime()))return"Invalid Date";return new Intl.DateTimeFormat("en-US",a).format(s)}catch(e){return console.error("Error formatting date:",e),"Invalid Date"}}}}]);