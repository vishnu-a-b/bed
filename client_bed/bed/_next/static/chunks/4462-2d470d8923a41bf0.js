(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4462],{4462:function(e,t,a){Promise.resolve().then(a.bind(a,2783))},2783:function(e,t,a){"use strict";a.d(t,{default:function(){return P}});var n=a(7437),o=a(2265),r=a(8438),s=a(3618),i=a(386),l=a(4291),d=a(2381),c=a(5799),u=a(9376),m=a(7520),p=a(4978);let x=[{accessorKey:"bedNo",header:"Bed Number"},{accessorKey:"country.name",header:"Country"},{accessorKey:"amount",header:"Amount",cell:e=>{let{row:t}=e;return"".concat(t.original.country.currency," ").concat(t.original.amount.toLocaleString())}},{accessorKey:"link",header:"Link",cell:e=>{let{row:t}=e,a=t.original.organization,o=t.original._id,r=t.original.bedNo||"N/A",s=t.original.fixedAmount||"No limit",i=t.original.country.currency,l=(null==a?void 0:a.vcLink)&&o?"".concat(a.vcLink.replace(/\/$/,""),"/bed?bed=").concat(o):"",c=async()=>{if(!l){p.Z.error("Link not available.");return}try{await navigator.clipboard.writeText(l),p.Z.success("Link copied to clipboard!")}catch(e){p.Z.error("Failed to copy link.")}},u=async()=>{if(!l){p.Z.error("Link not available.");return}let e={text:"Bed : ".concat(r,"\nMonthly Contribution Amount : ").concat(i," ").concat(s,"\n\nClick this link:"),url:l};if(navigator.share)try{await navigator.share(e)}catch(t){"AbortError"!==t.name&&m(e)}else m(e)},m=e=>{let t="".concat(e.title,"\n").concat(e.text,"\n").concat(e.url);if(window.confirm("Share bed details?\n\n".concat(e.title,"\n").concat(e.text,"\n\n")+"Click OK for WhatsApp or Cancel for other options"))window.open("https://wa.me/?text=".concat(encodeURIComponent(t)),"_blank");else switch(prompt("Choose sharing method:\n\n1. Copy to clipboard\n2. Email\n3. Telegram\nEnter option number:")){case"1":default:navigator.clipboard.writeText(t),p.Z.success("Copied to clipboard!");break;case"2":window.open("mailto:?subject=".concat(encodeURIComponent(e.title),"&body=").concat(encodeURIComponent(t)));break;case"3":window.open("https://t.me/share/url?url=".concat(encodeURIComponent(e.url),"&text=").concat(encodeURIComponent(e.text)))}};return(0,n.jsx)("div",{className:"flex flex-col gap-1 max-w-[180px]",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(d.z,{variant:"outline",size:"sm",onClick:c,children:"Copy"}),(0,n.jsx)(d.z,{variant:"outline",size:"sm",onClick:u,children:"Share"})]})})}},{accessorKey:"viewDetails",header:"Actions",cell:e=>{let t=e.row.original;return(0,n.jsxs)(l.Vq,{children:[(0,n.jsx)(l.hg,{className:"underline",children:(0,n.jsx)("button",{className:"px-4 p-1 text-white bg-sidebar-primary rounded-full",children:"View"})}),(0,n.jsx)(l.cZ,{className:"p-6",children:(0,n.jsx)(h,{data:t})})]})}}],h=e=>{var t,a,o;let{data:r}=e,s=(0,i.I0)(),l=(0,u.useRouter)();return(0,n.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("div",{className:"w-20 h-20 bg-gray-100 flex items-center justify-center rounded-sm",children:(0,n.jsx)("span",{className:"text-2xl",children:"\uD83D\uDECF️"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-lg font-bold",children:["Bed #",r.bedNo]}),(0,n.jsxs)("p",{children:["Status: ",r.patientName?"Occupied":"Available"]}),(0,n.jsxs)("p",{children:["Patient: ",r.patientName||"None"]}),(0,n.jsxs)("p",{children:["Organization: ",(null===(t=r.organization)||void 0===t?void 0:t.name)||"N/A"]}),(0,n.jsxs)("p",{children:["Country: ",(null===(a=r.country)||void 0===a?void 0:a.name)||"N/A"]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"Contributors"}),(0,n.jsxs)("p",{children:["Fixed Amount: ",r.fixedAmount]}),(0,n.jsxs)("p",{children:["Amount: $",r.amount.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"Management"}),(0,n.jsxs)("p",{children:["Head: ",(null===(o=r.head)||void 0===o?void 0:o.name)||"N/A"]}),r.vcLink&&(0,n.jsx)("a",{href:r.vcLink,target:"_blank",className:"text-blue-500 hover:underline",children:"Video Conference Link"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 flex-wrap pt-4",children:[(0,n.jsx)(d.z,{className:"text-sm",onClick:e=>{e.preventDefault(),s((0,c.kS)(r._id)),l.push("/beds/".concat(r._id))},children:"View Details"}),(0,n.jsx)(d.z,{className:"text-sm",onClick:e=>{s((0,m.R5)("bed")),s((0,m.h9)(r._id))},children:"Edit"}),r.vcLink&&(0,n.jsx)(d.z,{className:"text-sm",onClick:()=>window.open(r.vcLink,"_blank"),children:"Join Meeting"})]})]})};var f=a(7810),b=a(4395),g=a(7162);function v(){var e;let t;let[a,l]=(0,o.useState)([]),[d,c]=(0,o.useState)(0),[u,m]=(0,o.useState)(0),[p,h]=(0,o.useState)(10),[v,N]=(0,o.useState)(""),[j,y]=(0,o.useState)(""),[k,w]=(0,o.useState)(""),[C,z]=(0,o.useState)(),A=(0,i.v9)(g.oM),S=(0,i.v9)(e=>e.update.refresh),L=(0,i.v9)(e=>e.bed.id),_=(0,i.v9)(e=>e.organization.id),P=(0,o.useCallback)((e=e=>{w(e),m(0)},function(){for(var a=arguments.length,n=Array(a),o=0;o<a;o++)n[o]=arguments[o];clearTimeout(t),t=setTimeout(()=>{e(...n)},500)}),[]);async function O(){try{if(L){let e=await s.YD.get("/bed/".concat(L)),t=[];return t[0]=e.data.data,c(1),t}let e="";C&&C.value&&(e="organization__eq=".concat(C.value,"&"));let t=k?"search=".concat(k,"&"):"";console.log("/bed?limit=".concat(p,"&skip=").concat(u*p,"&").concat(e).concat("").concat(t));let a=(await s.YD.get("/bed?limit=".concat(p,"&skip=").concat(u*p,"&").concat(e).concat("").concat(t))).data.data;return c(a.total),a.items}catch(e){console.error("Error fetching bed data:",e)}}return(0,o.useEffect)(()=>{(async function(){l(await O())})()},[u,p,k,j,S,L,_,C]),(0,n.jsx)("div",{className:"flex flex-col items-center p-4",children:(0,n.jsxs)("div",{className:"container mx-auto py-10",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("input",{type:"text",value:v,onChange:e=>{let t=e.target.value;N(t),P(t)},placeholder:"Search beds by patient or number...",className:"mb-4 p-2 border rounded"}),(0,n.jsx)(f.Z,{cacheOptions:!0,loadOptions:b.Tz,defaultOptions:!0,value:C,onChange:e=>{e?z({value:e.id,label:e.label}):z(null)},classNamePrefix:"select",isClearable:!0})]}),(0,n.jsx)(r.w,{url:"bed",columns:x,data:a,totalRows:d,pageIndex:u,pageSize:p,onPageChange:m,onPageSizeChange:h,actions:{delete:"superAdmin"===A,edit:"superAdmin"===A}})]})})}var N=a(9501),j=a(3590),y=a(1229),k=a(279),w=a(5060),C=a(9093),z=a(662),A=a(2786),S=a(7480);let L=y.z.object({bedNo:y.z.number().min(1,"Bed number must be at least 1"),fixedAmount:y.z.string().optional(),amount:y.z.number().min(0),patientName:y.z.string().optional(),vcLink:y.z.string().url().optional().or(y.z.literal("")),qrPhoto:y.z.string().optional()});var _=e=>{let{bedId:t}=e,[a,r]=(0,o.useState)(!1),[s,l]=(0,o.useState)(),[c,u]=(0,o.useState)(),[x,h]=(0,o.useState)(),[g,v]=(0,o.useState)(!1),[y,_]=(0,o.useState)([]),P=(0,i.I0)(),{handleSubmit:O,register:D,setValue:F,formState:{errors:I},setError:Z}=(0,N.cI)({resolver:(0,j.F)(L),defaultValues:{amount:0}});(0,o.useEffect)(()=>{t&&(async()=>{r(!0);try{let e=(await (0,A.bp)(t,"bed")).items;if(F("bedNo",e.bedNo),F("fixedAmount",e.fixedAmount),F("amount",e.amount),F("patientName",e.patientName||""),F("vcLink",e.vcLink||""),F("qrPhoto",e.qrPhoto||""),e.organization&&u({value:e.organization._id,label:e.organization.name}),e.country&&(await (0,A.bp)(e.country,"country"),h({value:e.country._id,label:e.country.name})),e.head){let t=await (0,A.bp)(e.head,"user");l({value:e.head,label:t.items.name})}r(!1)}catch(e){console.error("Error fetching bed details:",e),r(!1)}})()},[t,F]);let B=()=>{F("patientName",""),F("vcLink",""),_([]),P((0,m.Oe)())},R=async e=>{v(!0);try{var a,n,o;let r;let i=new FormData;i.append("bedNo",String(e.bedNo)),e.fixedAmount&&i.append("fixedAmount",String(e.fixedAmount)),i.append("amount",String(e.amount)),i.append("patientName",null!==(n=e.patientName)&&void 0!==n?n:""),i.append("vcLink",null!==(o=e.vcLink)&&void 0!==o?o:""),c&&i.append("organization",c.value),x&&i.append("country",x.value),s&&i.append("head",s.value);let l=null===(a=y[0])||void 0===a?void 0:a.file;l&&i.append("qrPhoto",l),(r=t?await (0,C.V)(i,"bed",t,!0):await (0,z.U)("bed",i,!0))._id?(p.Z.success("Bed ".concat(t?"updated":"created"," successfully")),B()):(Z(r.id,{message:r.value}),p.Z.error("An error occurred while submitting the form"))}catch(e){console.error("Failed to submit form:",e),p.Z.error("An error occurred while submitting the form")}finally{v(!1)}};return a?(0,n.jsx)("div",{className:"flex items-center justify-center w-full h-[70vh]",children:(0,n.jsx)("div",{className:"loader"})}):(0,n.jsxs)("form",{onSubmit:O(R),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"organization",className:"required",children:"Organization"}),(0,n.jsx)(f.Z,{cacheOptions:!0,loadOptions:b.Tz,defaultOptions:!0,value:c,onChange:e=>{e?u({value:e.id,label:e.label}):u(null)},classNamePrefix:"select",isClearable:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"country",className:"required",children:"Country"}),(0,n.jsx)(f.Z,{cacheOptions:!0,loadOptions:b.Pb,defaultOptions:!0,value:x,onChange:e=>{e?h({value:e.id,label:e.label}):h(null)},classNamePrefix:"select",isClearable:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"bedNo",className:"required",children:"Bed Number"}),(0,n.jsx)(k.I,{id:"bedNo",type:"number",...D("bedNo",{valueAsNumber:!0}),className:"w-full border rounded p-2 ".concat(I.bedNo?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),I.bedNo&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:I.bedNo.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"amount",className:"required",children:"Monthly Cost"}),(0,n.jsx)(k.I,{id:"amount",type:"number",...D("amount",{valueAsNumber:!0}),className:"w-full border rounded p-2 ".concat(I.amount?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),I.amount&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:I.amount.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"fixedAmount",children:"Fixed Donation Amount"}),(0,n.jsx)(k.I,{id:"fixedAmount",type:"text",...D("fixedAmount"),className:"w-full border rounded p-2 ".concat(I.fixedAmount?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),I.fixedAmount&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:I.fixedAmount.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"patientName",children:"Patient Name"}),(0,n.jsx)(k.I,{id:"patientName",...D("patientName"),className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"vcLink",children:"Video Conference Link"}),(0,n.jsx)(k.I,{id:"vcLink",...D("vcLink"),className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),I.vcLink&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:I.vcLink.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"head",children:"Bed Head/Manager"}),(0,n.jsx)(f.Z,{cacheOptions:!0,loadOptions:b.p_,defaultOptions:!0,value:s,onChange:e=>{l(e)},classNamePrefix:"select",isClearable:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(w._,{htmlFor:"flag",children:"Qr Photo"}),(0,n.jsx)(S.J,{value:y,dropzoneOptions:{maxFiles:1,maxSize:5242880,accept:{"image/*":[".png",".jpg",".jpeg",".svg"]}},onChange:_,onFilesAdded:async e=>{_([...y,...e])}}),I.qrPhoto&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:I.qrPhoto.message})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)(d.z,{onClick:B,className:"bg-slate-400 hover:bg-slate-500",children:t?"Cancel":"Clear"}),(0,n.jsx)(d.z,{className:g?"cursor-not-allowed opacity-50":"",type:"submit",children:t?"Update":"Create"})]})]})};function P(){let[e,t]=(0,o.useState)(!0),a=(0,i.I0)(),r=(0,i.v9)(e=>e.update.url),s=(0,i.v9)(e=>e.update.id);return(0,n.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Beds Management"}),"bed"===r?"":(0,n.jsx)(d.z,{onClick:()=>{a((0,c.Dp)()),a((0,m.Oe)()),t(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Bed":"View Beds"})]}),"bed"===r?s&&(0,n.jsx)(_,{bedId:s}):e?(0,n.jsx)(v,{}):(0,n.jsx)(_,{})]})}},4291:function(e,t,a){"use strict";a.d(t,{$N:function(){return x},Be:function(){return h},Vq:function(){return l},cZ:function(){return m},fK:function(){return p},hg:function(){return d}});var n=a(7437),o=a(2265),r=a(9027),s=a(653),i=a(3448);let l=r.fC,d=r.xz,c=r.h_;r.x8;let u=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,n.jsx)(r.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...o})});u.displayName=r.aV.displayName;let m=o.forwardRef((e,t)=>{let{className:a,children:o,...l}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{}),(0,n.jsxs)(r.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[o,(0,n.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(s.Pxu,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=r.VY.displayName;let p=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};p.displayName="DialogHeader";let x=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,n.jsx)(r.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...o})});x.displayName=r.Dx.displayName;let h=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,n.jsx)(r.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...o})});h.displayName=r.dk.displayName},7162:function(e,t,a){"use strict";a.d(t,{Jt:function(){return l},gD:function(){return o},oM:function(){return i},tR:function(){return r}});let n=(0,a(1455).oM)({name:"auth",initialState:{role:"",isAuth:!1,accessToken:""},reducers:{setRole:(e,t)=>{e.role=t.payload},setIsAuth:(e,t)=>{e.isAuth=t.payload},setAccessToken:(e,t)=>{e.accessToken=t.payload}}}),{setRole:o,setIsAuth:r,setAccessToken:s}=n.actions,i=e=>e.auth.role,l=e=>e.auth.isAuth;t.ZP=n.reducer},5799:function(e,t,a){"use strict";a.d(t,{Dp:function(){return l},kS:function(){return s}});var n=a(1455);let o={id:null,organization:null,country:null,bedNo:null,maxNoContributer:15,amount:null,patientName:null,head:null,vcLink:null},r=(0,n.oM)({name:"bed",initialState:o,reducers:{setBedId:(e,t)=>{e.id=t.payload},setBedData:(e,t)=>({...e,...t.payload}),clearBedData:()=>o,setOrganization:(e,t)=>{e.organization=t.payload},setCountry:(e,t)=>{e.country=t.payload},setBedNo:(e,t)=>{e.bedNo=t.payload},setMaxContributers:(e,t)=>{e.maxNoContributer=t.payload},setamount:(e,t)=>{e.amount=t.payload},setPatientName:(e,t)=>{e.patientName=t.payload},setHead:(e,t)=>{e.head=t.payload},setVcLink:(e,t)=>{e.vcLink=t.payload}}}),{setBedId:s,setBedData:i,clearBedData:l,setOrganization:d,setCountry:c,setBedNo:u,setMaxContributers:m,setamount:p,setPatientName:x,setHead:h,setVcLink:f}=r.actions;t.ZP=r.reducer}}]);