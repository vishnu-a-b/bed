(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3722],{8133:function(e,a,s){Promise.resolve().then(s.bind(s,2433))},2433:function(e,a,s){"use strict";s.d(a,{default:function(){return W}});var l=s(7437),t=s(2265),r=s(8438),n=s(3618),i=s(386),d=s(4291),o=s(2381),c=s(5060),m=s(5937),p=s(9376),u=s(7520),x=s(3455),h=s(5420),g=s(1671),b=s(1723),y=s(9388),v=s(6865),j=s(3193),f=s(4978);let N=async(e,a,s)=>{let l=(0,n.hP)();return(await fetch("".concat("https://api.donatebed.shanthibhavan.in/v1","/bed-payments/").concat(e,"/approve"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify({approved:a,remarks:s})})).json()},_=[{accessorKey:"supporter.name",header:"Name"},{accessorKey:"supporter.user.mobileNo",header:"Phone No"},{accessorKey:"paymentDate",header:"Date",cell:e=>{var a,s;let{row:l}=e;return new Date((null==l?void 0:null===(a=l.original)||void 0===a?void 0:a.paymentDate)||(null==l?void 0:null===(s=l.original)||void 0===s?void 0:s.createdAt)).toLocaleDateString()}},{accessorKey:"amount",header:"Amount",cell:e=>{let{row:a}=e,s=a.original.currency||"AUD";return"".concat(s," ").concat(a.getValue("amount"))}},{accessorKey:"supporter.bed.bedNo",header:"Bed"},{accessorKey:"status",header:"Status",cell:e=>{let{row:a}=e,s=a.getValue("status"),t=a.original;return"offline"===t.paymentMode?!0===t.isApproved?(0,l.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 flex items-center gap-1",children:[(0,l.jsx)(g.Z,{className:"w-3 h-3"}),"Approved"]}):(0,l.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800 flex items-center gap-1",children:[(0,l.jsx)(b.Z,{className:"w-3 h-3"}),"Pending Approval"]}):(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("completed"===s?"bg-green-100 text-green-800":"failed"===s?"bg-red-100 text-red-800":"pending"===s?"bg-yellow-100 text-yellow-800":"cancelled"===s?"bg-gray-100 text-gray-800":"refunded"===s||"partially_refunded"===s?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:s.charAt(0).toUpperCase()+s.slice(1).replace("_"," ")})}},{accessorKey:"paymentMode",header:"Mode",cell:e=>{let{row:a}=e,s=a.getValue("paymentMode");return(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("online"===s?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:(null==s?void 0:s.charAt(0).toUpperCase())+(null==s?void 0:s.slice(1))||"Online"})}},{accessorKey:"viewDetails",header:"Actions",cell:e=>{let a=e.row.original;return(0,l.jsxs)(d.Vq,{children:[(0,l.jsx)(d.hg,{className:"underline",children:(0,l.jsx)("button",{className:"px-4 p-1 text-white bg-sidebar-primary rounded-full",children:"View"})}),(0,l.jsx)(d.cZ,{className:"p-6 max-w-4xl max-h-[80vh] overflow-y-auto",children:(0,l.jsx)(A,{data:a})})]})}}],w=e=>{let{payment:a,onApprovalUpdate:s}=e,[r,n]=(0,t.useState)(!1),[i,d]=(0,t.useState)(""),[p,u]=(0,t.useState)(!1),h=async e=>{if(!1===e&&!i.trim()){u(!0);return}n(!0);try{let l=await N(a._id,e,i);console.log(l),l.success?(s(a._id,e),f.Z.success("Payment ".concat(e?"approved":"rejected"," successfully").concat(e?". Receipt email sent to donor.":"")),u(!1),d("")):f.Z.error("Error processing approval")}catch(e){console.error("Error:",e),f.Z.error("Error processing approval")}finally{n(!1)}};return"offline"!==a.paymentMode?null:!0===a.isApproved?(0,l.jsxs)(m.bZ,{children:[(0,l.jsx)(g.Z,{className:"h-4 w-4"}),(0,l.jsxs)(m.X,{children:["Payment approved and receipt sent to donor.",a.approvedAt&&(0,l.jsxs)("span",{className:"block text-xs text-gray-500 mt-1",children:["Approved on ",(0,x.Sp)(a.approvedAt)]})]})]}):!1===a.isApproved?(0,l.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,l.jsxs)(m.bZ,{children:[(0,l.jsx)(y.Z,{className:"h-4 w-4"}),(0,l.jsx)(m.X,{children:"Payment has been rejected."})]}),p&&(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"approval-remarks",className:"text-sm font-medium",children:"Remarks"}),(0,l.jsx)("textarea",{id:"approval-remarks",value:i,onChange:e=>d(e.target.value),placeholder:"Enter approval remarks...",className:"w-full mt-1 min-h-[80px] px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",rows:3})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[!p&&(0,l.jsx)(o.z,{onClick:()=>u(!0),variant:"outline",size:"sm",children:"Add Remarks"}),(0,l.jsx)(o.z,{onClick:()=>h(!0),disabled:r,className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:r?"Processing...":"Approve & Send Receipt"})]})]}):(0,l.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,l.jsxs)(m.bZ,{children:[(0,l.jsx)(v.Z,{className:"h-4 w-4"}),(0,l.jsx)(m.X,{children:"This manual payment is pending approval. Once approved, a receipt will be automatically sent to the donor."})]}),p&&(0,l.jsxs)("div",{children:[(0,l.jsxs)(c._,{htmlFor:"approval-remarks",className:"text-sm font-medium",children:["Remarks ",!p&&"(Required for rejection)"]}),(0,l.jsx)("textarea",{id:"approval-remarks",value:i,onChange:e=>d(e.target.value),placeholder:"Enter approval/rejection remarks...",className:"w-full mt-1 min-h-[80px] px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",rows:3})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[!p&&(0,l.jsx)(o.z,{onClick:()=>u(!0),variant:"outline",size:"sm",children:"Add Remarks"}),(0,l.jsx)(o.z,{onClick:()=>h(!0),disabled:r,className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:r?"Processing...":"Approve & Send Receipt"}),(0,l.jsx)(o.z,{onClick:()=>h(!1),disabled:r,className:"bg-red-600 hover:bg-red-700 text-white",size:"sm",children:r?"Processing...":"Reject"})]})]})},A=e=>{var a,s,r,n,d,c,m;let{data:g}=e,b=(0,i.I0)();(0,p.useRouter)();let y=(0,i.v9)(j.uy),[v,f]=(0,t.useState)(g);return(0,l.jsxs)("div",{className:"flex flex-col space-y-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-xl font-semibold border-b pb-2",children:"Payment Details"}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Basic Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Receipt Number"}),(0,l.jsx)("p",{className:"font-mono",children:v.receiptNumber||"N/A"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Amount"}),(0,l.jsxs)("p",{className:"font-semibold text-lg",children:[v.currency||"AUD"," ",(0,h.x)(v.amount)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,l.jsx)("p",{className:"capitalize font-medium",children:v.status})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Mode"}),(0,l.jsx)("p",{className:"capitalize",children:v.paymentMode||"online"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Date"}),(0,l.jsx)("p",{children:(0,x.Sp)(v.paymentDate||v.createdAt)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Source"}),(0,l.jsx)("p",{className:"capitalize",children:v.source||"website"})]})]})]}),(0,l.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Payer Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Name"}),(0,l.jsx)("p",{children:v.name||((null===(a=v.payer)||void 0===a?void 0:a.name)?"".concat(v.payer.name.given_name||""," ").concat(v.payer.name.surname||"").trim():"N/A")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,l.jsx)("p",{children:v.email||(null===(s=v.payer)||void 0===s?void 0:s.email_address)||"N/A"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Phone"}),(0,l.jsx)("p",{children:v.phNo||(null===(d=v.payer)||void 0===d?void 0:null===(n=d.phone)||void 0===n?void 0:null===(r=n.phone_number)||void 0===r?void 0:r.national_number)||"N/A"})]}),(null===(c=v.payer)||void 0===c?void 0:c.address)&&(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Address"}),(0,l.jsx)("p",{children:[v.payer.address.address_line_1,v.payer.address.admin_area_2,v.payer.address.admin_area_1,v.payer.address.postal_code,v.payer.address.country_code].filter(Boolean).join(", ")||v.address||"N/A"})]})]})]}),"online"===v.paymentMode&&(0,l.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"PayPal Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.paypal_order_id&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Order ID"}),(0,l.jsx)("p",{className:"text-xs font-mono break-all",children:v.paypal_order_id})]}),v.paypal_payment_id&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Payment ID"}),(0,l.jsx)("p",{className:"text-xs font-mono break-all",children:v.paypal_payment_id})]}),v.paypal_capture_id&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Capture ID"}),(0,l.jsx)("p",{className:"text-xs font-mono break-all",children:v.paypal_capture_id})]}),v.paypal_status&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Status"}),(0,l.jsx)("p",{className:"uppercase",children:v.paypal_status})]}),v.paypal_fee&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"PayPal Fee"}),(0,l.jsxs)("p",{children:[v.paypal_fee.currency," ",v.paypal_fee.amount||0]})]}),v.net_amount&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Net Amount"}),(0,l.jsxs)("p",{className:"font-medium",children:[v.currency," ",(0,h.x)(v.net_amount)]})]})]})]}),"offline"===v.paymentMode&&(0,l.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Manual Payment Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.manualMethod&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Payment Method"}),(0,l.jsx)("p",{className:"capitalize",children:v.manualMethod})]}),v.transactionReference&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Transaction Reference"}),(0,l.jsx)("p",{children:v.transactionReference})]}),v.remarks&&(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Remarks"}),(0,l.jsx)("p",{children:v.remarks})]}),v.recordedBy&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Recorded By"}),(0,l.jsx)("p",{children:v.recordedBy.name||v.recordedBy.email||"N/A"})]})]})]}),v.contribution&&(0,l.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Contribution Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Purpose"}),(0,l.jsx)("p",{className:"capitalize",children:(null===(m=v.contribution.purpose)||void 0===m?void 0:m.replace("_"," "))||"General Donation"})]}),v.contribution.description&&(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Description"}),(0,l.jsx)("p",{children:v.contribution.description})]})]})]}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Approval Status"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Approved"}),(0,l.jsx)("p",{className:v.isApproved?"text-green-600 font-medium":"text-red-600 font-medium",children:!0===v.isApproved?"Yes":!1===v.isApproved?"No":"Pending"})]}),v.approvedBy&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Approved By"}),(0,l.jsx)("p",{children:v.approvedBy.name||v.approvedBy.email||"N/A"})]}),v.approvedAt&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Approved At"}),(0,l.jsx)("p",{children:(0,x.Sp)(v.approvedAt)})]})]})]}),(0,l.jsx)(w,{payment:v,onApprovalUpdate:(e,a)=>{f(e=>({...e,isApproved:a,approvedBy:{id:y.id},approvedAt:new Date().toISOString(),status:a?"completed":"cancelled"}))}}),v.error_details&&(v.error_details.error_code||v.error_details.error_message)&&(0,l.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3 text-red-800",children:"Error Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[v.error_details.error_code&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Error Code"}),(0,l.jsx)("p",{className:"font-mono text-red-600",children:v.error_details.error_code})]}),v.error_details.error_message&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Error Message"}),(0,l.jsx)("p",{className:"text-red-600",children:v.error_details.error_message})]}),v.error_details.debug_id&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Debug ID"}),(0,l.jsx)("p",{className:"font-mono text-xs",children:v.error_details.debug_id})]})]})]}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Additional Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.createdAt&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Created At"}),(0,l.jsx)("p",{children:(0,x.Sp)(v.createdAt)})]}),v.updatedAt&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Updated At"}),(0,l.jsx)("p",{children:(0,x.Sp)(v.updatedAt)})]}),v.ip_address&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"IP Address"}),(0,l.jsx)("p",{className:"font-mono text-xs",children:v.ip_address})]}),v.user_agent&&(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"User Agent"}),(0,l.jsx)("p",{className:"text-xs break-all",children:v.user_agent})]})]})]})]}),(0,l.jsx)("div",{className:"flex gap-2 pt-4 border-t",children:(0,l.jsx)(o.z,{className:"text-sm",onClick:()=>{b((0,u.R5)("bed-payments")),b((0,u.h9)(v._id))},children:"Edit Payment"})})]})};var D=s(5805),P=s(525),S=s(1047),C=s(3327),k=s(5252),M=e=>{let{onStatsLoad:a}=e,[s,r]=(0,t.useState)(null),[i,d]=(0,t.useState)(!0),[o,c]=(0,t.useState)(null),m=async()=>{try{d(!0);let e=await n.YD.get("/bed-payments/stats"),s=e.data.data;console.log(e),r(s),null==a||a(s)}catch(e){c("Failed to load payment statistics"),console.error("Error fetching payment stats:",e)}finally{d(!1)}};(0,t.useEffect)(()=>{m()},[]);let p=e=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),u=e=>{let{title:a,amount:s,count:t,icon:r,gradient:n,textColor:i="text-white",subtitle:d=""}=e;return(0,l.jsxs)("div",{className:"".concat(n," rounded-xl p-6 shadow-lg transform hover:scale-105 transition-all duration-300 relative overflow-hidden"),children:[(0,l.jsx)("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-20 h-20 rounded-full bg-white/10"}),(0,l.jsx)("div",{className:"absolute bottom-0 left-0 -mb-6 -ml-6 w-16 h-16 rounded-full bg-white/5"}),(0,l.jsxs)("div",{className:"relative z-10",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("div",{className:"p-3 rounded-lg bg-white/20 backdrop-blur-sm",children:(0,l.jsx)(r,{className:"w-6 h-6 ".concat(i)})}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-sm ".concat(i,"/80 font-medium"),children:a}),d&&(0,l.jsx)("p",{className:"text-xs ".concat(i,"/60"),children:d})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{className:"text-3xl font-bold ".concat(i),children:p(s)}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(D.Z,{className:"w-4 h-4 ".concat(i,"/70")}),(0,l.jsxs)("p",{className:"text-sm ".concat(i,"/80"),children:[t," payment",1!==t?"s":""]})]})]})]})]})};return i?(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(e=>(0,l.jsx)("div",{className:"bg-gray-200 animate-pulse rounded-xl h-40"},e))}):o?(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 mb-8",children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,l.jsx)(P.Z,{className:"w-5 h-5 text-red-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"Error Loading Statistics"}),(0,l.jsx)("p",{className:"text-red-600",children:o})]})]})}):s?(0,l.jsxs)("div",{className:"mb-8 space-y-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Statistics"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Overview of completed payments"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,l.jsx)(u,{title:"Today",amount:s.today.amount,count:s.today.count,icon:b.Z,gradient:"bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700",subtitle:new Date().toLocaleDateString("en-AU",{weekday:"long",month:"short",day:"numeric"})}),(0,l.jsx)(u,{title:"This Week",amount:s.week.amount,count:s.week.count,icon:S.Z,gradient:"bg-gradient-to-br from-green-500 via-green-600 to-green-700",subtitle:"Last 7 days"}),(0,l.jsx)(u,{title:"This Month",amount:s.month.amount,count:s.month.count,icon:P.Z,gradient:"bg-gradient-to-br from-purple-500 via-purple-600 to-purple-700",subtitle:new Date().toLocaleDateString("en-AU",{month:"long",year:"numeric"})}),(0,l.jsx)(u,{title:"All Time",amount:s.total.amount,count:s.total.count,icon:C.Z,gradient:"bg-gradient-to-br from-orange-500 via-orange-600 to-orange-700",subtitle:"Avg: ".concat(p(s.total.avgAmount))})]}),(0,l.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6 border border-gray-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,l.jsx)(k.Z,{className:"w-6 h-6 text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Summary"}),(0,l.jsxs)("p",{className:"text-gray-600",children:[s.total.count," total completed payments"]})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Average Payment Amount"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-green-600",children:p(s.total.avgAmount)})]})]})})]}):null},z=s(7162);function I(){var e;let a;let[s,d]=(0,t.useState)([]),[o,c]=(0,t.useState)(0),[m,p]=(0,t.useState)(0),[u,x]=(0,t.useState)(10),[h,g]=(0,t.useState)(""),[b,y]=(0,t.useState)("all"),[v,j]=(0,t.useState)("all"),[f,N]=(0,t.useState)(()=>{let e=new Date;return new Date(e.getFullYear(),e.getMonth(),2).toISOString().split("T")[0]}),w=(0,i.v9)(z.oM),[A,D]=(0,t.useState)(()=>{let e=new Date;return e.setHours(23,59,59,999),e.toISOString().split("T")[0]}),[P,S]=(0,t.useState)(""),C=(0,i.v9)(e=>e.update.refresh),k=(0,i.v9)(e=>e.payment.id),I=(0,t.useCallback)((e=e=>{S(e),p(0)},function(){for(var s=arguments.length,l=Array(s),t=0;t<s;t++)l[t]=arguments[t];clearTimeout(a),a=setTimeout(()=>{e(...l)},500)}),[]);async function E(){try{if(k){let e=await n.YD.get("/bed-payments/".concat(k,"&sort=-paymentDate")),a=[];return a[0]=e.data.data,c(1),a}let e="";"all"!==b&&(e="status__eq=".concat(b,"&"));let a="";"all"!==v&&(a="paymentMode__eq=".concat(v,"&"));let s=P?"search=".concat(P,"&"):"",l="limit=".concat(u,"&"),t="skip=".concat(m*u,"&"),r={filters:{startDate:f?new Date(f).toISOString():void 0,endDate:A?(()=>{let e=new Date(A);return e.setHours(23,59,59,999),e.toISOString()})():void 0}};console.log("/bed-payments?".concat(l).concat(t).concat(e).concat(a).concat(s,"sort=-paymentDate"));let i=await n.YD.post("/bed-payments?".concat(l).concat(t).concat(e).concat(a).concat(s,"sort=-paymentDate"),r,{headers:{"Content-Type":"application/json"}});console.log("hai",i);let d=i.data.data;return c(d.total||d.length),d.items||d}catch(e){return console.error("Error fetching payment data:",e),[]}}return(0,t.useEffect)(()=>{(async function(){let e=await E();e&&d(e)})()},[m,u,P,b,v,f,A,C,k]),(0,l.jsxs)("div",{className:"flex flex-col items-center p-4",children:[(0,l.jsx)(M,{}),(0,l.jsxs)("div",{className:"container mx-auto py-10",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,l.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:(0,l.jsxs)("div",{className:"flex flex-col flex-grow",children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-1",children:"Search"}),(0,l.jsx)("input",{type:"text",value:h,onChange:e=>{let a=e.target.value;g(a),I(a)},placeholder:"Search by supporter name, mobile, bed number, email...",className:"p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"}),(0,l.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Search in: Supporter name, mobile number, bed number, email, receipt number"})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-1",children:"Start Date"}),(0,l.jsx)("input",{type:"date",value:f,onChange:e=>{N(e.target.value),p(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-1",children:"End Date"}),(0,l.jsx)("input",{type:"date",value:A,onChange:e=>{D(e.target.value),p(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-1",children:"Status"}),(0,l.jsxs)("select",{value:b,onChange:e=>{y(e.target.value),p(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",children:[(0,l.jsx)("option",{value:"all",children:"All Statuses"}),(0,l.jsx)("option",{value:"completed",children:"✅ Completed"}),(0,l.jsx)("option",{value:"pending",children:"⏳ Pending"}),(0,l.jsx)("option",{value:"failed",children:"❌ Failed"}),(0,l.jsx)("option",{value:"cancelled",children:"\uD83D\uDEAB Cancelled"}),(0,l.jsx)("option",{value:"refunded",children:"\uD83D\uDCB0 Refunded"}),(0,l.jsx)("option",{value:"partially_refunded",children:"\uD83D\uDCB8 Partially Refunded"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("label",{className:"text-sm font-medium mb-1",children:"Payment Mode"}),(0,l.jsxs)("select",{value:v,onChange:e=>{j(e.target.value),p(0)},className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",children:[(0,l.jsx)("option",{value:"all",children:"All Payment Modes"}),(0,l.jsx)("option",{value:"online",children:"\uD83D\uDCBB Online"}),(0,l.jsx)("option",{value:"offline",children:"\uD83C\uDFEA Offline"})]})]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)("button",{onClick:()=>{y("completed"),p(0)},className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("completed"===b?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Completed"}),(0,l.jsx)("button",{onClick:()=>{y("pending"),p(0)},className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("pending"===b?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Pending"}),(0,l.jsx)("button",{onClick:()=>{y("failed"),p(0)},className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("failed"===b?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Failed"}),(0,l.jsx)("button",{onClick:()=>{y("all"),j("all"),g(""),S(""),N(""),D(""),p(0)},className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:"Clear All Filters"})]})]}),(0,l.jsx)(r.w,{url:"bed-payments",columns:_,data:s,totalRows:o,pageIndex:m,pageSize:u,onPageChange:p,onPageSizeChange:x,actions:{delete:"superAdmin"===w,edit:"superAdmin"===w}})]})]})}var E=s(5974),F=s(9501),U=s(3590),R=s(1229),Z=s(279),O=s(6979),B=s(662),T=s(7810),q=s(4395);let G=async(e,a)=>({items:{}}),K=async(e,a,s)=>({_id:"updated"}),V=R.z.object({paypal_order_id:R.z.string().optional(),paypal_payment_id:R.z.string().optional(),paypal_payer_id:R.z.string().optional(),paypal_capture_id:R.z.string().optional(),name:R.z.string().optional(),phNo:R.z.string().optional(),email:R.z.string().email().optional().or(R.z.literal("")),address:R.z.string().optional(),amount:R.z.number().min(1,{message:"Amount must be positive"}),currency:R.z.enum(["AUD","USD"]).default("AUD"),status:R.z.enum(["pending","completed","failed","cancelled","refunded","partially_refunded"]),contribution:R.z.object({purpose:R.z.enum(["general_donation","medical_assistance","education_support","emergency_fund","other"]).default("general_donation"),description:R.z.string().default("General donation")}),paymentMode:R.z.enum(["online","offline"]).default("online"),manualMethod:R.z.enum(["cash","cheque","bank_transfer","other"]).optional(),transactionReference:R.z.string().optional(),paymentDate:R.z.string().optional(),remarks:R.z.string().optional(),source:R.z.enum(["website","mobile_app","social_media","email_campaign","other"]).default("website"),isApproved:R.z.boolean().default(!0),supporter:R.z.string().optional(),bed:R.z.string().optional()});var Y=e=>{let{paymentId:a}=e,[s,r]=(0,t.useState)({value:"offline",label:"Offline"}),[n,i]=(0,t.useState)(),[d,p]=(0,t.useState)({value:"pending",label:"Pending"}),[u,x]=(0,t.useState)({value:"AUD",label:"AUD"}),[h,g]=(0,t.useState)({value:"general_donation",label:"General Donation"}),[b,y]=(0,t.useState)({value:"website",label:"Website"}),[v,j]=(0,t.useState)({value:!1,label:"No"}),{handleSubmit:N,register:_,setValue:w,formState:{errors:A},setError:D,watch:P}=(0,F.cI)({resolver:(0,U.F)(V),defaultValues:{contribution:{purpose:"general_donation",description:"General donation"},source:"website",currency:"AUD",status:"pending",paymentMode:"offline",isApproved:!1}}),[S,C]=(0,t.useState)(!1),[k,M]=(0,t.useState)();(0,t.useEffect)(()=>{a&&(async()=>{try{var e,s,l,t,n,d,o,c;let m=(await G(a,"bed-payments")).items;w("paypal_order_id",m.paypal_order_id||""),w("paypal_payment_id",m.paypal_payment_id||""),w("paypal_payer_id",m.paypal_payer_id||""),w("paypal_capture_id",m.paypal_capture_id||""),w("name",m.name||(null===(s=m.payer)||void 0===s?void 0:null===(e=s.name)||void 0===e?void 0:e.given_name)||""),w("phNo",m.phNo||""),w("email",m.email||(null===(l=m.payer)||void 0===l?void 0:l.email_address)||""),w("address",m.address||""),w("amount",m.amount),w("currency",m.currency||"AUD"),w("status",m.status||"pending"),w("paymentMode",m.paymentMode||"offline"),w("manualMethod",m.manualMethod||void 0),w("transactionReference",m.transactionReference||""),w("paymentDate",(null===(t=m.paymentDate)||void 0===t?void 0:t.split("T")[0])||""),w("remarks",m.remarks||""),w("isApproved",!1!==m.isApproved),w("contribution.purpose",(null===(n=m.contribution)||void 0===n?void 0:n.purpose)||"general_donation"),w("contribution.description",(null===(d=m.contribution)||void 0===d?void 0:d.description)||"General donation"),w("source",m.source||"website"),w("supporter",m.supporter||""),w("bed",m.bed||""),p({value:m.status||"pending",label:m.status?m.status.charAt(0).toUpperCase()+m.status.slice(1):"Pending"}),r({value:m.paymentMode||"offline",label:"online"===m.paymentMode?"Online":"Offline"}),x({value:m.currency||"AUD",label:m.currency||"AUD"}),g({value:(null===(o=m.contribution)||void 0===o?void 0:o.purpose)||"general_donation",label:(null===(c=m.contribution)||void 0===c?void 0:c.purpose)?m.contribution.purpose.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"General Donation"}),y({value:m.source||"website",label:m.source?m.source.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Website"}),j({value:!1!==m.isApproved,label:!1!==m.isApproved?"Yes":"No"}),m.manualMethod&&i({value:m.manualMethod,label:m.manualMethod.charAt(0).toUpperCase()+m.manualMethod.slice(1)})}catch(e){console.error("Error fetching payment details:",e)}})()},[a,w]);let z=async e=>{C(!0);try{let s={...e,amount:Number(e.amount),...e.paymentDate&&{paymentDate:new Date(e.paymentDate).toISOString()}};if(a)(await K(s,"bed-payments",a))._id?f.Z.success("Payment updated successfully"):f.Z.error("Error updating payment");else{let a="offline"===e.paymentMode?"bed-payments/manual":"bed-payments",l=await (0,B.U)(a,s);console.log(l),l.payment._id?(f.Z.success("Manual payment created successfully".concat("offline"===e.paymentMode?" (Pending approval)":"")),I()):f.Z.error("Error creating payment")}}catch(e){console.error("Error submitting form:",e),f.Z.error("Error submitting form")}finally{C(!1)}},I=()=>{w("amount",0),w("status","pending"),w("paymentMode","offline"),w("isApproved",!1),w("contribution.purpose","general_donation"),w("contribution.description","General donation"),w("source","website"),w("currency","AUD"),w("name",""),w("email",""),w("phNo",""),w("address",""),w("transactionReference",""),w("paymentDate",""),w("remarks",""),w("supporter",""),w("bed",""),r({value:"offline",label:"Offline"}),p({value:"pending",label:"Pending"}),x({value:"AUD",label:"AUD"}),g({value:"general_donation",label:"General Donation"}),y({value:"website",label:"Website"}),j({value:!1,label:"No"}),i(void 0)};return(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:["offline"===P("paymentMode")&&(0,l.jsx)(m.bZ,{className:"mb-6",children:(0,l.jsx)(m.X,{children:"Manual/offline payments require approval before receipts are sent to donors."})}),(0,l.jsxs)("form",{onSubmit:N(z),className:"bg-white dark:bg-gray-900 shadow-lg rounded-lg p-6 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"col-span-1 lg:col-span-2 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"amount",className:"required text-sm font-medium",children:"Amount *"}),(0,l.jsx)(Z.I,{id:"amount",type:"number",step:"0.01",..._("amount",{valueAsNumber:!0}),placeholder:"Enter amount",className:"w-full ".concat(A.amount?"border-red-500":"")}),A.amount&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:A.amount.message})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"currency",className:"text-sm font-medium",children:"Currency"}),(0,l.jsx)(O.ZP,{id:"currency",options:[{value:"AUD",label:"AUD"},{value:"USD",label:"USD"}],value:u,onChange:e=>{x(e),w("currency",e.value)},classNamePrefix:"select"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"paymentMode",className:"required text-sm font-medium",children:"Payment Mode *"}),(0,l.jsx)(O.ZP,{id:"paymentMode",options:[{value:"online",label:"Online"},{value:"offline",label:"Offline"}],value:s,onChange:e=>{r(e),w("paymentMode",e.value),"online"===e.value&&(i(void 0),w("manualMethod",void 0))},classNamePrefix:"select"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"status",className:"required text-sm font-medium",children:"Status *"}),(0,l.jsx)(O.ZP,{id:"status",options:[{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"},{value:"refunded",label:"Refunded"},{value:"partially_refunded",label:"Partially Refunded"}],value:d,onChange:e=>{p(e),w("status",e.value)},classNamePrefix:"select"})]}),"offline"===P("paymentMode")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"manualMethod",className:"text-sm font-medium",children:"Manual Method"}),(0,l.jsx)(O.ZP,{id:"manualMethod",options:[{value:"cash",label:"Cash"},{value:"cheque",label:"Cheque"},{value:"bank_transfer",label:"Bank Transfer"},{value:"other",label:"Other"}],value:n,onChange:e=>{i(e),w("manualMethod",e.value)},classNamePrefix:"select",placeholder:"Select method..."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"transactionReference",className:"text-sm font-medium",children:"Transaction Reference"}),(0,l.jsx)(Z.I,{id:"transactionReference",..._("transactionReference"),placeholder:"Cheque no, UTR, etc.",className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"paymentDate",className:"text-sm font-medium",children:"Payment Date"}),(0,l.jsx)(Z.I,{type:"date",id:"paymentDate",..._("paymentDate"),className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"isApproved",className:"text-sm font-medium",children:"Approved Status"}),(0,l.jsx)(O.ZP,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],value:v,onChange:e=>{j(e),w("isApproved",e.value)},classNamePrefix:"select"})]})]}),"online"===P("paymentMode")&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"paypal_payment_id",className:"text-sm font-medium",children:"PayPal Payment ID"}),(0,l.jsx)(Z.I,{id:"paypal_payment_id",..._("paypal_payment_id"),placeholder:"Enter PayPal payment ID",className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"paypal_order_id",className:"text-sm font-medium",children:"PayPal Order ID"}),(0,l.jsx)(Z.I,{id:"paypal_order_id",..._("paypal_order_id"),placeholder:"Enter PayPal order ID",className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"paypal_payer_id",className:"text-sm font-medium",children:"PayPal Payer ID"}),(0,l.jsx)(Z.I,{id:"paypal_payer_id",..._("paypal_payer_id"),placeholder:"Enter PayPal payer ID",className:"w-full"})]})]}),(0,l.jsx)("div",{className:"col-span-1 lg:col-span-2",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"head",className:" required",children:"Supporter"}),(0,l.jsx)(T.Z,{cacheOptions:!0,loadOptions:q.zc,defaultOptions:!0,value:k,onChange:e=>{console.log(e),w("supporter",e.value||""),w("bed",e.bed||""),M(e)},classNamePrefix:"select",isClearable:!0,required:!0})]}),(0,l.jsxs)("div",{className:" ",children:[(0,l.jsx)(c._,{htmlFor:"bed",className:"text-sm font-medium",children:"Bed No"}),(0,l.jsx)(Z.I,{id:"bed",..._("bed"),placeholder:"Enter bed ID if applicable",className:"w-full hidden"}),(0,l.jsx)(Z.I,{value:null==k?void 0:k.bedNo,placeholder:"Enter bed ID if applicable",className:"w-full "})]})]})}),(0,l.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Payer Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"name",className:"text-sm font-medium",children:"Payer Name"}),(0,l.jsx)(Z.I,{id:"name",..._("name"),placeholder:"Enter payer name",className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),(0,l.jsx)(Z.I,{id:"email",type:"email",..._("email"),placeholder:"Enter payer email",className:"w-full ".concat(A.email?"border-red-500":"")}),A.email&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:A.email.message})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"phNo",className:"text-sm font-medium",children:"Phone Number"}),(0,l.jsx)(Z.I,{id:"phNo",..._("phNo"),placeholder:"Enter payer phone number",className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"address",className:"text-sm font-medium",children:"Address"}),(0,l.jsx)(Z.I,{id:"address",..._("address"),placeholder:"Enter payer address",className:"w-full"})]})]})]}),(0,l.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Contribution Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"purpose",className:"text-sm font-medium",children:"Contribution Purpose"}),(0,l.jsx)(O.ZP,{id:"purpose",options:[{value:"general_donation",label:"General Donation"},{value:"medical_assistance",label:"Medical Assistance"},{value:"education_support",label:"Education Support"},{value:"emergency_fund",label:"Emergency Fund"},{value:"other",label:"Other"}],value:h,onChange:e=>{g(e),w("contribution.purpose",e.value),w("contribution.description","general_donation"===e.value?"General donation":"".concat(e.label," contribution"))},classNamePrefix:"select"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(c._,{htmlFor:"source",className:"text-sm font-medium",children:"Source"}),(0,l.jsx)(O.ZP,{id:"source",options:[{value:"website",label:"Website"},{value:"mobile_app",label:"Mobile App"},{value:"social_media",label:"Social Media"},{value:"email_campaign",label:"Email Campaign"},{value:"other",label:"Other"}],value:b,onChange:e=>{y(e),w("source",e.value)},classNamePrefix:"select"})]})]})]}),(0,l.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,l.jsx)(c._,{htmlFor:"remarks",className:"text-sm font-medium",children:"Remarks"}),(0,l.jsx)("textarea",{id:"remarks",..._("remarks"),placeholder:"Enter any additional remarks or notes",className:"w-full min-h-[80px] px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-800 dark:text-white",rows:3})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center col-span-1 lg:col-span-2 pt-4 border-t",children:[(0,l.jsx)(o.z,{type:"button",onClick:I,className:"bg-gray-500 hover:bg-gray-600 text-white",disabled:S,children:a?"Cancel":"Clear"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[!a&&"offline"===P("paymentMode")&&(0,l.jsx)("span",{className:"text-sm text-amber-600 dark:text-amber-400 flex items-center",children:"⚠️ Will require manual approval"}),(0,l.jsx)(o.z,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white ".concat(S?"cursor-not-allowed opacity-50":""),disabled:S,children:S?"Processing...":a?"Update Payment":"Create Payment"})]})]})]})]})};function W(){let[e,a]=(0,t.useState)(!0),s=(0,i.I0)(),r=(0,i.v9)(e=>e.update.url),n=(0,i.v9)(e=>e.update.id);return(0,l.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Payments"}),"payment"===r?"":(0,l.jsx)(o.z,{onClick:()=>{s((0,E.Ib)()),s((0,u.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Payment":"View Payments"})]}),"payment"===r?n&&(0,l.jsx)("div",{}):e?(0,l.jsx)(I,{}):(0,l.jsx)(Y,{})]})}},5420:function(e,a,s){"use strict";s.d(a,{x:function(){return l}});let l=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"INR";if(arguments.length>2&&void 0!==arguments[2]&&arguments[2],null==e)return"N/A";let s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"Invalid Amount";try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(s)}catch(e){return console.error("Error formatting currency:",e),"".concat(a," ").concat(s.toFixed(2))}}}}]);