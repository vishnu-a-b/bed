(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1105],{2675:function(e,a,t){Promise.resolve().then(t.bind(t,1550))},6979:function(e,a,t){"use strict";t.d(a,{ZP:function(){return s}});var n=t(1434),r=t(1119),l=t(2265),o=t(9448);t(8242),t(4887),t(7935);var s=(0,l.forwardRef)(function(e,a){var t=(0,n.u)(e);return l.createElement(o.S,(0,r.Z)({ref:a},t))})},1550:function(e,a,t){"use strict";t.d(a,{default:function(){return j}});var n=t(7437),r=t(2265),l=t(6093),o=t(386),s=t(2381),i=t(5974),c=t(7520),d=t(9501),u=t(3590),p=t(1229),m=t(279),h=t(5060),f=t(4978),y=t(2786),v=t(6979),b=t(9093),g=t(662);let x=p.z.object({razorpay_order_id:p.z.string().optional(),razorpay_payment_id:p.z.string().optional(),razorpay_signature:p.z.string().optional(),name:p.z.string().optional(),phNo:p.z.string().optional(),email:p.z.string().email().optional().or(p.z.literal("")),address:p.z.string().optional(),amount:p.z.number().min(1,{message:"Amount must be positive"}),currency:p.z.enum(["INR"]).default("INR"),status:p.z.enum(["pending","completed","failed","cancelled","refunded","partially_refunded"]),contribution:p.z.object({purpose:p.z.enum(["general_donation","medical_assistance","education_support","emergency_fund","other"]).default("general_donation"),description:p.z.string().default("General donation")}),paymentMode:p.z.enum(["online","offline"]).default("online"),manualMethod:p.z.enum(["cash","cheque","upi","bank_transfer","other"]).optional(),transactionReference:p.z.string().optional(),paymentDate:p.z.string().optional(),remarks:p.z.string().optional(),source:p.z.enum(["website","mobile_app","social_media","email_campaign","other"]).default("website"),isApproved:p.z.boolean().default(!0)});var _=e=>{var a;let{paymentId:t}=e,l=(0,o.I0)(),[i,p]=(0,r.useState)({value:"online",label:"Online"}),[_,j]=(0,r.useState)(),[N,I]=(0,r.useState)({value:"completed",label:"Completed"}),[w,z]=(0,r.useState)({value:"INR",label:"INR"}),[A,C]=(0,r.useState)({value:"general_donation",label:"General Donation"}),[D,M]=(0,r.useState)({value:"website",label:"Website"}),[R,P]=(0,r.useState)({value:!0,label:"Yes"}),{handleSubmit:E,register:F,setValue:S,formState:{errors:k},setError:O,watch:Z}=(0,d.cI)({resolver:(0,u.F)(x),defaultValues:{contribution:{purpose:"general_donation",description:"General donation"},source:"website",currency:"INR",status:"completed",paymentMode:"online",isApproved:!0}}),[Y,q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&(async()=>{try{var e,a,n,r,l,o;let s=(await (0,y.bp)(t,"generous-payments-ind")).items;S("razorpay_order_id",s.razorpay_order_id||""),S("razorpay_payment_id",s.razorpay_payment_id||""),S("razorpay_signature",s.razorpay_signature||""),S("name",s.name||""),S("phNo",s.phNo||""),S("email",s.email||(null===(e=s.payer)||void 0===e?void 0:e.email_address)||""),S("address",s.address||""),S("amount",s.amount),S("currency",s.currency||"INR"),S("status",s.status||"completed"),S("paymentMode",s.paymentMode||"online"),S("manualMethod",s.manualMethod||void 0),S("transactionReference",s.transactionReference||""),S("paymentDate",(null===(a=s.paymentDate)||void 0===a?void 0:a.split("T")[0])||""),S("remarks",s.remarks||""),S("isApproved",!1!==s.isApproved),S("contribution.purpose",(null===(n=s.contribution)||void 0===n?void 0:n.purpose)||"general_donation"),S("contribution.description",(null===(r=s.contribution)||void 0===r?void 0:r.description)||"General donation"),S("source",s.source||"website"),I({value:s.status||"completed",label:s.status?s.status.charAt(0).toUpperCase()+s.status.slice(1):"Completed"}),p({value:s.paymentMode||"online",label:"offline"===s.paymentMode?"Offline":"Online"}),z({value:s.currency||"INR",label:s.currency||"INR"}),C({value:(null===(l=s.contribution)||void 0===l?void 0:l.purpose)||"general_donation",label:(null===(o=s.contribution)||void 0===o?void 0:o.purpose)?s.contribution.purpose.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"General Donation"}),M({value:s.source||"website",label:s.source?s.source.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Website"}),P({value:!1!==s.isApproved,label:!1!==s.isApproved?"Yes":"No"}),s.manualMethod&&j({value:s.manualMethod,label:s.manualMethod.charAt(0).toUpperCase()+s.manualMethod.slice(1)})}catch(e){console.error("Error fetching payment details:",e)}})()},[t,S]);let G=async e=>{q(!0);try{let a={...e,amount:Number(e.amount),...e.paymentDate&&{paymentDate:new Date(e.paymentDate).toISOString()}};if(t){let e=await (0,b.V)(a,"generous-payments-ind",t);e._id?f.Z.success("Contribution updated successfully"):(O(e.id,{message:e.value}),f.Z.error("Error updating contribution"))}else{let e=await (0,g.U)("generous-payments-ind/manual",a);e._id?(f.Z.success("Contribution created successfully"),L()):(O(e.id,{message:e.value}),f.Z.error("Error creating contribution"))}}catch(e){console.error("Error submitting form:",e),f.Z.error("Error submitting form")}finally{q(!1)}},L=()=>{S("amount",0),S("status","completed"),S("paymentMode","online"),S("isApproved",!0),S("contribution.purpose","general_donation"),S("contribution.description","General donation"),S("source","website"),S("currency","INR"),p({value:"online",label:"Online"}),I({value:"completed",label:"Completed"}),z({value:"INR",label:"INR"}),C({value:"general_donation",label:"General Donation"}),M({value:"website",label:"Website"}),P({value:!0,label:"Yes"}),j(void 0),l((0,c.Oe)())};return(0,n.jsxs)("form",{onSubmit:E(G),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(h._,{htmlFor:"amount",className:"required",children:"Amount"}),(0,n.jsx)(m.I,{id:"amount",type:"number",...F("amount",{valueAsNumber:!0}),placeholder:"Enter amount",className:"w-full ".concat(k.amount?"border-red-500":"")}),k.amount&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.amount.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"currency",children:"Currency"}),(0,n.jsx)(v.ZP,{id:"currency",options:[{value:"INR",label:"INR"}],value:w,onChange:e=>{z(e),S("currency",e.value)},classNamePrefix:"select"}),k.currency&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.currency.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"status",className:"required",children:"Status"}),(0,n.jsx)(v.ZP,{id:"status",options:[{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"},{value:"refunded",label:"Refunded"},{value:"partially_refunded",label:"Partially Refunded"}],value:N,onChange:e=>{I(e),S("status",e.value)},classNamePrefix:"select"}),k.status&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.status.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"paymentMode",className:"required",children:"Payment Mode"}),(0,n.jsx)(v.ZP,{id:"paymentMode",options:[{value:"online",label:"Online"},{value:"offline",label:"Offline"}],value:i,onChange:e=>{p(e),S("paymentMode",e.value),"online"===e.value&&(j(void 0),S("manualMethod",void 0))},classNamePrefix:"select"}),k.paymentMode&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.paymentMode.message})]}),"offline"===Z("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"manualMethod",children:"Manual Method"}),(0,n.jsx)(v.ZP,{id:"manualMethod",options:[{value:"cash",label:"Cash"},{value:"cheque",label:"Cheque"},{value:"upi",label:"UPI"},{value:"bank_transfer",label:"Bank Transfer"},{value:"other",label:"Other"}],value:_,onChange:e=>{j(e),S("manualMethod",e.value)},classNamePrefix:"select"}),k.manualMethod&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.manualMethod.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"transactionReference",children:"Transaction Reference"}),(0,n.jsx)(m.I,{id:"transactionReference",...F("transactionReference"),placeholder:"Cheque no, UTR, etc.",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"paymentDate",children:"Payment Date"}),(0,n.jsx)(m.I,{type:"date",id:"paymentDate",...F("paymentDate"),className:"w-full"})]}),(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(h._,{htmlFor:"remarks",children:"Remarks"}),(0,n.jsx)(m.I,{id:"remarks",...F("remarks"),placeholder:"Enter remarks",className:"w-full"})]})]}),"online"===Z("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"razorpay_payment_id",children:"Razorpay Payment ID"}),(0,n.jsx)(m.I,{id:"razorpay_payment_id",...F("razorpay_payment_id"),placeholder:"Enter Razorpay payment ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"razorpay_order_id",children:"Razorpay Order ID"}),(0,n.jsx)(m.I,{id:"razorpay_order_id",...F("razorpay_order_id"),placeholder:"Enter Razorpay order ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"razorpay_signature",children:"Razorpay Signature"}),(0,n.jsx)(m.I,{id:"razorpay_signature",...F("razorpay_signature"),placeholder:"Enter Razorpay signature",className:"w-full"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"name",children:"Payer Name"}),(0,n.jsx)(m.I,{id:"name",...F("name"),placeholder:"Enter payer name",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(m.I,{id:"email",...F("email"),placeholder:"Enter payer email",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"phNo",children:"Phone Number"}),(0,n.jsx)(m.I,{id:"phNo",...F("phNo"),placeholder:"Enter payer phone number",className:"w-full"})]}),(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(h._,{htmlFor:"address",children:"Address"}),(0,n.jsx)(m.I,{id:"address",...F("address"),placeholder:"Enter payer address",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"purpose",children:"Contribution Purpose"}),(0,n.jsx)(v.ZP,{id:"purpose",options:[{value:"general_donation",label:"General Donation"},{value:"medical_assistance",label:"Medical Assistance"},{value:"education_support",label:"Education Support"},{value:"emergency_fund",label:"Emergency Fund"},{value:"other",label:"Other"}],value:A,onChange:e=>{C(e),S("contribution.purpose",e.value),S("contribution.description","general_donation"===e.value?"General donation":"".concat(e.label," contribution"))},classNamePrefix:"select"}),(null===(a=k.contribution)||void 0===a?void 0:a.purpose)&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.contribution.purpose.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"source",children:"Source"}),(0,n.jsx)(v.ZP,{id:"source",options:[{value:"website",label:"Website"},{value:"mobile_app",label:"Mobile App"},{value:"social_media",label:"Social Media"},{value:"email_campaign",label:"Email Campaign"},{value:"other",label:"Other"}],value:D,onChange:e=>{M(e),S("source",e.value)},classNamePrefix:"select"}),k.source&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.source.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{children:"Approved"}),(0,n.jsx)(v.ZP,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],value:R,onChange:e=>{P(e),S("isApproved",e.value)},classNamePrefix:"select"})]}),(0,n.jsxs)("div",{className:"flex justify-between col-span-1 lg:col-span-2",children:[(0,n.jsx)(s.z,{onClick:L,className:"bg-slate-400 hover:bg-slate-500",children:t?"Cancel":"Clear"}),(0,n.jsx)(s.z,{className:Y?"cursor-not-allowed opacity-50":"",type:"submit",children:t?"Update":"Create"})]})]})};function j(){let[e,a]=(0,r.useState)(!0),t=(0,o.I0)(),d=(0,o.v9)(e=>e.update.url),u=(0,o.v9)(e=>e.update.id);return(0,n.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Payments"}),"payment"===d?"":(0,n.jsx)(s.z,{onClick:()=>{t((0,i.Ib)()),t((0,c.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Payment":"View Payments"})]}),"payment"===d?u&&(0,n.jsx)(_,{paymentId:u}):e?(0,n.jsx)(l.default,{}):(0,n.jsx)(_,{})]})}},279:function(e,a,t){"use strict";t.d(a,{I:function(){return o}});var n=t(7437),r=t(2265),l=t(3448);let o=r.forwardRef((e,a)=>{let{className:t,type:r,...o}=e;return(0,n.jsx)("input",{type:r,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input  px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...o})});o.displayName="Input"},5060:function(e,a,t){"use strict";t.d(a,{_:function(){return c}});var n=t(7437),r=t(2265),l=t(6394),o=t(535),s=t(3448);let i=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(l.f,{ref:a,className:(0,s.cn)(i(),t),...r})});c.displayName=l.f.displayName},5974:function(e,a,t){"use strict";t.d(a,{Ib:function(){return l}});let n=(0,t(1455).oM)({name:"payment",initialState:{id:null,paymentId:null},reducers:{setPaymentId:(e,a)=>{e.paymentId=a.payload},clearPaymentId:e=>{e.paymentId=null}}}),{setPaymentId:r,clearPaymentId:l}=n.actions;a.ZP=n.reducer},662:function(e,a,t){"use strict";t.d(a,{U:function(){return r}});var n=t(3618);let r=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let r=await n.YD.post("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(e,"/"),a,{headers:{"Content-Type":t?"multipart/form-data":"application/json"}});return console.log(r),r.data.data}catch(a){console.error("Error creating data:",a);let e=a.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},2786:function(e,a,t){"use strict";t.d(a,{Ak:function(){return s},GZ:function(){return i},WX:function(){return d},bp:function(){return o},dQ:function(){return u},fp:function(){return m},rQ:function(){return l},tE:function(){return c},uh:function(){return p}});var n=t(3618);let r="https://api.donatebed.shanthibhavan.in/v1",l=async e=>{try{return{items:(await n.YD.get("/".concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},o=async(e,a)=>{try{return{items:(await n.YD.get("/".concat(a,"/").concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},s=async e=>(await n.YD.get("".concat(r,"/organization?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,i=async e=>{let a=Number(e);return console.log("searchTerm",e,a,typeof a,typeof e),(await n.YD.get("".concat(r,"/bed?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(a):""))).data.data},c=async e=>(await n.YD.get("".concat(r,"/country?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,d=async e=>(await n.YD.get("".concat(r,"/supporter/supporter?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,u=async(e,a)=>(await n.YD.get("".concat(r,"/staff?").concat(a?"organization__eq=".concat(a,"&"):"","limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,p=async e=>{let a=await n.YD.get("".concat(r,"/user?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""));return console.log(a),a.data.data},m=async()=>(await n.YD.get("".concat(r,"/role"))).data.data},9093:function(e,a,t){"use strict";t.d(a,{V:function(){return r}});var n=t(3618);let r=async function(e,a,t){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{return console.log(typeof e),(await n.YD.put("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(a,"/").concat(t),e,{headers:{"Content-Type":r?"multipart/form-data":"application/json"}})).data.data}catch(a){console.log(a),console.log(a.response.data);let e=a.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},4978:function(e,a,t){"use strict";var n=t(7261);a.Z={success:e=>{n.Am.success(e,{autoClose:2e3})},error:e=>{n.Am.error(e,{autoClose:2e3})},info:e=>{n.Am.info(e,{autoClose:2e3})},warning:e=>{n.Am.warning(e,{autoClose:2e3})}}}},function(e){e.O(0,[8310,3464,8037,1229,7261,237,3402,8575,9027,1455,1145,4285,8438,6093,2971,2117,1744],function(){return e(e.s=2675)}),_N_E=e.O()}]);