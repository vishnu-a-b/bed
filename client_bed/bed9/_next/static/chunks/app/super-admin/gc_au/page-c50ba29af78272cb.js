(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1962],{8102:function(e,a,t){Promise.resolve().then(t.bind(t,224))},6979:function(e,a,t){"use strict";t.d(a,{ZP:function(){return s}});var n=t(1434),r=t(1119),o=t(2265),l=t(9448);t(8242),t(4887),t(7935);var s=(0,o.forwardRef)(function(e,a){var t=(0,n.u)(e);return o.createElement(l.S,(0,r.Z)({ref:a},t))})},224:function(e,a,t){"use strict";var n=t(7437),r=t(2265),o=t(9501),l=t(3590),s=t(1229),i=t(279),c=t(2381),d=t(5060),u=t(4978),p=t(2786),m=t(6979),h=t(9093),f=t(662),v=t(386),y=t(7520);let b=s.z.object({paypal_order_id:s.z.string().optional(),paypal_payment_id:s.z.string().optional(),paypal_payer_id:s.z.string().optional(),paypal_capture_id:s.z.string().optional(),name:s.z.string().optional(),phNo:s.z.string().optional(),email:s.z.string().email().optional().or(s.z.literal("")),address:s.z.string().optional(),amount:s.z.number().min(1,{message:"Amount must be positive"}),currency:s.z.enum(["AUD","USD"]).default("AUD"),status:s.z.enum(["pending","completed","failed","cancelled","refunded","partially_refunded"]),contribution:s.z.object({purpose:s.z.enum(["general_donation","medical_assistance","education_support","emergency_fund","other"]).default("general_donation"),description:s.z.string().default("General donation")}),paymentMode:s.z.enum(["online","offline"]).default("online"),manualMethod:s.z.enum(["cash","cheque","bank_transfer","other"]).optional(),transactionReference:s.z.string().optional(),paymentDate:s.z.string().optional(),remarks:s.z.string().optional(),source:s.z.enum(["website","mobile_app","social_media","email_campaign","other"]).default("website"),isApproved:s.z.boolean().default(!0)});a.default=e=>{var a;let{paymentId:t}=e,s=(0,v.I0)(),[g,x]=(0,r.useState)({value:"online",label:"Online"}),[_,j]=(0,r.useState)(),[w,N]=(0,r.useState)({value:"completed",label:"Completed"}),[D,A]=(0,r.useState)({value:"AUD",label:"AUD"}),[I,P]=(0,r.useState)({value:"general_donation",label:"General Donation"}),[C,M]=(0,r.useState)({value:"website",label:"Website"}),[z,S]=(0,r.useState)({value:!0,label:"Yes"}),{handleSubmit:k,register:E,setValue:U,formState:{errors:F},setError:Z,watch:O}=(0,o.cI)({resolver:(0,l.F)(b),defaultValues:{contribution:{purpose:"general_donation",description:"General donation"},source:"website",currency:"AUD",status:"completed",paymentMode:"online",isApproved:!0}}),[R,Y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&(async()=>{try{var e,a,n,r,o,l;let s=(await (0,p.bp)(t,"generous-contribution")).items;U("paypal_order_id",s.paypal_order_id||""),U("paypal_payment_id",s.paypal_payment_id||""),U("paypal_payer_id",s.paypal_payer_id||""),U("paypal_capture_id",s.paypal_capture_id||""),U("name",s.name||""),U("phNo",s.phNo||""),U("email",s.email||(null===(e=s.payer)||void 0===e?void 0:e.email_address)||""),U("address",s.address||""),U("amount",s.amount),U("currency",s.currency||"AUD"),U("status",s.status||"completed"),U("paymentMode",s.paymentMode||"online"),U("manualMethod",s.manualMethod||void 0),U("transactionReference",s.transactionReference||""),U("paymentDate",(null===(a=s.paymentDate)||void 0===a?void 0:a.split("T")[0])||""),U("remarks",s.remarks||""),U("isApproved",!1!==s.isApproved),U("contribution.purpose",(null===(n=s.contribution)||void 0===n?void 0:n.purpose)||"general_donation"),U("contribution.description",(null===(r=s.contribution)||void 0===r?void 0:r.description)||"General donation"),U("source",s.source||"website"),N({value:s.status||"completed",label:s.status?s.status.charAt(0).toUpperCase()+s.status.slice(1):"Completed"}),x({value:s.paymentMode||"online",label:"offline"===s.paymentMode?"Offline":"Online"}),A({value:s.currency||"AUD",label:s.currency||"AUD"}),P({value:(null===(o=s.contribution)||void 0===o?void 0:o.purpose)||"general_donation",label:(null===(l=s.contribution)||void 0===l?void 0:l.purpose)?s.contribution.purpose.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"General Donation"}),M({value:s.source||"website",label:s.source?s.source.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Website"}),S({value:!1!==s.isApproved,label:!1!==s.isApproved?"Yes":"No"}),s.manualMethod&&j({value:s.manualMethod,label:s.manualMethod.charAt(0).toUpperCase()+s.manualMethod.slice(1)})}catch(e){console.error("Error fetching payment details:",e)}})()},[t,U]);let T=async e=>{Y(!0);try{let a={...e,amount:Number(e.amount),...e.paymentDate&&{paymentDate:new Date(e.paymentDate).toISOString()}};if(t){let e=await (0,h.V)(a,"generous-contribution",t);e._id?u.Z.success("Contribution updated successfully"):(Z(e.id,{message:e.value}),u.Z.error("Error updating contribution"))}else{let e=await (0,f.U)("generous-contribution",a);e._id?(u.Z.success("Contribution created successfully"),q()):(Z(e.id,{message:e.value}),u.Z.error("Error creating contribution"))}}catch(e){console.error("Error submitting form:",e),u.Z.error("Error submitting form")}finally{Y(!1)}},q=()=>{U("amount",0),U("status","completed"),U("paymentMode","online"),U("isApproved",!0),U("contribution.purpose","general_donation"),U("contribution.description","General donation"),U("source","website"),U("currency","AUD"),x({value:"online",label:"Online"}),N({value:"completed",label:"Completed"}),A({value:"AUD",label:"AUD"}),P({value:"general_donation",label:"General Donation"}),M({value:"website",label:"Website"}),S({value:!0,label:"Yes"}),j(void 0),s((0,y.Oe)())};return(0,n.jsxs)("form",{onSubmit:k(T),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(d._,{htmlFor:"amount",className:"required",children:"Amount"}),(0,n.jsx)(i.I,{id:"amount",type:"number",...E("amount",{valueAsNumber:!0}),placeholder:"Enter amount",className:"w-full ".concat(F.amount?"border-red-500":"")}),F.amount&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:F.amount.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"currency",children:"Currency"}),(0,n.jsx)(m.ZP,{id:"currency",options:[{value:"AUD",label:"AUD"},{value:"USD",label:"USD"}],value:D,onChange:e=>{A(e),U("currency",e.value)},classNamePrefix:"select"}),F.currency&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:F.currency.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"status",className:"required",children:"Status"}),(0,n.jsx)(m.ZP,{id:"status",options:[{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"},{value:"refunded",label:"Refunded"},{value:"partially_refunded",label:"Partially Refunded"}],value:w,onChange:e=>{N(e),U("status",e.value)},classNamePrefix:"select"}),F.status&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:F.status.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"paymentMode",className:"required",children:"Payment Mode"}),(0,n.jsx)(m.ZP,{id:"paymentMode",options:[{value:"online",label:"Online"},{value:"offline",label:"Offline"}],value:g,onChange:e=>{x(e),U("paymentMode",e.value),"online"===e.value&&(j(void 0),U("manualMethod",void 0))},classNamePrefix:"select"}),F.paymentMode&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:F.paymentMode.message})]}),"offline"===O("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"manualMethod",children:"Manual Method"}),(0,n.jsx)(m.ZP,{id:"manualMethod",options:[{value:"cash",label:"Cash"},{value:"cheque",label:"Cheque"},{value:"bank_transfer",label:"Bank Transfer"},{value:"other",label:"Other"}],value:_,onChange:e=>{j(e),U("manualMethod",e.value)},classNamePrefix:"select"}),F.manualMethod&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:F.manualMethod.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"transactionReference",children:"Transaction Reference"}),(0,n.jsx)(i.I,{id:"transactionReference",...E("transactionReference"),placeholder:"Cheque no, UTR, etc.",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"paymentDate",children:"Payment Date"}),(0,n.jsx)(i.I,{type:"date",id:"paymentDate",...E("paymentDate"),className:"w-full"})]}),(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(d._,{htmlFor:"remarks",children:"Remarks"}),(0,n.jsx)(i.I,{id:"remarks",...E("remarks"),placeholder:"Enter remarks",className:"w-full"})]})]}),"online"===O("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"paypal_payment_id",children:"PayPal Payment ID"}),(0,n.jsx)(i.I,{id:"paypal_payment_id",...E("paypal_payment_id"),placeholder:"Enter PayPal payment ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"paypal_order_id",children:"PayPal Order ID"}),(0,n.jsx)(i.I,{id:"paypal_order_id",...E("paypal_order_id"),placeholder:"Enter PayPal order ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"paypal_payer_id",children:"PayPal Payer ID"}),(0,n.jsx)(i.I,{id:"paypal_payer_id",...E("paypal_payer_id"),placeholder:"Enter PayPal payer ID",className:"w-full"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"name",children:"Payer Name"}),(0,n.jsx)(i.I,{id:"name",...E("name"),placeholder:"Enter payer name",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(i.I,{id:"email",...E("email"),placeholder:"Enter payer email",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"phNo",children:"Phone Number"}),(0,n.jsx)(i.I,{id:"phNo",...E("phNo"),placeholder:"Enter payer phone number",className:"w-full"})]}),(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(d._,{htmlFor:"address",children:"Address"}),(0,n.jsx)(i.I,{id:"address",...E("address"),placeholder:"Enter payer address",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"purpose",children:"Contribution Purpose"}),(0,n.jsx)(m.ZP,{id:"purpose",options:[{value:"general_donation",label:"General Donation"},{value:"medical_assistance",label:"Medical Assistance"},{value:"education_support",label:"Education Support"},{value:"emergency_fund",label:"Emergency Fund"},{value:"other",label:"Other"}],value:I,onChange:e=>{P(e),U("contribution.purpose",e.value),U("contribution.description","general_donation"===e.value?"General donation":"".concat(e.label," contribution"))},classNamePrefix:"select"}),(null===(a=F.contribution)||void 0===a?void 0:a.purpose)&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:F.contribution.purpose.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{htmlFor:"source",children:"Source"}),(0,n.jsx)(m.ZP,{id:"source",options:[{value:"website",label:"Website"},{value:"mobile_app",label:"Mobile App"},{value:"social_media",label:"Social Media"},{value:"email_campaign",label:"Email Campaign"},{value:"other",label:"Other"}],value:C,onChange:e=>{M(e),U("source",e.value)},classNamePrefix:"select"}),F.source&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:F.source.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(d._,{children:"Approved"}),(0,n.jsx)(m.ZP,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],value:z,onChange:e=>{S(e),U("isApproved",e.value)},classNamePrefix:"select"})]}),(0,n.jsxs)("div",{className:"flex justify-between col-span-1 lg:col-span-2",children:[(0,n.jsx)(c.z,{onClick:q,className:"bg-slate-400 hover:bg-slate-500",children:t?"Cancel":"Clear"}),(0,n.jsx)(c.z,{className:R?"cursor-not-allowed opacity-50":"",type:"submit",children:t?"Update":"Create"})]})]})}},2381:function(e,a,t){"use strict";t.d(a,{z:function(){return c}});var n=t(7437),r=t(2265),o=t(7053),l=t(535),s=t(3448);let i=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,a)=>{let{className:t,variant:r,size:l,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,n.jsx)(u,{className:(0,s.cn)(i({variant:r,size:l,className:t})),ref:a,...d})});c.displayName="Button"},279:function(e,a,t){"use strict";t.d(a,{I:function(){return l}});var n=t(7437),r=t(2265),o=t(3448);let l=r.forwardRef((e,a)=>{let{className:t,type:r,...l}=e;return(0,n.jsx)("input",{type:r,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input  px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...l})});l.displayName="Input"},5060:function(e,a,t){"use strict";t.d(a,{_:function(){return c}});var n=t(7437),r=t(2265),o=t(6394),l=t(535),s=t(3448);let i=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(o.f,{ref:a,className:(0,s.cn)(i(),t),...r})});c.displayName=o.f.displayName},7520:function(e,a,t){"use strict";t.d(a,{Oe:function(){return l},R5:function(){return o},h9:function(){return r},tV:function(){return s}});let n=(0,t(1455).oM)({name:"update",initialState:{id:null,url:null,refresh:!1},reducers:{setUpdateId:(e,a)=>{e.id=a.payload},setUpdateUrl:(e,a)=>{e.url=a.payload},clearUpdate:e=>{e.id=null,e.url=null},refreshTable:e=>{e.refresh=!e.refresh}}}),{setUpdateId:r,setUpdateUrl:o,clearUpdate:l,refreshTable:s}=n.actions;a.ZP=n.reducer},3448:function(e,a,t){"use strict";t.d(a,{cn:function(){return o}});var n=t(1994),r=t(3335);function o(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,r.m6)((0,n.W)(a))}},3618:function(e,a,t){"use strict";t.d(a,{YD:function(){return d},kS:function(){return c},pH:function(){return o}});var n=t(3464);let r="https://api.donatebed.shanthibhavan.in/v1",o=async(e,a)=>{let t=await n.Z.post("".concat(r,"/auth/jwt/create"),{username:e,password:a});return s(t.data.data.accessToken,t.data.data.refreshToken),t.data.data},l=async e=>(await n.Z.post("".concat(r,"/auth/jwt/verify"),{refreshToken:e})).data.data,s=(e,a)=>{sessionStorage.setItem("access_token",e),localStorage.setItem("refresh_token",a)},i=()=>sessionStorage.getItem("access_token"),c=()=>{sessionStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.reload()},d=n.Z.create({baseURL:r,headers:{"Content-Type":"multipart/form-data"}});d.interceptors.request.use(e=>{let a=i();return a&&(e.headers.Authorization="Bearer ".concat(a)),e}),d.interceptors.response.use(e=>e,async e=>{var a;let t=e.config;if((null===(a=e.response)||void 0===a?void 0:a.status)===401&&!t._retry){t._retry=!0;let e=localStorage.getItem("refresh_token");if(e)try{let{accessToken:a}=await l(e);return s(a,e),t.headers.Authorization="Bearer "+a,d(t)}catch(e){throw c(),window.location.reload(),e}else c(),window.location.reload()}throw e})},662:function(e,a,t){"use strict";t.d(a,{U:function(){return r}});var n=t(3618);let r=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let r=await n.YD.post("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(e,"/"),a,{headers:{"Content-Type":t?"multipart/form-data":"application/json"}});return console.log(r),r.data.data}catch(a){console.error("Error creating data:",a);let e=a.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},2786:function(e,a,t){"use strict";t.d(a,{Ak:function(){return s},GZ:function(){return i},WX:function(){return d},bp:function(){return l},dQ:function(){return u},fp:function(){return m},rQ:function(){return o},tE:function(){return c},uh:function(){return p}});var n=t(3618);let r="https://api.donatebed.shanthibhavan.in/v1",o=async e=>{try{return{items:(await n.YD.get("/".concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},l=async(e,a)=>{try{return{items:(await n.YD.get("/".concat(a,"/").concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},s=async e=>(await n.YD.get("".concat(r,"/organization?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,i=async e=>{let a=Number(e);return console.log("searchTerm",e,a,typeof a,typeof e),(await n.YD.get("".concat(r,"/bed?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(a):""))).data.data},c=async e=>(await n.YD.get("".concat(r,"/country?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,d=async e=>(await n.YD.get("".concat(r,"/supporter/supporter?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,u=async(e,a)=>(await n.YD.get("".concat(r,"/staff?").concat(a?"organization__eq=".concat(a,"&"):"","limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,p=async e=>{let a=await n.YD.get("".concat(r,"/user?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""));return console.log(a),a.data.data},m=async()=>(await n.YD.get("".concat(r,"/role"))).data.data},9093:function(e,a,t){"use strict";t.d(a,{V:function(){return r}});var n=t(3618);let r=async function(e,a,t){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{return console.log(typeof e),(await n.YD.put("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(a,"/").concat(t),e,{headers:{"Content-Type":r?"multipart/form-data":"application/json"}})).data.data}catch(a){console.log(a),console.log(a.response.data);let e=a.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},4978:function(e,a,t){"use strict";var n=t(7261);a.Z={success:e=>{n.Am.success(e,{autoClose:2e3})},error:e=>{n.Am.error(e,{autoClose:2e3})},info:e=>{n.Am.info(e,{autoClose:2e3})},warning:e=>{n.Am.warning(e,{autoClose:2e3})}}}},function(e){e.O(0,[3464,1229,9518,7261,1140,2519,4285,2971,2117,1744],function(){return e(e.s=8102)}),_N_E=e.O()}]);