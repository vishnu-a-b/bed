(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1962],{8664:function(e,a,t){Promise.resolve().then(t.bind(t,4809))},6979:function(e,a,t){"use strict";t.d(a,{ZP:function(){return o}});var n=t(1434),l=t(1119),r=t(2265),s=t(9448);t(8242),t(4887),t(7935);var o=(0,r.forwardRef)(function(e,a){var t=(0,n.u)(e);return r.createElement(s.S,(0,l.Z)({ref:a},t))})},4809:function(e,a,t){"use strict";t.d(a,{default:function(){return j}});var n=t(7437),l=t(2265),r=t(7217),s=t(386),o=t(2381),i=t(5974),c=t(7520),d=t(9501),u=t(3590),p=t(1229),m=t(279),h=t(5060),y=t(4978),f=t(2786),v=t(6979),b=t(9093),g=t(662);let x=p.z.object({paypal_order_id:p.z.string().optional(),paypal_payment_id:p.z.string().optional(),paypal_payer_id:p.z.string().optional(),paypal_capture_id:p.z.string().optional(),name:p.z.string().optional(),phNo:p.z.string().optional(),email:p.z.string().email().optional().or(p.z.literal("")),address:p.z.string().optional(),amount:p.z.number().min(1,{message:"Amount must be positive"}),currency:p.z.enum(["AUD","USD"]).default("AUD"),status:p.z.enum(["pending","completed","failed","cancelled","refunded","partially_refunded"]),contribution:p.z.object({purpose:p.z.enum(["general_donation","medical_assistance","education_support","emergency_fund","other"]).default("general_donation"),description:p.z.string().default("General donation")}),paymentMode:p.z.enum(["online","offline"]).default("online"),manualMethod:p.z.enum(["cash","cheque","bank_transfer","other"]).optional(),transactionReference:p.z.string().optional(),paymentDate:p.z.string().optional(),remarks:p.z.string().optional(),source:p.z.enum(["website","mobile_app","social_media","email_campaign","other"]).default("website"),isApproved:p.z.boolean().default(!0)});var _=e=>{var a;let{paymentId:t}=e,r=(0,s.I0)(),[i,p]=(0,l.useState)({value:"online",label:"Online"}),[_,j]=(0,l.useState)(),[N,w]=(0,l.useState)({value:"completed",label:"Completed"}),[D,A]=(0,l.useState)({value:"AUD",label:"AUD"}),[I,P]=(0,l.useState)({value:"general_donation",label:"General Donation"}),[C,M]=(0,l.useState)({value:"website",label:"Website"}),[E,z]=(0,l.useState)({value:!0,label:"Yes"}),{handleSubmit:S,register:F,setValue:U,formState:{errors:k},setError:O,watch:Z}=(0,d.cI)({resolver:(0,u.F)(x),defaultValues:{contribution:{purpose:"general_donation",description:"General donation"},source:"website",currency:"AUD",status:"completed",paymentMode:"online",isApproved:!0}}),[R,Y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t&&(async()=>{try{var e,a,n,l,r,s;let o=(await (0,f.bp)(t,"generous-contribution")).items;U("paypal_order_id",o.paypal_order_id||""),U("paypal_payment_id",o.paypal_payment_id||""),U("paypal_payer_id",o.paypal_payer_id||""),U("paypal_capture_id",o.paypal_capture_id||""),U("name",o.name||""),U("phNo",o.phNo||""),U("email",o.email||(null===(e=o.payer)||void 0===e?void 0:e.email_address)||""),U("address",o.address||""),U("amount",o.amount),U("currency",o.currency||"AUD"),U("status",o.status||"completed"),U("paymentMode",o.paymentMode||"online"),U("manualMethod",o.manualMethod||void 0),U("transactionReference",o.transactionReference||""),U("paymentDate",(null===(a=o.paymentDate)||void 0===a?void 0:a.split("T")[0])||""),U("remarks",o.remarks||""),U("isApproved",!1!==o.isApproved),U("contribution.purpose",(null===(n=o.contribution)||void 0===n?void 0:n.purpose)||"general_donation"),U("contribution.description",(null===(l=o.contribution)||void 0===l?void 0:l.description)||"General donation"),U("source",o.source||"website"),w({value:o.status||"completed",label:o.status?o.status.charAt(0).toUpperCase()+o.status.slice(1):"Completed"}),p({value:o.paymentMode||"online",label:"offline"===o.paymentMode?"Offline":"Online"}),A({value:o.currency||"AUD",label:o.currency||"AUD"}),P({value:(null===(r=o.contribution)||void 0===r?void 0:r.purpose)||"general_donation",label:(null===(s=o.contribution)||void 0===s?void 0:s.purpose)?o.contribution.purpose.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"General Donation"}),M({value:o.source||"website",label:o.source?o.source.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Website"}),z({value:!1!==o.isApproved,label:!1!==o.isApproved?"Yes":"No"}),o.manualMethod&&j({value:o.manualMethod,label:o.manualMethod.charAt(0).toUpperCase()+o.manualMethod.slice(1)})}catch(e){console.error("Error fetching payment details:",e)}})()},[t,U]);let q=async e=>{Y(!0);try{let a={...e,amount:Number(e.amount),...e.paymentDate&&{paymentDate:new Date(e.paymentDate).toISOString()}};if(t){let e=await (0,b.V)(a,"generous-payments",t);e._id?y.Z.success("Contribution updated successfully"):(O(e.id,{message:e.value}),y.Z.error("Error updating contribution"))}else{let e=await (0,g.U)("generous-payments/manual",a);e._id?(y.Z.success("Contribution created successfully"),G()):(O(e.id,{message:e.value}),y.Z.error("Error creating contribution"))}}catch(e){console.error("Error submitting form:",e),y.Z.error("Error submitting form")}finally{Y(!1)}},G=()=>{U("amount",0),U("status","completed"),U("paymentMode","online"),U("isApproved",!0),U("contribution.purpose","general_donation"),U("contribution.description","General donation"),U("source","website"),U("currency","AUD"),p({value:"online",label:"Online"}),w({value:"completed",label:"Completed"}),A({value:"AUD",label:"AUD"}),P({value:"general_donation",label:"General Donation"}),M({value:"website",label:"Website"}),z({value:!0,label:"Yes"}),j(void 0),r((0,c.Oe)())};return(0,n.jsxs)("form",{onSubmit:S(q),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(h._,{htmlFor:"amount",className:"required",children:"Amount"}),(0,n.jsx)(m.I,{id:"amount",type:"number",...F("amount",{valueAsNumber:!0}),placeholder:"Enter amount",className:"w-full ".concat(k.amount?"border-red-500":"")}),k.amount&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.amount.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"currency",children:"Currency"}),(0,n.jsx)(v.ZP,{id:"currency",options:[{value:"AUD",label:"AUD"},{value:"USD",label:"USD"}],value:D,onChange:e=>{A(e),U("currency",e.value)},classNamePrefix:"select"}),k.currency&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.currency.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"status",className:"required",children:"Status"}),(0,n.jsx)(v.ZP,{id:"status",options:[{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"cancelled",label:"Cancelled"},{value:"refunded",label:"Refunded"},{value:"partially_refunded",label:"Partially Refunded"}],value:N,onChange:e=>{w(e),U("status",e.value)},classNamePrefix:"select"}),k.status&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.status.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"paymentMode",className:"required",children:"Payment Mode"}),(0,n.jsx)(v.ZP,{id:"paymentMode",options:[{value:"online",label:"Online"},{value:"offline",label:"Offline"}],value:i,onChange:e=>{p(e),U("paymentMode",e.value),"online"===e.value&&(j(void 0),U("manualMethod",void 0))},classNamePrefix:"select"}),k.paymentMode&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.paymentMode.message})]}),"offline"===Z("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"manualMethod",children:"Manual Method"}),(0,n.jsx)(v.ZP,{id:"manualMethod",options:[{value:"cash",label:"Cash"},{value:"cheque",label:"Cheque"},{value:"bank_transfer",label:"Bank Transfer"},{value:"other",label:"Other"}],value:_,onChange:e=>{j(e),U("manualMethod",e.value)},classNamePrefix:"select"}),k.manualMethod&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.manualMethod.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"transactionReference",children:"Transaction Reference"}),(0,n.jsx)(m.I,{id:"transactionReference",...F("transactionReference"),placeholder:"Cheque no, UTR, etc.",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"paymentDate",children:"Payment Date"}),(0,n.jsx)(m.I,{type:"date",id:"paymentDate",...F("paymentDate"),className:"w-full"})]}),(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(h._,{htmlFor:"remarks",children:"Remarks"}),(0,n.jsx)(m.I,{id:"remarks",...F("remarks"),placeholder:"Enter remarks",className:"w-full"})]})]}),"online"===Z("paymentMode")&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"paypal_payment_id",children:"PayPal Payment ID"}),(0,n.jsx)(m.I,{id:"paypal_payment_id",...F("paypal_payment_id"),placeholder:"Enter PayPal payment ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"paypal_order_id",children:"PayPal Order ID"}),(0,n.jsx)(m.I,{id:"paypal_order_id",...F("paypal_order_id"),placeholder:"Enter PayPal order ID",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"paypal_payer_id",children:"PayPal Payer ID"}),(0,n.jsx)(m.I,{id:"paypal_payer_id",...F("paypal_payer_id"),placeholder:"Enter PayPal payer ID",className:"w-full"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"name",children:"Payer Name"}),(0,n.jsx)(m.I,{id:"name",...F("name"),placeholder:"Enter payer name",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(m.I,{id:"email",...F("email"),placeholder:"Enter payer email",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"phNo",children:"Phone Number"}),(0,n.jsx)(m.I,{id:"phNo",...F("phNo"),placeholder:"Enter payer phone number",className:"w-full"})]}),(0,n.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,n.jsx)(h._,{htmlFor:"address",children:"Address"}),(0,n.jsx)(m.I,{id:"address",...F("address"),placeholder:"Enter payer address",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"purpose",children:"Contribution Purpose"}),(0,n.jsx)(v.ZP,{id:"purpose",options:[{value:"general_donation",label:"General Donation"},{value:"medical_assistance",label:"Medical Assistance"},{value:"education_support",label:"Education Support"},{value:"emergency_fund",label:"Emergency Fund"},{value:"other",label:"Other"}],value:I,onChange:e=>{P(e),U("contribution.purpose",e.value),U("contribution.description","general_donation"===e.value?"General donation":"".concat(e.label," contribution"))},classNamePrefix:"select"}),(null===(a=k.contribution)||void 0===a?void 0:a.purpose)&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.contribution.purpose.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{htmlFor:"source",children:"Source"}),(0,n.jsx)(v.ZP,{id:"source",options:[{value:"website",label:"Website"},{value:"mobile_app",label:"Mobile App"},{value:"social_media",label:"Social Media"},{value:"email_campaign",label:"Email Campaign"},{value:"other",label:"Other"}],value:C,onChange:e=>{M(e),U("source",e.value)},classNamePrefix:"select"}),k.source&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:k.source.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(h._,{children:"Approved"}),(0,n.jsx)(v.ZP,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],value:E,onChange:e=>{z(e),U("isApproved",e.value)},classNamePrefix:"select"})]}),(0,n.jsxs)("div",{className:"flex justify-between col-span-1 lg:col-span-2",children:[(0,n.jsx)(o.z,{onClick:G,className:"bg-slate-400 hover:bg-slate-500",children:t?"Cancel":"Clear"}),(0,n.jsx)(o.z,{className:R?"cursor-not-allowed opacity-50":"",type:"submit",children:t?"Update":"Create"})]})]})};function j(){let[e,a]=(0,l.useState)(!0),t=(0,s.I0)(),d=(0,s.v9)(e=>e.update.url),u=(0,s.v9)(e=>e.update.id);return(0,n.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Payments"}),"payment"===d?"":(0,n.jsx)(o.z,{onClick:()=>{t((0,i.Ib)()),t((0,c.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Payment":"View Payments"})]}),"payment"===d?u&&(0,n.jsx)(_,{paymentId:u}):e?(0,n.jsx)(r.default,{}):(0,n.jsx)(_,{})]})}},279:function(e,a,t){"use strict";t.d(a,{I:function(){return s}});var n=t(7437),l=t(2265),r=t(3448);let s=l.forwardRef((e,a)=>{let{className:t,type:l,...s}=e;return(0,n.jsx)("input",{type:l,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input  px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s})});s.displayName="Input"},5060:function(e,a,t){"use strict";t.d(a,{_:function(){return c}});var n=t(7437),l=t(2265),r=t(6394),s=t(535),o=t(3448);let i=(0,s.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,a)=>{let{className:t,...l}=e;return(0,n.jsx)(r.f,{ref:a,className:(0,o.cn)(i(),t),...l})});c.displayName=r.f.displayName},5974:function(e,a,t){"use strict";t.d(a,{Ib:function(){return r}});let n=(0,t(1455).oM)({name:"payment",initialState:{id:null,paymentId:null},reducers:{setPaymentId:(e,a)=>{e.paymentId=a.payload},clearPaymentId:e=>{e.paymentId=null}}}),{setPaymentId:l,clearPaymentId:r}=n.actions;a.ZP=n.reducer},662:function(e,a,t){"use strict";t.d(a,{U:function(){return l}});var n=t(3618);let l=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let l=await n.YD.post("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(e,"/"),a,{headers:{"Content-Type":t?"multipart/form-data":"application/json"}});return console.log(l),l.data.data}catch(a){console.error("Error creating data:",a);let e=a.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},2786:function(e,a,t){"use strict";t.d(a,{Ak:function(){return o},GZ:function(){return i},bp:function(){return s},dQ:function(){return d},fp:function(){return p},rQ:function(){return r},tE:function(){return c},uh:function(){return u}});var n=t(3618);let l="https://api.donatebed.shanthibhavan.in/v1",r=async e=>{try{return{items:(await n.YD.get("/".concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},s=async(e,a)=>{try{return{items:(await n.YD.get("/".concat(a,"/").concat(e))).data.data}}catch(e){return console.error("Error fetching data:",e),{items:[]}}},o=async e=>(await n.YD.get("".concat(l,"/organization?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,i=async e=>{let a=Number(e);return console.log("searchTerm",e,a,typeof a,typeof e),(await n.YD.get("".concat(l,"/bed?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(a):""))).data.data},c=async e=>(await n.YD.get("".concat(l,"/country?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,d=async(e,a)=>(await n.YD.get("".concat(l,"/staff?").concat(a?"organization__eq=".concat(a,"&"):"","limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""))).data.data,u=async e=>{let a=await n.YD.get("".concat(l,"/user?limit=Infinity&sortBy=updatedAt").concat(e?"&search=".concat(e):""));return console.log(a),a.data.data},p=async()=>(await n.YD.get("".concat(l,"/role"))).data.data},9093:function(e,a,t){"use strict";t.d(a,{V:function(){return l}});var n=t(3618);let l=async function(e,a,t){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{return console.log(typeof e),(await n.YD.put("".concat("https://api.donatebed.shanthibhavan.in/v1","/").concat(a,"/").concat(t),e,{headers:{"Content-Type":l?"multipart/form-data":"application/json"}})).data.data}catch(a){console.log(a),console.log(a.response.data);let e=a.response.data;if("VALIDATION_FAILED"!==e.message)return{msg:"Something went wrong"};if(e.error)return{idNumber:"Identification Details Should be unique"};if(e.errorsList)return{id:e.errorsList[0].path,value:e.errorsList[0].msg}}}},4978:function(e,a,t){"use strict";var n=t(7261);a.Z={success:e=>{n.Am.success(e,{autoClose:2e3})},error:e=>{n.Am.error(e,{autoClose:2e3})},info:e=>{n.Am.info(e,{autoClose:2e3})},warning:e=>{n.Am.warning(e,{autoClose:2e3})}}}},function(e){e.O(0,[8310,3464,969,6827,1229,7261,9027,237,3402,8575,1455,1145,4285,8438,7217,2971,2117,1744],function(){return e(e.s=8664)}),_N_E=e.O()}]);