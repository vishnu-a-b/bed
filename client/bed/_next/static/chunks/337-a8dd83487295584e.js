(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[337],{9337:function(e,a,t){Promise.resolve().then(t.bind(t,4687))},4687:function(e,a,t){"use strict";t.d(a,{default:function(){return F}});var r=t(7437),s=t(2265),n=t(8438),i=t(3618),l=t(386);let o=[{accessorKey:"name",header:"Organization Name"},{accessorKey:"management",header:"Management"}];function d(){var e;let a;let[t,d]=(0,s.useState)([]),[c,m]=(0,s.useState)(0),[u,g]=(0,s.useState)(0),[x,h]=(0,s.useState)(10),[p,b]=(0,s.useState)(""),[v,f]=(0,s.useState)(""),[j,y]=(0,s.useState)(""),N=(0,l.v9)(e=>e.update.refresh),w=(0,l.v9)(e=>e.organization.id),k=(0,s.useCallback)((e=e=>{y(e),g(0)},function(){for(var t=arguments.length,r=Array(t),s=0;s<t;s++)r[s]=arguments[s];clearTimeout(a),a=setTimeout(()=>{e(...r)},500)}),[]);async function z(){try{let e="";if(w){let e=await i.YD.get("/organization/".concat(w)),a=[];return a[0]=e.data.data,m(1),a}"Active"===v?e="isActive__eq=true&":"InActive"===v&&(e="isActive__eq=false&");let a=(await i.YD.get("/organization?limit=".concat(x,"&skip=").concat(u*x,"&").concat(e).concat(j?"search=".concat(j,"&"):""))).data.data;return m(a.total),a.items}catch(e){console.error("Error fetching data:",e)}}return(0,s.useEffect)(()=>{(async function(){d(await z())})(),console.log("Fetching data with params:",t)},[u,x,j,v,N,w]),(0,r.jsx)("div",{className:"flex flex-col items-center p-4",children:(0,r.jsxs)("div",{className:"container mx-auto py-10",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("input",{type:"text",value:p,onChange:e=>{let a=e.target.value;b(a),k(a)},placeholder:"Search organizations...",className:"mb-4 p-2 border rounded"}),(0,r.jsxs)("select",{value:v,onChange:e=>{f(e.target.value),g(0)},className:"mb-4 p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"all",children:"All"}),(0,r.jsx)("option",{value:"Active",children:"Active"}),(0,r.jsx)("option",{value:"InActive",children:"InActive"})]})]}),(0,r.jsx)(n.w,{url:"organization",columns:o,data:t,totalRows:c,pageIndex:u,pageSize:x,onPageChange:g,onPageSizeChange:h,actions:{delete:!0,edit:!0}})]})})}var c=t(2381),m=t(2664),u=t(7520),g=t(9501),x=t(3590),h=t(1229),p=t(279),b=t(5060),v=t(3448);let f=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("textarea",{className:(0,v.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...s})});f.displayName="Textarea";var j=t(4978),y=t(9093),N=t(662),w=t(2786),k=t(6528),z=t(1929),C=t(4395),S=t(7810),L=t(7480);let _=h.z.object({address:h.z.string().min(1,{message:"Address is required"}).max(200),management:h.z.string().optional(),pinCode:h.z.string().min(1,{message:"Pin Code is required"}).max(10),latitude:h.z.number({message:"Expected a Number"}).optional(),longitude:h.z.number({message:"Expected a Number"}).optional(),name:h.z.string().min(1,{message:"Name is required"}).max(200),photos:h.z.array(h.z.string().max(200)).optional(),vcLink:h.z.string().max(200).optional(),contactMobileNumbers:h.z.array(h.z.string().max(20)).optional()});var I=e=>{let{organizationId:a}=e,[t,n]=(0,s.useState)([""]),[i,o]=(0,s.useState)([]),[d,m]=(0,s.useState)(!1),[h,v]=(0,s.useState)(""),[I,F]=(0,s.useState)(!1),[M,A]=(0,s.useState)(),E=(0,l.I0)(),[O,P]=(0,s.useState)([]),[Z,q]=(0,s.useState)(!1),{handleSubmit:D,register:U,setValue:R,formState:{errors:T},setError:K}=(0,g.cI)({resolver:(0,x.F)(_)});(0,s.useEffect)(()=>{a&&(async()=>{m(!0);try{var e,t,r,s,i,l;let d=(await (0,w.bp)(a,"organization")).items;if(v(null===(e=d.address)||void 0===e?void 0:e._id),R("name",d.name),R("address",(null===(t=d.address)||void 0===t?void 0:t.address)||""),R("pinCode",(null===(r=d.address)||void 0===r?void 0:r.pinCode)||""),R("latitude",(null===(s=d.address)||void 0===s?void 0:s.latitude)||void 0),R("longitude",(null===(i=d.address)||void 0===i?void 0:i.longitude)||void 0),R("vcLink",d.vcLink||""),R("management",d.management||""),n((null===(l=d.contactMobileNumbers)||void 0===l?void 0:l.length)===0?[""]:d.contactMobileNumbers||[""]),o(d.photos||[]),d.admin){let e=await (0,w.bp)(d.admin,"user");console.log(e);let a=e.items;A({value:d.admin,label:a.name})}m(!1)}catch(e){console.error("Error fetching organization details:",e),m(!1)}})()},[a,R]);let Y=()=>{n([...t,""])},V=e=>{n(t.filter((a,t)=>t!==e))},B=()=>{n([""]),o([]),R("name",""),R("address",""),R("pinCode",""),R("latitude",void 0),R("longitude",void 0),R("management",""),R("vcLink",""),A(void 0),E((0,u.Oe)())},G=(e,a)=>{let r=[...t];r[e]=a,n(r)},J=async e=>{q(!0);try{let r={...e.address&&{address:e.address},...e.pinCode&&{pinCode:e.pinCode},...e.latitude&&{latitude:e.latitude},...e.longitude&&{longitude:e.longitude},taluk:"Unknown",district:"Unknown"},s=await Promise.all(O.map(async e=>{if(e.file)return e.file}));if(a){let n=h;h?await (0,y.V)(r,"address",h):n=(await (0,N.U)("address",r))._id,console.log(s);let i={...e.name&&{name:e.name},...s.length>0&&{photos:s},...e.vcLink&&{vcLink:e.vcLink},...t.length>0&&{contactMobileNumbers:t,address:n},...e.management&&{management:e.management},...M&&{admin:M.value}};console.log(i);let l=await (0,y.V)(i,"organization",a,!0);l._id?(j.Z.success("organization updated successfully"),B()):(K(l.id,{message:l.value}),j.Z.error("An error occurred while submitting the form"))}else{let a=await (0,N.U)("address",r);if(a._id){let r={...e.name&&{name:e.name},...a._id&&{address:a._id},...i.length>0&&{photos:i},...e.vcLink&&{vcLink:e.vcLink},...t.length>0&&{contactMobileNumbers:t},...e.management&&{management:e.management},...M&&{admin:M.value}},s=await (0,N.U)("organization",r,!0);s._id?(j.Z.success("organization created successfully"),B()):((0,k.S)("address",a._id),K(s.id,{message:s.value}),j.Z.error("An error occurred while submitting the form"))}else K(a.id,{message:a.value}),j.Z.error("An error occurred while submitting the form")}}catch(e){console.error("Failed to submit form:",e),j.Z.error("An error occurred while submitting the form")}finally{q(!1)}};return d?(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-[70vh]",children:(0,r.jsx)("div",{className:"loader"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:D(J),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,r.jsx)(b._,{htmlFor:"name",className:"required",children:"Name"}),(0,r.jsx)(p.I,{id:"name",...U("name"),placeholder:"Enter organization name",className:"w-full border rounded p-2 ".concat(T.name?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),T.name&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.name.message})]}),(0,r.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,r.jsx)(b._,{htmlFor:"management",children:"Management"}),(0,r.jsx)(p.I,{id:"management",...U("management"),placeholder:"Enter management name",className:"w-full border rounded p-2 ".concat(T.management?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),T.management&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.management.message})]}),(0,r.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,r.jsx)(b._,{htmlFor:"address",className:"required",children:"Address"}),(0,r.jsx)(f,{id:"address",...U("address"),placeholder:"Enter address",className:"w-full border rounded p-2 ".concat(T.address?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),T.address&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.address.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(b._,{htmlFor:"pinCode",className:" required ",children:"Pin Code"}),(0,r.jsx)(p.I,{id:"pinCode",...U("pinCode"),placeholder:"Enter pin code",className:"w-full border rounded p-2 ".concat(T.pinCode?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),T.pinCode&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.pinCode.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(b._,{htmlFor:"latitude",children:"Latitude"}),(0,r.jsx)(p.I,{id:"latitude",type:"text",step:"any",...U("latitude",{valueAsNumber:!0}),placeholder:"Enter latitude",className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),T.latitude&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.latitude.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(b._,{htmlFor:"longitude",children:"Longitude"}),(0,r.jsx)(p.I,{id:"longitude",type:"text",step:"any",...U("longitude",{valueAsNumber:!0}),placeholder:"Enter longitude",className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),T.longitude&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.longitude.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(b._,{htmlFor:"vcLink",children:"organization Meeting Link"}),(0,r.jsx)(p.I,{id:"vcLink",...U("vcLink"),placeholder:"Enter organization Meeting Link",className:"w-full border rounded p-2 ".concat(T.vcLink?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),T.vcLink&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.vcLink.message})]}),(0,r.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,r.jsx)(b._,{htmlFor:"admin",children:"Admin"}),(0,r.jsxs)("div",{className:" flex space-x-2 ",children:[(0,r.jsx)(S.Z,{cacheOptions:!0,loadOptions:C.p_,defaultOptions:!0,value:M,onChange:e=>{console.log(e),A(e)},classNamePrefix:"select",className:"flex-1",isClearable:!0}),(0,r.jsx)(c.z,{onClick:()=>{F(!I)},children:"+"})]}),T.vcLink&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.vcLink.message})]}),(0,r.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,r.jsx)(b._,{htmlFor:"photos",children:"Photos"}),(0,r.jsx)(L.J,{value:O,dropzoneOptions:{maxFiles:6,maxSize:5242880},onChange:P,onFilesAdded:async e=>{P([...O,...e])}}),T.photos&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.photos.message})]}),(0,r.jsxs)("div",{className:"col-span-1 lg:col-span-2",children:[(0,r.jsx)(b._,{htmlFor:"contactMobileNumbers",children:"Contact Mobile Numbers"}),t.map((e,a)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2 ",children:[(0,r.jsx)(p.I,{value:e,onChange:e=>G(a,e.target.value),placeholder:"Enter mobile number",className:"flex-1 border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),t.length>1&&(0,r.jsx)(c.z,{type:"button",onClick:()=>V(a),className:"bg-red-500 text-white hover:bg-red-600",children:"-"}),a===t.length-1&&(0,r.jsx)(c.z,{type:"button",onClick:Y,className:" bg-sidebar-accent text-white",children:"+"})]},a)),T.contactMobileNumbers&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:T.contactMobileNumbers.message})]}),(0,r.jsxs)("div",{className:"flex justify-between col-span-1 lg:col-span-2",children:[(0,r.jsx)(c.z,{onClick:B,className:" bg-slate-400 hover:bg-slate-500",children:a?"Cancel":"Clear"}),(0,r.jsx)(c.z,{className:Z?"cursor-not-allowed opacity-50":"",type:"submit",children:a?"Update":"Create"})]})]}),I&&(0,r.jsx)(z.Z,{onClose:()=>F(!1),role:"6771959e0c2a67fe52bcf45f",userSet:A})]})};function F(){let[e,a]=(0,s.useState)(!0),t=(0,l.I0)(),n=(0,l.v9)(e=>e.update.url),i=(0,l.v9)(e=>e.update.id);return(0,r.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Organizations"}),"organization"===n?"":(0,r.jsx)(c.z,{onClick:()=>{t((0,m.KL)()),t((0,u.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Organization":"View Organizations"})]}),"organization"===n?i&&(0,r.jsx)(I,{organizationId:i}):e?(0,r.jsx)(d,{}):(0,r.jsx)(I,{})]})}},7480:function(e,a,t){"use strict";t.d(a,{J:function(){return m}});var r=t(7437),s=t(2489),n=t(8156),i=t(2265),l=t(5598),o=t(3335);let d={base:"relative rounded-md aspect-square flex justify-center items-center flex-col cursor-pointer min-h-[30px] min-w-[40px] border border-dashed border-gray-400 dark:border-gray-300 transition-colors duration-200 ease-in-out",image:"border-0 p-0 w-full h-full relative shadow-md bg-slate-200 dark:bg-slate-900 rounded-md",active:"border-2",disabled:"bg-gray-200 border-gray-300 cursor-default pointer-events-none bg-opacity-30 dark:bg-gray-700",accept:"border border-blue-500 bg-blue-500 bg-opacity-10",reject:"border border-red-700 bg-red-700 bg-opacity-10"},c={fileInvalidType:()=>"Invalid file type.",tooManyFiles:e=>"You can only add ".concat(e," file(s)."),fileNotSupported:()=>"The file is not supported."},m=i.forwardRef((e,a)=>{var t;let{dropzoneOptions:m,value:x,className:h,disabled:p,onChange:b,onFilesAdded:v}=e,[f,j]=i.useState(),y=i.useMemo(()=>x?x.map(e=>"string"==typeof e.file?e.file:URL.createObjectURL(e.file)):[],[x]),{getRootProps:N,getInputProps:w,fileRejections:k,isFocused:z,isDragAccept:C,isDragReject:S}=(0,l.uI)({accept:{"image/*":[]},disabled:p,onDrop:e=>{var a;if(j(void 0),(null==m?void 0:m.maxFiles)&&(null!==(a=null==x?void 0:x.length)&&void 0!==a?a:0)+e.length>m.maxFiles){j(c.tooManyFiles(m.maxFiles));return}if(e){let a=e.map(e=>({file:e,key:Math.random().toString(36).slice(2),progress:"PENDING"}));null==v||v(a),null==b||b([...null!=x?x:[],...a])}},...m}),L=i.useMemo(()=>(0,o.m6)(d.base,z&&d.active,p&&d.disabled,(null!=S?S:k[0])&&d.reject,C&&d.accept,h).trim(),[z,k,C,S,p,h]),_=i.useMemo(()=>{if(k[0]){var e,a,t;let{errors:r}=k[0];return(null===(e=r[0])||void 0===e?void 0:e.code)==="file-invalid-type"?c.fileInvalidType():(null===(a=r[0])||void 0===a?void 0:a.code)==="too-many-files"?c.tooManyFiles(null!==(t=null==m?void 0:m.maxFiles)&&void 0!==t?t:0):c.fileNotSupported()}},[k,m]);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"grid grid-cols-[repeat(4,1fr)] gap-2  ",children:[null==x?void 0:x.map((e,a)=>{let{file:t,progress:n}=e;return(0,r.jsxs)("div",{className:d.image+" aspect-square",children:[(0,r.jsx)("img",{className:"h-full w-full rounded-md object-cover",src:y[a],alt:"string"==typeof t?t:t.name}),"number"==typeof n&&(0,r.jsx)("div",{className:"absolute top-0 left-0 flex h-full w-full items-center justify-center rounded-md bg-black bg-opacity-70",children:(0,r.jsx)(g,{progress:n})}),y[a]&&!p&&"PENDING"===n&&(0,r.jsx)("div",{className:"group absolute right-0 top-0 -translate-y-1/4 translate-x-1/4 transform",onClick:e=>{var t;e.stopPropagation(),null==b||b(null!==(t=x.filter((e,t)=>t!==a))&&void 0!==t?t:[])},children:(0,r.jsx)("div",{className:"flex h-5 w-5 cursor-pointer items-center justify-center rounded-md border border-solid border-gray-500 bg-white transition-all duration-300 hover:h-6 hover:w-6 dark:border-gray-400 dark:bg-black",children:(0,r.jsx)(s.Z,{className:"text-gray-500 dark:text-gray-400",width:16,height:16})})})]},a)}),(!x||x.length<(null!==(t=null==m?void 0:m.maxFiles)&&void 0!==t?t:0))&&(0,r.jsxs)("div",{...N({className:L}),children:[(0,r.jsx)("input",{ref:a,...w()}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center text-xs text-gray-400",children:[(0,r.jsx)(n.Z,{className:"mb-2 h-7 w-7"}),(0,r.jsx)("div",{className:"text-gray-400 text-center   ",children:"drag & drop to upload"}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)(u,{type:"button",disabled:p,children:"select"})})]})]})]}),(0,r.jsx)("div",{className:"mt-1 text-xs text-red-500",children:null!=f?f:_})]})});m.displayName="MultiImageDropzone";let u=i.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("button",{className:(0,o.m6)("focus-visible:ring-ring inline-flex cursor-pointer items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 disabled:pointer-events-none disabled:opacity-50","border border-gray-400 text-gray-400 shadow hover:bg-gray-100 hover:text-gray-500 dark:border-gray-600 dark:text-gray-100 dark:hover:bg-gray-700","h-6 rounded-md px-2 text-xs",t),ref:a,...s})});function g(e){let{progress:a}=e,t=2*Math.PI*50;return(0,r.jsxs)("div",{className:"relative h-16 w-16",children:[(0,r.jsxs)("svg",{className:"absolute top-0 left-0 -rotate-90 transform ",width:"100%",height:"100%",viewBox:"0 0 ".concat(120," ").concat(120),children:[(0,r.jsx)("circle",{className:"text-gray-400",stroke:"currentColor",strokeWidth:10,fill:"none",cx:60,cy:60,r:50}),(0,r.jsx)("circle",{className:"text-white transition-all duration-300 ease-in-out",stroke:"currentColor",strokeWidth:10,strokeDasharray:t,strokeDashoffset:(100-a)/100*t,strokeLinecap:"round",fill:"none",cx:60,cy:60,r:50})]}),(0,r.jsxs)("div",{className:"absolute top-0 left-0 flex h-full w-full items-center justify-center text-xs text-white",children:[Math.round(a),"%"]})]})}u.displayName="Button"},2664:function(e,a,t){"use strict";t.d(a,{KL:function(){return n}});let r=(0,t(1455).oM)({name:"business",initialState:{id:null,name:null},reducers:{setOrganizationId:(e,a)=>{e.id=a.payload},clearOrganizationId:e=>{e.id=null},setOrganizationName:(e,a)=>{e.name=a.payload},clearOrganizationName:e=>{e.name=null}}}),{setOrganizationId:s,clearOrganizationId:n,setOrganizationName:i,clearOrganizationName:l}=r.actions;a.ZP=r.reducer},6528:function(e,a,t){"use strict";t.d(a,{S:function(){return s}});var r=t(3618);let s=async(e,a)=>{try{let t=await r.YD.delete("".concat(e,"/").concat(a));return console.log(t),t}catch(e){console.error("Error deleting data:",e)}}}}]);