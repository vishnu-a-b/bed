(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[690],{8921:function(e,a,t){Promise.resolve().then(t.bind(t,6178))},6178:function(e,a,t){"use strict";t.d(a,{default:function(){return I}});var r=t(7437),n=t(2265),s=t(8438),l=t(3618),c=t(386),i=t(4291),o=t(2381),d=t(4051),u=t(9376),m=t(7520);let f=[{accessorKey:"name",header:"Country Name"},{accessorKey:"currency",header:"Currency"},{accessorKey:"organization.name",header:"Organization"},{accessorKey:"head.name",header:"Head"},{accessorKey:"viewDetails",header:"Actions",cell:e=>{let a=e.row.original;return(0,r.jsxs)(i.Vq,{children:[(0,r.jsx)(i.hg,{className:"underline",children:(0,r.jsx)("button",{className:"px-4 p-1 text-white bg-sidebar-primary rounded-full",children:"View"})}),(0,r.jsx)(i.cZ,{className:"p-6",children:(0,r.jsx)(x,{data:a})})]})}}],x=e=>{var a,t;let{data:n}=e,s=(0,c.I0)(),l=(0,u.useRouter)();return(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[n.flag&&(0,r.jsx)("img",{className:"w-20 h-fit object-cover rounded-sm",crossOrigin:"anonymous",src:n.flag,alt:"Country Flag"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-bold",children:n.name}),(0,r.jsxs)("p",{children:["Currency: ",n.currency]}),(0,r.jsxs)("p",{children:["Organization: ",(null===(a=n.organization)||void 0===a?void 0:a.name)||"N/A"]}),(0,r.jsxs)("p",{children:["Head: ",(null===(t=n.head)||void 0===t?void 0:t.name)||"N/A"]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,r.jsx)(o.z,{className:"text-sm",onClick:e=>{e.preventDefault(),s((0,d.YR)(n._id)),s((0,d.Ij)(n.name)),l.push("/admin/country-details")},children:"View Details"}),(0,r.jsx)(o.z,{className:"text-sm",onClick:e=>{s((0,m.R5)("country")),s((0,m.h9)(n._id))},children:"Edit"}),(0,r.jsx)(o.z,{className:"text-sm",onClick:e=>{},children:"Manage Regions"})]})]})};function h(){var e;let a;let[t,i]=(0,n.useState)([]),[o,d]=(0,n.useState)(0),[u,m]=(0,n.useState)(0),[x,h]=(0,n.useState)(10),[g,y]=(0,n.useState)(""),[p,j]=(0,n.useState)(""),[v,b]=(0,n.useState)(""),N=(0,c.v9)(e=>e.update.refresh),w=(0,c.v9)(e=>e.country.id),C=(0,c.v9)(e=>e.organization.id),z=(0,n.useCallback)((e=e=>{b(e),m(0)},function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];clearTimeout(a),a=setTimeout(()=>{e(...r)},500)}),[]);async function k(){try{let e="";if(w){let e=await l.YD.get("/country/".concat(w)),a=[];return a[0]=e.data.data,d(1),a}"Active"===p?e="isActive__eq=true&":"InActive"===p&&(e="isActive__eq=false&");let a="";C&&(a="organization__eq=".concat(C,"&"));let t=(await l.YD.get("/country?limit=".concat(x,"&skip=").concat(u*x,"&").concat(a).concat(e).concat(v?"search=".concat(v,"&"):""))).data.data;return console.log("Fetched items:",t),d(t.total),t.items}catch(e){console.error("Error fetching data:",e)}}return(0,n.useEffect)(()=>{(async function(){i(await k())})()},[u,x,v,p,N,w,C]),(0,r.jsx)("div",{className:"flex flex-col items-center p-4",children:(0,r.jsxs)("div",{className:"container mx-auto py-10",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("input",{type:"text",value:g,onChange:e=>{let a=e.target.value;y(a),z(a)},placeholder:"Search countries...",className:"mb-4 p-2 border rounded"}),(0,r.jsxs)("select",{value:p,onChange:e=>{j(e.target.value),m(0)},className:"mb-4 p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"all",children:"All"}),(0,r.jsx)("option",{value:"Active",children:"Active"}),(0,r.jsx)("option",{value:"InActive",children:"InActive"})]})]}),(0,r.jsx)(s.w,{url:"country",columns:f,data:t,totalRows:o,pageIndex:u,pageSize:x,onPageChange:m,onPageSizeChange:h,actions:{delete:!0,edit:!0}})]})})}var g=t(9501),y=t(3590),p=t(1229),j=t(279),v=t(5060),b=t(4978),N=t(9093),w=t(662),C=t(2786),z=t(1929),k=t(4395),S=t(7810);let _=p.z.object({name:p.z.string().min(1,{message:"Name is required"}).max(200),currency:p.z.string().min(1,{message:"Currency is required"}).max(200),flag:p.z.string().max(200).optional()});var A=e=>{let{countryId:a}=e,[t,s]=(0,n.useState)(!1),[l,i]=(0,n.useState)(!1),[d,u]=(0,n.useState)(),[f,x]=(0,n.useState)(),[h,p]=(0,n.useState)([]),[A,I]=(0,n.useState)(!1),O=(0,c.I0)(),{handleSubmit:E,register:R,setValue:Z,formState:{errors:V},setError:q}=(0,g.cI)({resolver:(0,y.F)(_)});(0,n.useEffect)(()=>{a&&(async()=>{s(!0);try{let e=(await (0,C.bp)(a,"country")).items;if(Z("name",e.name),Z("currency",e.currency),Z("flag",e.flag||""),e.organization){let a=(await (0,C.bp)(e.organization,"organization")).items;x({value:e.organization,label:a.name})}if(e.head){let a=(await (0,C.bp)(e.head,"user")).items;u({value:e.head,label:a.name})}s(!1)}catch(e){console.error("Error fetching country details:",e),s(!1)}})()},[a,Z]);let D=()=>{Z("name",""),Z("currency",""),Z("flag",""),u(void 0),x(void 0),p([]),O((0,m.Oe)())},F=async e=>{I(!0);try{var t;let r=null===(t=h[0])||void 0===t?void 0:t.file;if(a){let t={name:e.name,currency:e.currency,...r&&{flag:r},...f&&{organization:f.value},...d&&{head:d.value}},n=await (0,N.V)(t,"country",a,!0);n._id?(b.Z.success("Country updated successfully"),D()):(q(n.id,{message:n.value}),b.Z.error("An error occurred while submitting the form"))}else{let a={name:e.name,currency:e.currency,...r&&{flag:r},...f&&{organization:f.value},...d&&{head:d.value}},t=await (0,w.U)("country",a,!0);t._id?(b.Z.success("Country created successfully"),D()):(q(t.id,{message:t.value}),b.Z.error("An error occurred while submitting the form"))}}catch(e){console.error("Failed to submit form:",e),b.Z.error("An error occurred while submitting the form")}finally{I(!1)}};return t?(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-[70vh]",children:(0,r.jsx)("div",{className:"loader"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:E(F),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(v._,{htmlFor:"name",className:"required",children:"Country Name"}),(0,r.jsx)(j.I,{id:"name",...R("name"),placeholder:"Enter country name",className:"w-full border rounded p-2 ".concat(V.name?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),V.name&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:V.name.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(v._,{htmlFor:"currency",className:"required",children:"Currency"}),(0,r.jsx)(j.I,{id:"currency",...R("currency"),placeholder:"Enter currency (e.g., USD, EUR)",className:"w-full border rounded p-2 ".concat(V.currency?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),V.currency&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:V.currency.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(v._,{htmlFor:"organization",children:"Organization"}),(0,r.jsx)(S.Z,{cacheOptions:!0,loadOptions:k.Tz,defaultOptions:!0,value:f,onChange:e=>{x({value:e.id,label:e.label})},classNamePrefix:"select",isClearable:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(v._,{htmlFor:"head",children:"Head"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(S.Z,{cacheOptions:!0,loadOptions:k.p_,defaultOptions:!0,value:d,onChange:e=>{u(e)},classNamePrefix:"select",className:"flex-1",isClearable:!0}),(0,r.jsx)(o.z,{onClick:()=>{i(!l)},children:"+"})]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(o.z,{onClick:D,className:"bg-slate-400 hover:bg-slate-500",children:a?"Cancel":"Clear"}),(0,r.jsx)(o.z,{className:A?"cursor-not-allowed opacity-50":"",type:"submit",children:a?"Update":"Create"})]})]}),l&&(0,r.jsx)(z.Z,{onClose:()=>i(!1),role:"6771959e0c2a67fe52bcf45f",userSet:u})]})};function I(){let[e,a]=(0,n.useState)(!0),t=(0,c.I0)(),s=(0,c.v9)(e=>e.update.url),l=(0,c.v9)(e=>e.update.id);return(0,r.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Countries"}),"country"===s?"":(0,r.jsx)(o.z,{onClick:()=>{t((0,d.PG)()),t((0,m.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Country":"View Countries"})]}),"country"===s?l&&(0,r.jsx)(A,{countryId:l}):e?(0,r.jsx)(h,{}):(0,r.jsx)(A,{})]})}},4291:function(e,a,t){"use strict";t.d(a,{Be:function(){return x},Vq:function(){return i},cZ:function(){return m},fK:function(){return f},hg:function(){return o}});var r=t(7437),n=t(2265),s=t(9027),l=t(653),c=t(3448);let i=s.fC,o=s.xz,d=s.h_;s.x8;let u=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.aV,{ref:a,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});u.displayName=s.aV.displayName;let m=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(s.VY,{ref:a,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[n,(0,r.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(l.Pxu,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=s.VY.displayName;let f=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};f.displayName="DialogHeader",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.Dx,{ref:a,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})}).displayName=s.Dx.displayName;let x=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.dk,{ref:a,className:(0,c.cn)("text-sm text-muted-foreground",t),...n})});x.displayName=s.dk.displayName},4051:function(e,a,t){"use strict";t.d(a,{Ij:function(){return l},PG:function(){return s},YR:function(){return n}});let r=(0,t(1455).oM)({name:"country",initialState:{id:null,name:null},reducers:{setCountryId:(e,a)=>{e.id=a.payload},clearCountryId:e=>{e.id=null},setCountryName:(e,a)=>{e.name=a.payload},clearCountryName:e=>{e.name=null},clearCountry:e=>{e.id=null,e.name=null}}}),{setCountryId:n,clearCountryId:s,setCountryName:l,clearCountryName:c,clearCountry:i}=r.actions;a.ZP=r.reducer}},function(e){e.O(0,[310,599,738,425,261,519,402,27,329,89,877,971,117,744],function(){return e(e.s=8921)}),_N_E=e.O()}]);