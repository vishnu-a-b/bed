(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[366],{8830:function(e,t,s){Promise.resolve().then(s.bind(s,5383))},9388:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9205).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},5383:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var r=s(7437),a=s(2265),n=s(9376),c=s(3464);let o="https://api.donatebed.shanthibhavan.in/v1",i=async e=>(await c.Z.post("".concat(o,"/auth/jwt/verify"),{refreshToken:e})).data.data,l=(e,t)=>{sessionStorage.setItem("access_token",e),localStorage.setItem("refresh_token",t)},u=()=>sessionStorage.getItem("access_token"),m=()=>{sessionStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.reload()},d=c.Z.create({baseURL:o,headers:{"Content-Type":"multipart/form-data"}});d.interceptors.request.use(e=>{let t=u();return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),d.interceptors.response.use(e=>e,async e=>{var t;let s=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!s._retry){s._retry=!0;let e=localStorage.getItem("refresh_token");if(e)try{let{accessToken:t}=await i(e);return l(t,e),s.headers.Authorization="Bearer "+t,d(s)}catch(e){throw m(),window.location.reload(),e}else m(),window.location.reload()}throw e});var h=s(9205);let x=(0,h.Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),y=(0,h.Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var f=s(9388);function g(){let e=(0,n.useSearchParams)(),t=(0,n.useRouter)(),[s,c]=(0,a.useState)("processing"),[o,i]=(0,a.useState)("Verifying your payment...");return(0,a.useEffect)(()=>{(async()=>{try{var s;let r=e.get("razorpay_payment_id"),a=e.get("razorpay_order_id"),n=e.get("razorpay_signature");if(!r||!a||!n)throw Error("Missing payment parameters");let o=await d.post("/payment/verify",{razorpay_payment_id:r,razorpay_order_id:a,razorpay_signature:n});if(null===(s=o.data)||void 0===s?void 0:s.success)c("success"),i("Payment successful! Thank you for your contribution."),setTimeout(()=>{t.push("/")},3e3);else throw Error("Payment verification failed")}catch(e){console.error("Payment verification error:",e),c("error"),i(e instanceof Error?e.message:"Payment verification failed. Please contact support.")}})()},[e,t]),(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:["processing"===s&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(x,{className:"mx-auto h-16 w-16 text-blue-500 animate-spin mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Processing Payment"}),(0,r.jsx)("p",{className:"text-gray-600",children:o})]}),"success"===s&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(y,{className:"mx-auto h-16 w-16 text-green-500 mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Payment Successful!"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:o}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting you back..."})]}),"error"===s&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(f.Z,{className:"mx-auto h-16 w-16 text-red-500 mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Payment Failed"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:o}),(0,r.jsx)("button",{onClick:()=>t.push("/"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Return to Home"})]})]})})}function p(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,r.jsx)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(x,{className:"mx-auto h-16 w-16 text-blue-500 animate-spin mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Loading..."})]})})}),children:(0,r.jsx)(g,{})})}}},function(e){e.O(0,[599,971,117,744],function(){return e(e.s=8830)}),_N_E=e.O()}]);