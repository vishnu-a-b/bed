(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{183:function(e,r,a){Promise.resolve().then(a.bind(a,7137))},7137:function(e,r,a){"use strict";var t=a(7437),s=a(2265),n=a(8997),o=a(401),i=a(9322),l=a(5252),c=a(2369),d=a(9345),m=a(3774),u=a(1229),p=a(3464),h=a(6576),x=a.n(h);a(4074);let y=u.z.object({name:u.z.string().min(1,"Name is required").trim(),email:u.z.string().email("Invalid email address"),phone:u.z.string().min(1,"Phone number is required"),address:u.z.string().optional()}),b=u.z.object({amount:u.z.string().refine(e=>{let r=parseFloat(e);return!isNaN(r)&&r>0},"Please enter a valid amount greater than 0"),currency:u.z.string().default("AUD"),contributor:y,source:u.z.string().default("website")});r.default=()=>{let e="https://api.donatebed.shanthibhavan.in/v1",[r,a]=(0,s.useState)("australia"),h=(()=>{{let e=window.location.hostname.includes("shanthibhavan.in");return{region:e?"india":"australia",currency:e?"INR":"AUD",phoneCountry:e?"in":"au"}}})(),[y,g]=(0,s.useState)({amount:"",currency:h.currency,contributor:{name:"",phone:"",email:"",address:""},source:"website"}),[f,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(null),[v,C]=(0,s.useState)({}),P=()=>{try{return b.parse(y),C({}),!0}catch(e){if(e instanceof u.z.ZodError){let r={};e.errors.forEach(e=>{let a=e.path.join(".");a.startsWith("contributor.")?r[a.replace("contributor.","")]=e.message:r[a]=e.message}),C(r)}return!1}},z=(e,r,a)=>{e&&"amount"!==e&&"currency"!==e&&"source"!==e?g(t=>({...t,[e]:{...t[e],[r]:a}})):g(e=>({...e,[r]:a})),v[r]&&C(e=>{let a={...e};return delete a[r],a})},_=async()=>{try{let r=(await p.Z.post("".concat(e,"/generous-payments-ind/create"),{...y,amount:parseFloat(y.amount)},{headers:{"Content-Type":"application/json"}})).data;if(r.success){let{orderId:a,amount:t,currency:s}=r.data,n={key:"rzp_live_RGb8eb4GQxS75R",amount:100*t,currency:s,name:"Shanthibhavan",description:"Generous Contribution",order_id:a,handler:async function(r){try{if((await p.Z.post("".concat(e,"/generous-payments-ind/verify"),{razorpay_order_id:r.razorpay_order_id,razorpay_payment_id:r.razorpay_payment_id,razorpay_signature:r.razorpay_signature},{headers:{"Content-Type":"application/json"}})).data.success)N("success"),g({amount:"",currency:"INR",contributor:{name:"",phone:"",email:"",address:""},source:"website"});else throw Error("Payment verification failed")}catch(e){console.error("Payment verification error:",e),N("error")}},prefill:{name:y.contributor.name,email:y.contributor.email,contact:y.contributor.phone},theme:{color:"#9333ea"}};new window.Razorpay(n).open()}else throw Error(r.message||"Payment creation failed")}catch(e){throw console.error("Razorpay payment error:",e),N("error"),e}},k=async()=>{try{let r=(await p.Z.post("".concat(e,"/generous-payments/create"),{...y,amount:parseFloat(y.amount)},{headers:{"Content-Type":"application/json"}})).data;if(r.success){let{approvalUrl:e,orderId:a,paymentId:t}=r.data;if(window.sessionStorage&&sessionStorage.setItem("paymentInfo",JSON.stringify({orderId:a,paymentId:t,amount:y.amount,currency:y.currency})),e)window.location.href=e;else throw Error("No approval URL received from PayPal")}else throw Error(r.message||"Payment creation failed")}catch(e){throw console.error("PayPal payment error:",e),N("error"),e}},S=async()=>{if(P()){j(!0),N(null);try{"india"===r?await _():await k()}catch(e){console.error("Payment creation error:",e),N("error")}finally{j(!1)}}},E=async(r,a)=>{try{let r=window.sessionStorage?sessionStorage.getItem("paymentInfo"):null,t=r?JSON.parse(r):{},s=(await p.Z.post("".concat(e,"/generous-payments/verify"),{paypal_order_id:t.orderId,paypal_payment_id:a},{headers:{"Content-Type":"application/json"}})).data;if(s.success)N("success"),window.sessionStorage&&sessionStorage.removeItem("paymentInfo"),g({amount:"",currency:"AUD",contributor:{name:"",phone:"",email:"",address:""},source:"website"});else throw Error(s.message||"Payment verification failed")}catch(e){console.error("Payment verification error:",e),N("error")}};return(0,s.useEffect)(()=>{{let e=window.location.hostname.includes("shanthibhavan.in");if(a(e?"india":"australia"),e&&!document.getElementById("razorpay-script")){let e=document.createElement("script");e.id="razorpay-script",e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,document.body.appendChild(e)}if(!e){let e=new URLSearchParams(window.location.search),r=e.get("PayerID"),a=e.get("paymentId");r&&a&&E(r,a)}}},[]),(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 py-12 px-4",children:(0,t.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,t.jsxs)("div",{className:"text-center mb-10",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full mb-4",children:(0,t.jsx)(n.Z,{className:"w-8 h-8 text-white"})}),(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Make a Generous Contribution"}),(0,t.jsx)("p",{className:"text-lg text-gray-600",children:"Your kindness can make a real difference in someone's life"})]}),"success"===w&&(0,t.jsxs)("div",{className:"mb-8 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center",children:[(0,t.jsx)(o.Z,{className:"w-5 h-5 text-green-600 mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-green-800",children:"Thank you for your generous contribution!"}),(0,t.jsx)("p",{className:"text-green-700",children:"Your donation has been successfully processed."})]})]}),"error"===w&&(0,t.jsxs)("div",{className:"mb-8 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center",children:[(0,t.jsx)(i.Z,{className:"w-5 h-5 text-red-600 mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-red-800",children:"Payment Failed"}),(0,t.jsx)("p",{className:"text-red-700",children:"Please try again or contact support if the issue persists."})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 space-y-8",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[(0,t.jsx)(l.Z,{className:"w-5 h-5 mr-2 text-purple-600"}),"Contribution Amount"]}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Amount (","india"===r?"INR":"AUD",")"]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"india"===r?"â‚¹":"$"}),(0,t.jsx)("input",{type:"number",step:"0.01",min:"1",value:y.amount,onChange:e=>z(null,"amount",e.target.value),className:"w-full pl-8 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ".concat(v.amount?"border-red-300":"border-gray-300"),placeholder:"0.00"})]}),v.amount&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v.amount})]})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[(0,t.jsx)(c.Z,{className:"w-5 h-5 mr-2 text-purple-600"}),"Your Information"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),(0,t.jsx)("input",{type:"text",value:y.contributor.name,onChange:e=>z("contributor","name",e.target.value),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ".concat(v.name?"border-red-300":"border-gray-300"),placeholder:"John Doe"}),v.name&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number (prefer whatsapp)"}),(0,t.jsx)(x(),{country:h.phoneCountry,value:y.contributor.phone,onChange:e=>{g(r=>({...r,contributor:{...r.contributor,phone:e}})),v.phone&&C(e=>{let r={...e};return delete r.phone,r})},inputClass:" !w-full !h-12 !py-3 !pl-12 !pr-4 !border !rounded-lg !focus:ring-2 !focus:ring-purple-500 !focus:border-transparent ".concat(v.phone?"!border-red-300":"!border-gray-300"),containerClass:"!w-full",buttonClass:"!border-gray-300 !rounded-l-lg",dropdownClass:"!bg-white !shadow-lg !border !border-gray-300"}),v.phone&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v.phone})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)("input",{type:"email",value:y.contributor.email,onChange:e=>z("contributor","email",e.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ".concat(v.email?"border-red-300":"border-gray-300"),placeholder:"you@example.com"})]}),v.email&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v.email})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Address ",(0,t.jsx)("span",{className:"text-gray-400",children:"(Optional)"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(m.Z,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),(0,t.jsx)("textarea",{value:y.contributor.address||"",onChange:e=>z("contributor","address",e.target.value),className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none ".concat(v.address?"border-red-300":"border-gray-300"),placeholder:"123 Main Street, City, State, Postal Code",rows:3})]}),v.address&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v.address})]})]})]}),(0,t.jsx)("div",{className:"pt-6 border-t border-gray-200",children:(0,t.jsx)("button",{type:"button",onClick:S,disabled:f,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:from-purple-700 hover:to-pink-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center",children:f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Creating Payment..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Z,{className:"w-5 h-5 mr-2"}),"india"===r?"Proceed to Razorpay":"Proceed to PayPal"]})})})]}),(0,t.jsx)("div",{className:"text-center mt-8 text-gray-600",children:(0,t.jsx)("p",{className:"text-sm",children:"Your contribution makes a difference. Thank you for your generosity! \uD83D\uDE4F"})})]})})}}},function(e){e.O(0,[826,599,386,971,117,744],function(){return e(e.s=183)}),_N_E=e.O()}]);