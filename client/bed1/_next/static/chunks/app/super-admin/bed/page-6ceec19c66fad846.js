(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[339],{4468:function(e,a,t){Promise.resolve().then(t.bind(t,2783))},2783:function(e,a,t){"use strict";t.d(a,{default:function(){return S}});var n=t(7437),r=t(2265),s=t(8438),i=t(3618),l=t(386),o=t(4291),d=t(2381),c=t(5799),u=t(9376),m=t(7520),x=t(4978);let b=[{accessorKey:"bedNo",header:"Bed Number"},{accessorKey:"country.name",header:"Country"},{accessorKey:"amount",header:"Amount",cell:e=>{let{row:a}=e;return"".concat(a.original.country.currency," ").concat(a.original.amount.toLocaleString())}},{accessorKey:"link",header:"Link",cell:e=>{let{row:a}=e,t=a.original.organization,r=a.original._id,s=(null==t?void 0:t.vcLink)&&r?"".concat(t.vcLink,"bed/bed=").concat(r):"",i=async()=>{if(!s){x.Z.error("Link not available.");return}try{await navigator.clipboard.writeText(s),x.Z.success("Link copied to clipboard!")}catch(e){x.Z.error("Failed to copy link.")}};return(0,n.jsx)("div",{className:"flex flex-col gap-1 max-w-[180px]",children:(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(d.z,{variant:"outline",size:"sm",onClick:i,children:"Copy"})})})}},{accessorKey:"viewDetails",header:"Actions",cell:e=>{let a=e.row.original;return(0,n.jsxs)(o.Vq,{children:[(0,n.jsx)(o.hg,{className:"underline",children:(0,n.jsx)("button",{className:"px-4 p-1 text-white bg-sidebar-primary rounded-full",children:"View"})}),(0,n.jsx)(o.cZ,{className:"p-6",children:(0,n.jsx)(h,{data:a})})]})}}],h=e=>{var a,t,r;let{data:s}=e,i=(0,l.I0)(),o=(0,u.useRouter)();return(0,n.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("div",{className:"w-20 h-20 bg-gray-100 flex items-center justify-center rounded-sm",children:(0,n.jsx)("span",{className:"text-2xl",children:"\uD83D\uDECFï¸"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-lg font-bold",children:["Bed #",s.bedNo]}),(0,n.jsxs)("p",{children:["Status: ",s.patientName?"Occupied":"Available"]}),(0,n.jsxs)("p",{children:["Patient: ",s.patientName||"None"]}),(0,n.jsxs)("p",{children:["Organization: ",(null===(a=s.organization)||void 0===a?void 0:a.name)||"N/A"]}),(0,n.jsxs)("p",{children:["Country: ",(null===(t=s.country)||void 0===t?void 0:t.name)||"N/A"]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"Contributors"}),(0,n.jsxs)("p",{children:["Max: ",s.maxNoContributer]}),(0,n.jsxs)("p",{children:["Amount: $",s.amount.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"Management"}),(0,n.jsxs)("p",{children:["Head: ",(null===(r=s.head)||void 0===r?void 0:r.name)||"N/A"]}),s.vcLink&&(0,n.jsx)("a",{href:s.vcLink,target:"_blank",className:"text-blue-500 hover:underline",children:"Video Conference Link"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 flex-wrap pt-4",children:[(0,n.jsx)(d.z,{className:"text-sm",onClick:e=>{e.preventDefault(),i((0,c.kS)(s._id)),o.push("/beds/".concat(s._id))},children:"View Details"}),(0,n.jsx)(d.z,{className:"text-sm",onClick:e=>{i((0,m.R5)("bed")),i((0,m.h9)(s._id))},children:"Edit"}),s.vcLink&&(0,n.jsx)(d.z,{className:"text-sm",onClick:()=>window.open(s.vcLink,"_blank"),children:"Join Meeting"})]})]})};function p(){var e;let a;let[t,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(0),[u,m]=(0,r.useState)(0),[x,h]=(0,r.useState)(10),[p,f]=(0,r.useState)(""),[g,N]=(0,r.useState)(""),[v,j]=(0,r.useState)(""),y=(0,l.v9)(e=>e.update.refresh),w=(0,l.v9)(e=>e.bed.id),k=(0,l.v9)(e=>e.organization.id),C=(0,r.useCallback)((e=e=>{j(e),m(0)},function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];clearTimeout(a),a=setTimeout(()=>{e(...n)},500)}),[]);async function z(){try{if(w){let e=await i.YD.get("/bed/".concat(w)),a=[];return a[0]=e.data.data,c(1),a}let e=(await i.YD.get("/bed?limit=".concat(x,"&skip=").concat(u*x,"&").concat("").concat("").concat(v?"search=".concat(v,"&"):""))).data.data;return c(e.total),e.items}catch(e){console.error("Error fetching bed data:",e)}}return(0,r.useEffect)(()=>{(async function(){o(await z())})()},[u,x,v,g,y,w,k]),(0,n.jsx)("div",{className:"flex flex-col items-center p-4",children:(0,n.jsxs)("div",{className:"container mx-auto py-10",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("input",{type:"text",value:p,onChange:e=>{let a=e.target.value;f(a),C(a)},placeholder:"Search beds by patient or number...",className:"mb-4 p-2 border rounded"}),(0,n.jsxs)("select",{value:g,onChange:e=>{N(e.target.value),m(0)},className:"mb-4 p-2 border border-gray-300 rounded",children:[(0,n.jsx)("option",{value:"all",children:"All Beds"}),(0,n.jsx)("option",{value:"Occupied",children:"Occupied"}),(0,n.jsx)("option",{value:"Available",children:"Available"})]})]}),(0,n.jsx)(s.w,{url:"bed",columns:b,data:t,totalRows:d,pageIndex:u,pageSize:x,onPageChange:m,onPageSizeChange:h,actions:{delete:!0,edit:!0}})]})})}var f=t(9501),g=t(3590),N=t(1229),v=t(279),j=t(5060),y=t(9093),w=t(662),k=t(2786),C=t(4395),z=t(7810);let _=N.z.object({bedNo:N.z.number().min(1,"Bed number must be at least 1"),maxNoContributer:N.z.number().min(1).max(100),amount:N.z.number().min(0),patientName:N.z.string().optional(),vcLink:N.z.string().url().optional().or(N.z.literal(""))});var L=e=>{let{bedId:a}=e,[t,s]=(0,r.useState)(!1),[i,o]=(0,r.useState)(),[c,u]=(0,r.useState)(),[b,h]=(0,r.useState)(),[p,N]=(0,r.useState)(!1),L=(0,l.I0)(),{handleSubmit:S,register:A,setValue:O,formState:{errors:B},setError:D}=(0,f.cI)({resolver:(0,g.F)(_),defaultValues:{maxNoContributer:15,amount:0}});(0,r.useEffect)(()=>{a&&(async()=>{s(!0);try{let e=(await (0,k.bp)(a,"bed")).items;if(O("bedNo",e.bedNo),O("maxNoContributer",e.maxNoContributer),O("amount",e.amount),O("patientName",e.patientName||""),O("vcLink",e.vcLink||""),e.organization&&u({value:e.organization._id,label:e.organization.name}),e.country&&(await (0,k.bp)(e.country,"country"),h({value:e.country._id,label:e.country.name})),e.head){let a=await (0,k.bp)(e.head,"user");o({value:e.head,label:a.items.name})}s(!1)}catch(e){console.error("Error fetching bed details:",e),s(!1)}})()},[a,O]);let V=()=>{O("maxNoContributer",15),O("amount",0),O("patientName",""),O("vcLink",""),o(void 0),u(void 0),h(void 0),L((0,m.Oe)())},Z=async e=>{N(!0);try{let t={...e,...c&&{organization:c.value},...b&&{country:b.value},...i&&{head:i.value}};if(console.log("Submitting form data:",t),a){let e=await (0,y.V)(t,"bed",a);e._id?(x.Z.success("Bed updated successfully"),V()):(D(e.id,{message:e.value}),x.Z.error("An error occurred while submitting the form"))}else{let e=await (0,w.U)("bed",t);e._id?(x.Z.success("Bed created successfully"),V()):(D(e.id,{message:e.value}),x.Z.error("An error occurred while submitting the form"))}}catch(e){console.error("Failed to submit form:",e),x.Z.error("An error occurred while submitting the form")}finally{N(!1)}};return t?(0,n.jsx)("div",{className:"flex items-center justify-center w-full h-[70vh]",children:(0,n.jsx)("div",{className:"loader"})}):(0,n.jsxs)("form",{onSubmit:S(Z),className:"max-w-lg mx-auto p-4 bg-primary-foreground dark:bg-gray-900 shadow-lg rounded-lg grid grid-cols-1 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"organization",className:"required",children:"Organization"}),(0,n.jsx)(z.Z,{cacheOptions:!0,loadOptions:C.Tz,defaultOptions:!0,value:c,onChange:e=>{u({value:e.id,label:e.label})},classNamePrefix:"select",isClearable:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"country",className:"required",children:"Country"}),(0,n.jsx)(z.Z,{cacheOptions:!0,loadOptions:C.Pb,defaultOptions:!0,value:b,onChange:e=>{h({value:e.id,label:e.label})},classNamePrefix:"select",isClearable:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"bedNo",className:"required",children:"Bed Number"}),(0,n.jsx)(v.I,{id:"bedNo",type:"number",...A("bedNo",{valueAsNumber:!0}),className:"w-full border rounded p-2 ".concat(B.bedNo?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),B.bedNo&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:B.bedNo.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"maxNoContributer",className:"required",children:"Maximum Contributors"}),(0,n.jsx)(v.I,{id:"maxNoContributer",type:"number",...A("maxNoContributer",{valueAsNumber:!0}),className:"w-full border rounded p-2 ".concat(B.maxNoContributer?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),B.maxNoContributer&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:B.maxNoContributer.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"amount",className:"required",children:"Cost"}),(0,n.jsx)(v.I,{id:"amount",type:"number",step:"0.01",...A("amount",{valueAsNumber:!0}),className:"w-full border rounded p-2 ".concat(B.amount?"border-red-500":"border-gray-300"," bg-white dark:bg-gray-800 dark:text-white")}),B.amount&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:B.amount.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"patientName",children:"Patient Name"}),(0,n.jsx)(v.I,{id:"patientName",...A("patientName"),className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"vcLink",children:"Video Conference Link"}),(0,n.jsx)(v.I,{id:"vcLink",...A("vcLink"),className:"w-full border rounded p-2 bg-white dark:bg-gray-800 dark:text-white"}),B.vcLink&&(0,n.jsx)("p",{className:"text-red-500 text-sm",children:B.vcLink.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j._,{htmlFor:"head",children:"Bed Head/Manager"}),(0,n.jsx)(z.Z,{cacheOptions:!0,loadOptions:C.p_,defaultOptions:!0,value:i,onChange:e=>{o(e)},classNamePrefix:"select",isClearable:!0})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)(d.z,{onClick:V,className:"bg-slate-400 hover:bg-slate-500",children:a?"Cancel":"Clear"}),(0,n.jsx)(d.z,{className:p?"cursor-not-allowed opacity-50":"",type:"submit",children:a?"Update":"Create"})]})]})};function S(){let[e,a]=(0,r.useState)(!0),t=(0,l.I0)(),s=(0,l.v9)(e=>e.update.url),i=(0,l.v9)(e=>e.update.id);return(0,n.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("h1",{className:"text-lg font-semibold mb-2 text-bg2 flex justify-start",children:"Beds Management"}),"bed"===s?"":(0,n.jsx)(d.z,{onClick:()=>{t((0,c.Dp)()),t((0,m.Oe)()),a(!e)},className:"py-2 px-4 rounded-md hover:bg-bg2",children:e?"Add Bed":"View Beds"})]}),"bed"===s?i&&(0,n.jsx)(L,{bedId:i}):e?(0,n.jsx)(p,{}):(0,n.jsx)(L,{})]})}},4291:function(e,a,t){"use strict";t.d(a,{Be:function(){return b},Vq:function(){return o},cZ:function(){return m},fK:function(){return x},hg:function(){return d}});var n=t(7437),r=t(2265),s=t(9027),i=t(653),l=t(3448);let o=s.fC,d=s.xz,c=s.h_;s.x8;let u=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(s.aV,{ref:a,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});u.displayName=s.aV.displayName;let m=r.forwardRef((e,a)=>{let{className:t,children:r,...o}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{}),(0,n.jsxs)(s.VY,{ref:a,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[r,(0,n.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(i.Pxu,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=s.VY.displayName;let x=e=>{let{className:a,...t}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};x.displayName="DialogHeader",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(s.Dx,{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})}).displayName=s.Dx.displayName;let b=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,n.jsx)(s.dk,{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});b.displayName=s.dk.displayName},5799:function(e,a,t){"use strict";t.d(a,{Dp:function(){return o},kS:function(){return i}});var n=t(1455);let r={id:null,organization:null,country:null,bedNo:null,maxNoContributer:15,amount:null,patientName:null,head:null,vcLink:null},s=(0,n.oM)({name:"bed",initialState:r,reducers:{setBedId:(e,a)=>{e.id=a.payload},setBedData:(e,a)=>({...e,...a.payload}),clearBedData:()=>r,setOrganization:(e,a)=>{e.organization=a.payload},setCountry:(e,a)=>{e.country=a.payload},setBedNo:(e,a)=>{e.bedNo=a.payload},setMaxContributers:(e,a)=>{e.maxNoContributer=a.payload},setamount:(e,a)=>{e.amount=a.payload},setPatientName:(e,a)=>{e.patientName=a.payload},setHead:(e,a)=>{e.head=a.payload},setVcLink:(e,a)=>{e.vcLink=a.payload}}}),{setBedId:i,setBedData:l,clearBedData:o,setOrganization:d,setCountry:c,setBedNo:u,setMaxContributers:m,setamount:x,setPatientName:b,setHead:h,setVcLink:p}=s.actions;a.ZP=s.reducer},4395:function(e,a,t){"use strict";t.d(a,{Pb:function(){return s},Tz:function(){return r},p_:function(){return i}});var n=t(2786);let r=async e=>(await (0,n.Ak)(e)).items.map(e=>({id:e._id,label:e.name})),s=async e=>(await (0,n.tE)(e)).items.map(e=>({id:e._id,label:e.name})),i=async e=>(await (0,n.uh)(e)).items.map(e=>({value:e._id,label:e.name}))}},function(e){e.O(0,[310,464,10,261,519,265,27,329,89,971,117,744],function(){return e(e.s=4468)}),_N_E=e.O()}]);